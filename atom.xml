<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Titangene Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://titangene.github.io/"/>
  <updated>2019-09-19T13:02:33.591Z</updated>
  <id>https://titangene.github.io/</id>
  
  <author>
    <name>Titangene</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>é‡æ–°èªè­˜ CSS - CSS Selector (3)</title>
    <link href="https://titangene.github.io/article/css-selector-3.html"/>
    <id>https://titangene.github.io/article/css-selector-3.html</id>
    <published>2019-09-19T08:20:52.000Z</published>
    <updated>2019-09-19T13:02:33.591Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/css.png" alt=""></p><p>Selector (é¸æ“‡å™¨) å¯ç”¨ä¾†é¸æ“‡ HTML å’Œ XML æ–‡ä»¶ä¸­çš„ç¯€é»ï¼Œä¸¦å°‡æ¨£å¼å±¬æ€§ç¶å®šåˆ°æ–‡ä»¶ (HTML å’Œ XML) ä¸­çš„å…ƒç´ ä¸Šã€‚ç•¶é¸æ“‡å™¨èˆ‡æŸå…ƒç´  match çš„æ™‚å€™ï¼Œå°±å¯ä»¥å°é¸åˆ°çš„å…ƒç´ é€²è¡Œ CSS æ¨£å¼è¨­å®šã€‚æœ¬ç¯‡æœƒä»‹ç´¹ pseudo-class (å½é¡)ã€‚</p><a id="more"></a><h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€"></a>å‰è¨€</h2><blockquote><p>ã€Œé‡æ–°èªè­˜ CSSã€é€™å€‹ç³»åˆ—åç¨±çš„ç”±ä¾†å°±å¦‚å…¶åï¼Œæˆ‘æƒ³è¦é‡æ–°èªè­˜å®ƒã€‚é›–ç„¶ä»¥å‰å°±æœ‰å­¸é CSSï¼Œä½†é€™æ¬¡æƒ³å¾ CSS Spec ä¸­å­¸åˆ°æœ€åŸå§‹çš„å®šç¾©å’Œå…§å®¹ï¼Œæ›´åŠ äº†è§£ CSS çš„åŸç†ï¼Œè®“æˆ‘åœ¨åˆ‡ç‰ˆçš„æ™‚å€™å¯ä»¥æ›´åŠ ç¢ºå®šè‡ªå·±åœ¨åšä»€éº¼ï¼Œæˆ‘è¸©åˆ°çš„é›·åªæ˜¯å› ç‚ºæˆ‘ä¸å¤ äº†è§£å®ƒæ‰æœƒç‚¸é–‹ã€‚</p><p>åœ¨é€™ 30 å¤©çš„å…§å®¹ä¸­ï¼Œæœƒå°‡ Spec å…§çœ‹åˆ°çš„è³‡æ–™æ•´ç†æˆé€™å€‹ç³»åˆ—ï¼Œä¹Ÿå¸Œæœ›æ­£åœ¨å­¸ CSS çš„å„ä½å¯ä»¥æ›´åŠ äº†è§£å®ƒã€‚å¦å¤–æˆ‘ä¹ŸæœƒåŒæ™‚å°‡æ–‡ç« ç™¼è‡³æˆ‘çš„ Blogï¼Œå¦‚æœæƒ³ç›´æ¥çœ‹æ–‡å…§çš„ç¨‹å¼ç¢¼ Demo ç•«é¢ï¼Œå¯ä»¥åˆ°æˆ‘çš„ Blog ä¾†çœ‹ ğŸ˜ƒã€‚</p><p>æœ¬æ–‡åŒæ­¥ç™¼è¡¨æ–¼ iT é‚¦å¹«å¿™ï¼š<a href="https://ithelp.ithome.com.tw/articles/10217730" target="_blank" rel="noopener">é‡æ–°èªè­˜ CSS - CSS Selector (3)</a></p><p>ã€Œé‡æ–°èªè­˜ CSSã€ç³»åˆ—æ–‡ç« ç™¼æ–‡æ–¼ï¼š</p><ul><li><a href="https://ithelp.ithome.com.tw/users/20117586/ironman/2617" target="_blank" rel="noopener">iT é‚¦å¹«å¿™</a></li><li><a href="https://titangene.github.io/tags/it-%E9%90%B5%E4%BA%BA%E8%B3%BD/">Titangene Blog</a></li></ul></blockquote><h2 id="pseudo-classes"><a class="header-anchor" href="#pseudo-classes"></a>Pseudo-classes</h2><p>pseudo-class æ˜¯ä»¥ <code>:</code> ç‚ºé–‹é ­ï¼Œå¾Œé¢æ¥è‘— pseudo-class çš„åç¨±ï¼Œæœ‰äº›æœƒåœ¨å¾Œé¢åŠ ä¸Šæ‹¬è™Ÿ <code>()</code>ï¼Œä¸¦åœ¨æ‹¬è™Ÿä¹‹é–“åŠ ä¸Šå€¼ã€‚ä¾‹å¦‚ï¼š<code>:nth-child(2)</code>ã€‚</p><div class="warning"><p>æ³¨æ„ï¼š</p><ul><li>pseudo-class å’Œ pseudo-element ä¸ç›¸åŒ</li><li>pseudo-class æ˜¯ä»¥ <code>:</code> ç‚ºé–‹é ­</li><li>pseudo-element æ˜¯ä»¥ <code>::</code> ç‚ºé–‹é ­ï¼Œä½†ä¹Ÿå¯ä»¥ä»¥ <code>:</code> ç‚ºé–‹é ­ï¼Œå› ç‚ºåœ¨èˆŠç‰ˆçš„ W3C Spec ä¸­æ²’æœ‰å°‡ pseudo-class å’Œ pseudo-element å€åˆ†æˆ <code>:</code> å’Œ <code>::</code>ã€‚å¦‚æœä½ å¯« pseudo-element æ˜¯ç”¨ <code>:</code>ï¼Œå¤§éƒ¨ä»½ç€è¦½å™¨ä¹Ÿé‚„æ˜¯æœƒæ”¯æ´é€™ç¨®èªæ³•ã€‚</li></ul></div><h3 id="dynamic-pseudo-classes"><a class="header-anchor" href="#dynamic-pseudo-classes"></a>Dynamic pseudo-classes</h3><p>Dynamic pseudo-classes ä¸æœƒå‡ºç¾åœ¨ document source æˆ– document tree ä¸­ã€‚</p><p>Dynamic pseudo-classes åˆåˆ†ç‚ºï¼š</p><ul><li>link pseudo-classesï¼š<code>:link</code> å’Œ <code>:visited</code></li><li>user action pseudo-classesï¼š<code>:hover</code>ã€<code>:active</code> å’Œ <code>:focus</code></li></ul><h4 id="the-link-pseudo-classesï¼š-link-å’Œ-visited"><a class="header-anchor" href="#the-link-pseudo-classesï¼š-link-å’Œ-visited"></a>The link pseudo-classesï¼š<code>:link</code> å’Œ <code>:visited</code></h4><p><a href="https://www.w3.org/TR/CSS22/conform.html#user-agent" target="_blank" rel="noopener">UA</a> (User agentï¼Œå° HTML ä¾†èªªå°±æ˜¯ç€è¦½å™¨) ä»¥ä¸åŒçš„æ–¹å¼ä¾†é¡¯ç¤ºé€£çµæ˜¯å¦å·²è¨ªå•ï¼š</p><ul><li><code>:link</code>ï¼šæœªè¨ªå•éçš„é€£çµ</li><li><code>:visited</code>ï¼šå·²è¨ªå•éçš„é€£çµ</li></ul><p>ä¸éï¼Œéäº†ä¸€æ®µæ™‚é–“ä¹‹å¾Œï¼ŒUA å¯ä»¥å°‡å·²è¨ªå•çš„é€£çµå¾ <code>:visited</code> è®Šå› <code>:link</code> çš„ç‹€æ…‹ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://titangene.github.io"</span>&gt;</span>Titangene Blog<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://titangene.github.io/article/css-selector-3.html"</span>&gt;</span>é‡æ–°èªè­˜ CSS - CSS Selector (3)<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:visited</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:link</span> &#123; <span class="hljs-attribute">color</span>: green; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/jONejbv" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-3/2019-09-19-16-40-27.png" alt=""></p><iframe height="215" style="width:100%" scrolling="no" title="link pseudo-class: :visited &amp; :link" src="https://codepen.io/titangene/embed/jONejbv/?height=215&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/jONejbv/" target="_blank" rel="noopener">link pseudo-class: :visited &amp; :link</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h4 id="the-user-action-pseudo-classesï¼š-hover-active-å’Œ-focus"><a class="header-anchor" href="#the-user-action-pseudo-classesï¼š-hover-active-å’Œ-focus"></a>The user action pseudo-classesï¼š<code>:hover</code>ã€<code>:active</code> å’Œ <code>:focus</code></h4><p>ç”¨æ–¼ response ä½¿ç”¨è€…çš„æ“ä½œï¼š</p><ul><li><code>:hover</code>ï¼š<ul><li>ç•¶ cursor (æ»‘é¼ æŒ‡æ¨™) hover åœ¨å…ƒç´ ä¸Šæ™‚ï¼Œvisual UA å°±å¯ä»¥æ‡‰ç”¨æ­¤ pseudo-class</li><li>ä¸æ”¯æ´ <a href="https://www.w3.org/TR/CSS22/media.html#media-groups" target="_blank" rel="noopener">äº’å‹•å¼ media</a> çš„ UA ä¸ç”¨æ”¯æ´æ­¤ pseudo-class</li></ul></li><li><code>:active</code>ï¼š<ul><li>åœ¨ä½¿ç”¨è€…æŒ‰ä¸‹æ»‘é¼ æŒ‰éˆ•ä¸¦æ”¾é–‹å®ƒä¹‹é–“çš„æ™‚é–“æœƒæ‡‰ç”¨æ­¤ pseudo-class</li><li>å¦‚æœæ»‘é¼ ä¸Šæœ‰å¤šå€‹æŒ‰éˆ•æ™‚ï¼Œ<code>:active</code> åªé©ç”¨æ–¼ä¸»è¦æˆ–ä¸»è¦ actived çš„æŒ‰éˆ• (é€šå¸¸ç‚ºæ»‘é¼ å·¦éµ) â€¦ç­‰</li></ul></li><li><code>:focus</code>ï¼šç•¶å…ƒç´ æœ‰ç„¦é»æ™‚æœƒæ‡‰ç”¨æ­¤ pseudo-classï¼Œä¾‹å¦‚ï¼šæŒ‰éµç›¤çš„ Tab éµæ‰€é¸åˆ°çš„å…ƒç´ </li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://titangene.github.io"</span>&gt;</span>Titangene Blog<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://titangene.github.io/article/css-selector-3.html"</span>&gt;</span>é‡æ–°èªè­˜ CSS - CSS Selector (3)<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">a</span> &#123; <span class="hljs-attribute">color</span>: black; &#125;<br><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:focus</span> &#123; <span class="hljs-attribute">color</span>: gray; &#125;<br><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:active</span> &#123; <span class="hljs-attribute">color</span>: purple; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/YzKJobe" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-3/user-action-pseudo-class.gif" alt=""></p><iframe height="227" style="width:100%" scrolling="no" title="user action pseudo-class" src="https://codepen.io/titangene/embed/YzKJobe/?height=227&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/YzKJobe/" target="_blank" rel="noopener">user action pseudo-class</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><p>ä¹Ÿå¯ä»¥ä¸€æ¬¡ä½¿ç”¨å¤šå€‹ dynamic pseudo-classï¼Œå¦‚ä¸‹ç¯„ä¾‹ï¼š</p><ul><li>åŒæ™‚æœ‰ <code>:focus</code> å’Œ <code>:hover</code> çš„ç‹€æ…‹</li><li>åŒæ™‚æœ‰ <code>:link</code> å’Œ <code>:active</code> çš„ç‹€æ…‹</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:focus</span><span class="hljs-selector-pseudo">:hover</span> &#123; <span class="hljs-attribute">color</span>: teal; &#125;<br><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:link</span><span class="hljs-selector-pseudo">:active</span> &#123; <span class="hljs-attribute">color</span>: fuchsia; &#125;<br></code></pre></td></tr></table></figure><h3 id="the-target-pseudo-classesï¼š-target"><a class="header-anchor" href="#the-target-pseudo-classesï¼š-target"></a>The target pseudo-classesï¼š<code>:target</code></h3><p>æœ‰äº› URI çš„æœ€å¾Œæœƒä»¥ <code>#</code> (number sign) ç‚ºçµå°¾ï¼Œå¾Œé¢æœƒæ¥è‘— anchor identifier (ä¹Ÿç¨±ç‚º fragment identifier)ï¼Œä»£è¡¨è©² URI æ˜¯æŒ‡å‘è³‡æºä¸­çš„æŸå€‹ä½ç½®ã€‚é€šå¸¸å¸¶æœ‰ fragment identifier çš„ URL æœƒ link åˆ°æ–‡ä»¶ä¸­çš„æŸäº›å…ƒç´ ï¼Œè©²å…ƒç´ è¢«ç¨±ç‚º target å…ƒç´ ã€‚</p><p>ä¾‹å¦‚ï¼šåœ¨ä¸‹é¢çš„ HTML æ–‡ä»¶ä¸­æœ‰åç‚º <code>hello</code> çš„ anchor (éŒ¨é») (ä¹Ÿå°±æ˜¯ <code>&lt;a href=&quot;#hello&quot;&gt;Hello&lt;/a&gt;</code> é€™å€‹é€£çµ)ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#hello"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"hello"</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Target<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-id">#hello</span><span class="hljs-selector-pseudo">:target</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/jONegME" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p>å¦‚æœæ­¤ HTML çš„ URL ç‚ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">https://s.codepen.io/titangene/debug/jONegME/vWkRwRNmBvOM<br></code></pre></td></tr></table></figure><p>åœ¨é‚„æ²’é»æ“Š <code>#hello</code> éŒ¨é»æ™‚ï¼Œç•«é¢å¦‚ä¸‹ï¼š</p><p><img src="../images/css-selector-3/2019-09-19-18-59-06.png" alt=""></p><p>åªè¦é»æ“Š <code>#hello</code> éŒ¨é»å¾Œï¼Œä¸‹é¢çš„ â€œTargetâ€ æ–‡å­—å°±æœƒè®Šæˆç´…è‰² (ä¹Ÿå°±æ˜¯æœƒæ‡‰ç”¨ <code>#hello:target</code> çš„æ¨£å¼)ï¼Œç•«é¢å¦‚ä¸‹ï¼š</p><p><img src="../images/css-selector-3/2019-09-19-18-59-29.png" alt=""></p><p>ä¸¦ä¸” URL çš„æœ€å¾ŒæœƒåŠ ä¸Š <code>#hello</code>ï¼Œè€Œ <code>#hello</code> å°±æ˜¯ fragment identifierã€‚</p><p>å‰›å‰›é»æ“Šçš„éŒ¨é»æœƒ link åˆ° target å…ƒç´ ï¼Œè€Œ target å…ƒç´ å°±æ˜¯ <code>&lt;div id=&quot;hello&quot;&gt;</code>ï¼Œæ‰€ä»¥ selector æ‰æœƒ match åˆ° <code>#hello:target</code>ã€‚</p><iframe height="227" style="width:100%" scrolling="no" title="target pseudo-classes :target" src="https://codepen.io/titangene/embed/jONegME/?height=227&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/jONegME/" target="_blank" rel="noopener">target pseudo-classes :target</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><p>åœ¨ <a href="https://developer.mozilla.org/zh-TW/docs/Web/CSS/:target#Creating_a_pure_CSS_lightbox" target="_blank" rel="noopener">MDN</a> æœ‰ä¸€å€‹ç¯„ä¾‹ä¹Ÿè »æœ‰è¶£çš„ï¼Œå¯ä»¥ç”¨ <code>:target</code> pseudo-class ä¾†å¯¦ä½œ lightboxï¼š</p><p><img src="../images/css-selector-3/lightbox.gif" alt=""></p><p>é‹ä½œåŸç†æ˜¯ç”¨ <code>display: none</code> å’Œ <code>display: block</code> ä¾†æ§åˆ¶ lightbox æ˜¯å¦é–‹å•Ÿï¼Œè§¸ç™¼çš„æ©Ÿåˆ¶å°±æ˜¯ç”¨å‰›å‰›ä»‹ç´¹çš„ <code>:target</code> pseudo-class ä¾†åšçš„ã€‚</p><blockquote><p>é€™å€‹ç¯„ä¾‹å¾ˆæœ‰è¶£ï¼Œä»¥å‰ç”¨ JavaScript æ‰èƒ½åšåˆ°çš„äº‹æƒ…ï¼Œæ²’æƒ³åˆ°ä¹Ÿèƒ½ç”¨ç´” CSS ä¾†å¯¦ä½œå‡ºä¾†ã€‚</p></blockquote><h3 id="ui-element-states-pseudo-classes"><a class="header-anchor" href="#ui-element-states-pseudo-classes"></a>UI element states pseudo-classes</h3><p>åˆ†ç‚ºï¼š</p><ul><li><code>:enabled</code>ï¼šè™•æ–¼å•Ÿç”¨ç‹€æ…‹çš„ UI å…ƒç´ </li><li><code>:disabled</code>ï¼šè™•æ–¼ç¦ç”¨ç‹€æ…‹çš„ UI å…ƒç´ </li><li><code>:checked</code>ï¼šé¸å– radio æˆ–å‹¾é¸ checkbox å…ƒç´ æ™‚æœƒæ‡‰ç”¨</li></ul><h4 id="enabled-disabled-pseudo-class"><a class="header-anchor" href="#enabled-disabled-pseudo-class"></a><code>:enabled</code> &amp; <code>:disabled</code> pseudo-class</h4><p>ç›´æ¥çœ‹ç¯„ä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"enabledField"</span>&gt;</span>enabled field:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"enabledField"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Lorem"</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"disabledField"</span>&gt;</span>disabled field:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"disabledField"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Lorem"</span> <span class="hljs-attr">disabled</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"enabledCheckbox"</span>&gt;</span>enabled checkbox:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"enabledCheckbox"</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"disabledCheckbox"</span>&gt;</span>disabled checkbox:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"disabledCheckbox"</span> <span class="hljs-attr">disabled</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Submit"</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">input</span><span class="hljs-selector-pseudo">:enabled</span> &#123; <span class="hljs-attribute">outline</span>: <span class="hljs-number">3px</span> solid red; &#125;<br><span class="hljs-selector-tag">input</span><span class="hljs-selector-pseudo">:disabled</span> &#123; <span class="hljs-attribute">outline</span>: <span class="hljs-number">3px</span> solid blue; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/qBWQBEd" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p>åªè¦è¢«åŠ ä¸Š <code>disabled</code> å±¬æ€§çš„ <code>input</code> å…ƒç´ éƒ½ä»£è¡¨è©²å…ƒç´ è™•æ–¼ç¦ç”¨ç‹€æ…‹ï¼Œæ‰€ä»¥é€™äº›å…ƒç´ å°±æœƒå¥—ç”¨ <code>input:disabled</code> æ­¤ selector çš„æ¨£å¼ã€‚å…¶é¤˜çš„å…ƒç´ å‰‡æœƒå¥—ç”¨ <code>input:enabled</code> æ­¤ selector çš„æ¨£å¼ã€‚</p><p><img src="../images/css-selector-3/2019-09-19-19-37-25.png" alt=""></p><div class="info"><p>ä¸éè¦æ³¨æ„çš„äº‹å…ƒç´ æœ‰ç„¡å•Ÿç”¨ï¼Œè·Ÿä¸€äº›æœƒå½±éŸ¿ä½¿ç”¨è€…äº’å‹• UI å…ƒç´ çš„ CSS å±¬æ€§æ²’é—œä¿‚ï¼Œé€™äº›éƒ½ä¸æœƒå½±éŸ¿ selector æ˜¯å¦ match åˆ° <code>:enabled</code> æˆ– <code>:disabled</code>ã€‚</p><p>ä¾‹å¦‚ï¼š<code>display</code> å’Œ <code>visibility</code> å±¬æ€§éƒ½æœƒè®“å…ƒç´ åœ¨ç•«é¢ä¸Šæ¶ˆå¤±ï¼Œä½†æ˜¯éƒ½ä¸æœƒå½±éŸ¿åˆ°å•Ÿç”¨æˆ–ç¦ç”¨çš„ç‹€æ…‹ã€‚</p><ul><li><code>display: none</code> ä¸æœƒè®“å…ƒç´ å‡ºç¾åœ¨ <a href="https://www.w3.org/TR/CSS22/intro.html#formatting-structure" target="_blank" rel="noopener">formatting structure</a> ä¸­ï¼Œå¾ˆåƒä¸åœ¨ç•«é¢ä¸Šï¼Œæœƒå®Œå…¨æ¶ˆå¤±</li><li><code>visibility: hidden</code> ç”Ÿæˆçš„ box æ˜¯çœ‹ä¸è¦‹çš„ï¼Œå®Œå…¨é€æ˜ï¼Œä¸æœƒ draw ä»»ä½•å…§å®¹ï¼Œä½†æœƒå½±éŸ¿ä½ˆå±€ï¼Œä¹Ÿå°±æ˜¯æœƒåœ¨ç•«é¢ä¸Šä½”ç”¨ç©ºé–“ï¼Œä½†æœƒçœ‹ä¸åˆ°å…ƒç´ çš„æ¨£å­</li></ul></div><iframe height="299" style="width:100%" scrolling="no" title=":enabled and :disabled pseudo-classes" src="https://codepen.io/titangene/embed/qBWQBEd/?height=299&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/qBWQBEd/" target="_blank" rel="noopener">:enabled and :disabled pseudo-classes</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h4 id="checked-pseudo-class"><a class="header-anchor" href="#checked-pseudo-class"></a><code>:checked</code> pseudo-class</h4><p>ç›´æ¥çœ‹ç¯„ä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"firstCheckbox"</span> <span class="hljs-attr">checked</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"firstCheckbox"</span>&gt;</span>First checkbox<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"secondCheckbox"</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"secondCheckbox"</span>&gt;</span>Second checkbox<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"firstRadio"</span> <span class="hljs-attr">checked</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"firstRadio"</span>&gt;</span>First radio<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"secondRadio"</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"secondRadio"</span>&gt;</span>Second radio<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">input</span> + <span class="hljs-selector-tag">label</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br><span class="hljs-selector-tag">input</span><span class="hljs-selector-pseudo">:checked</span> + <span class="hljs-selector-tag">label</span> &#123; <span class="hljs-attribute">color</span>: blue; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/vYBQYrW" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-3/2019-09-19-20-02-40.png" alt=""></p><iframe height="280" style="width:100%" scrolling="no" title=":checked pseudo-class" src="https://codepen.io/titangene/embed/vYBQYrW/?height=280&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/vYBQYrW/" target="_blank" rel="noopener">:checked pseudo-class</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h2 id="æœ€å¾Œ"><a class="header-anchor" href="#æœ€å¾Œ"></a>æœ€å¾Œ</h2><p>ä»Šå¤©ä»‹ç´¹ä¸€äº› pseudo-classï¼Œæ¥ä¸‹ä¾†å¹¾å¤©æœƒæ¥çºŒä»‹ç´¹å…¶ä»– selectorã€‚</p><p>è³‡æ–™ä¾†æºï¼š</p><ul><li><a href="https://www.w3.org/TR/CSS22/selector.html" target="_blank" rel="noopener">CSS 2.2 Specification - Selectors</a></li><li><a href="https://www.w3.org/TR/selectors-3/" target="_blank" rel="noopener">Selectors Level 3</a></li><li><a href="https://www.w3.org/TR/selectors-4/" target="_blank" rel="noopener">Selectors Level 4</a></li><li><a href="https://developer.mozilla.org/zh-TW/docs/Web/CSS/:target" target="_blank" rel="noopener">:target - CSS | MDN</a></li></ul><blockquote><p>About MDN by Mozilla Contributors is licensed under CC-BY-SA 2.5</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/css.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Selector (é¸æ“‡å™¨) å¯ç”¨ä¾†é¸æ“‡ HTML å’Œ XML æ–‡ä»¶ä¸­çš„ç¯€é»ï¼Œä¸¦å°‡æ¨£å¼å±¬æ€§ç¶å®šåˆ°æ–‡ä»¶ (HTML å’Œ XML) ä¸­çš„å…ƒç´ ä¸Šã€‚ç•¶é¸æ“‡å™¨èˆ‡æŸå…ƒç´  match çš„æ™‚å€™ï¼Œå°±å¯ä»¥å°é¸åˆ°çš„å…ƒç´ é€²è¡Œ CSS æ¨£å¼è¨­å®šã€‚æœ¬ç¯‡æœƒä»‹ç´¹ pseudo-class (å½é¡)ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://titangene.github.io/categories/css/"/>
    
    
      <category term="IT éµäººè³½" scheme="https://titangene.github.io/tags/it-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>é‡æ–°èªè­˜ CSS - CSS Selector (2)</title>
    <link href="https://titangene.github.io/article/css-selector-2.html"/>
    <id>https://titangene.github.io/article/css-selector-2.html</id>
    <published>2019-09-18T08:20:52.000Z</published>
    <updated>2019-09-18T09:02:52.683Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/css.png" alt=""></p><p>Selector (é¸æ“‡å™¨) å¯ç”¨ä¾†é¸æ“‡ HTML å’Œ XML æ–‡ä»¶ä¸­çš„ç¯€é»ï¼Œä¸¦å°‡æ¨£å¼å±¬æ€§ç¶å®šåˆ°æ–‡ä»¶ (HTML å’Œ XML) ä¸­çš„å…ƒç´ ä¸Šã€‚ç•¶é¸æ“‡å™¨èˆ‡æŸå…ƒç´  match çš„æ™‚å€™ï¼Œå°±å¯ä»¥å°é¸åˆ°çš„å…ƒç´ é€²è¡Œ CSS æ¨£å¼è¨­å®šã€‚æœ¬ç¯‡æœƒä»‹ç´¹ attribute selector (å±¬æ€§é¸æ“‡å™¨)ã€‚</p><a id="more"></a><h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€"></a>å‰è¨€</h2><blockquote><p>ã€Œé‡æ–°èªè­˜ CSSã€é€™å€‹ç³»åˆ—åç¨±çš„ç”±ä¾†å°±å¦‚å…¶åï¼Œæˆ‘æƒ³è¦é‡æ–°èªè­˜å®ƒã€‚é›–ç„¶ä»¥å‰å°±æœ‰å­¸é CSSï¼Œä½†é€™æ¬¡æƒ³å¾ CSS Spec ä¸­å­¸åˆ°æœ€åŸå§‹çš„å®šç¾©å’Œå…§å®¹ï¼Œæ›´åŠ äº†è§£ CSS çš„åŸç†ï¼Œè®“æˆ‘åœ¨åˆ‡ç‰ˆçš„æ™‚å€™å¯ä»¥æ›´åŠ ç¢ºå®šè‡ªå·±åœ¨åšä»€éº¼ï¼Œæˆ‘è¸©åˆ°çš„é›·åªæ˜¯å› ç‚ºæˆ‘ä¸å¤ äº†è§£å®ƒæ‰æœƒç‚¸é–‹ã€‚</p><p>åœ¨é€™ 30 å¤©çš„å…§å®¹ä¸­ï¼Œæœƒå°‡ Spec å…§çœ‹åˆ°çš„è³‡æ–™æ•´ç†æˆé€™å€‹ç³»åˆ—ï¼Œä¹Ÿå¸Œæœ›æ­£åœ¨å­¸ CSS çš„å„ä½å¯ä»¥æ›´åŠ äº†è§£å®ƒã€‚å¦å¤–æˆ‘ä¹ŸæœƒåŒæ™‚å°‡æ–‡ç« ç™¼è‡³æˆ‘çš„ Blogï¼Œå¦‚æœæƒ³ç›´æ¥çœ‹æ–‡å…§çš„ç¨‹å¼ç¢¼ Demo ç•«é¢ï¼Œå¯ä»¥åˆ°æˆ‘çš„ Blog ä¾†çœ‹ ğŸ˜ƒã€‚</p><p>æœ¬æ–‡åŒæ­¥ç™¼è¡¨æ–¼ iT é‚¦å¹«å¿™ï¼š<a href="https://ithelp.ithome.com.tw/articles/10217082" target="_blank" rel="noopener">é‡æ–°èªè­˜ CSS - CSS Selector (2)</a></p><p>ã€Œé‡æ–°èªè­˜ CSSã€ç³»åˆ—æ–‡ç« ç™¼æ–‡æ–¼ï¼š</p><ul><li><a href="https://ithelp.ithome.com.tw/users/20117586/ironman/2617" target="_blank" rel="noopener">iT é‚¦å¹«å¿™</a></li><li><a href="https://titangene.github.io/tags/it-%E9%90%B5%E4%BA%BA%E8%B3%BD/">Titangene Blog</a></li></ul></blockquote><h2 id="attribute-selector"><a class="header-anchor" href="#attribute-selector"></a>Attribute selector</h2><p>Selector å…è¨±è¡¨ç¤ºå…ƒç´ çš„å±¬æ€§ã€‚ç•¶ selector ä½œç‚º expression (è¡¨é”å¼) ä¾† match å…ƒç´ æ™‚ï¼Œå¦‚æœè©²å…ƒç´ å…·æœ‰èˆ‡ attribute selector (å±¬æ€§é¸æ“‡å™¨) è¡¨ç¤ºçš„å±¬æ€§ match çš„å±¬æ€§ï¼Œå‰‡å¿…é ˆå°‡ attribute selector è¦–ç‚ºèˆ‡å…ƒç´  matchã€‚</p><h3 id="attribute-presence-and-value-selector"><a class="header-anchor" href="#attribute-presence-and-value-selector"></a>Attribute presence and value selector</h3><p><a href="https://www.w3.org/TR/CSS22/selector.html#attribute-selectors" target="_blank" rel="noopener">CSS2</a> å¼•å…¥äº†å››å€‹ attribute selectorï¼š</p><ul><li><code>[att]</code>ï¼šä»£è¡¨å…·æœ‰ <code>att</code> å±¬æ€§çš„å…ƒç´ ï¼Œç„¡è«–å±¬æ€§çš„å€¼ç‚ºä½•</li><li><code>[att=val]</code>ï¼šä»£è¡¨å…·æœ‰ <code>att</code> å±¬æ€§çš„å…ƒç´ ï¼Œä¸”è©²å±¬æ€§å€¼ç‚º <code>val</code></li><li><code>[att~=val]</code>ï¼šä»£è¡¨å…·æœ‰ <code>att</code> å±¬æ€§çš„å…ƒç´ ï¼Œè©²å±¬æ€§çš„å€¼æ˜¯ä»¥ç©ºæ ¼åˆ†éš”çš„å–®è©åˆ—è¡¨ï¼Œå…¶ä¸­ä¸€å€‹æ­£å¥½æ˜¯ <code>val</code><ul><li>å¦‚æœ <code>val</code> åŒ…å«ç©ºæ ¼ï¼Œå°±ä¸ä»£è¡¨ä»»ä½•å…§å®¹ (å› ç‚ºå–®å­—ä¹‹é–“æ˜¯ç”¨ç©ºæ ¼ä¾†åˆ†éš”)</li><li>å¦‚æœ <code>val</code> æ˜¯ç©ºå­—ä¸²ï¼Œå°±ä¸ä»£è¡¨ä»»ä½•å…§å®¹</li></ul></li><li><code>[att|=val]</code>ï¼šä»£è¡¨å…·æœ‰ <code>att</code> å±¬æ€§çš„å…ƒç´ ï¼Œä¸”è©²å±¬æ€§å€¼ç‚º <code>val</code> æˆ–ä»¥ <code>val</code> ç‚ºé–‹é ­ï¼Œå¾Œé¢æ¥è‘— <code>-</code> (ä¹Ÿå°±æ˜¯ä»¥ <code>val-</code> ç‚ºé–‹é ­)</li></ul><p>ç›´æ¥çœ‹ç¯„ä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Titan<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"hello"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"titan"</span>&gt;</span>Titan<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"hello"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"titan"</span>&gt;</span>Titan<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"highlight"</span>&gt;</span>highlight Titan<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"titan"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"highlight"</span>&gt;</span>highlight Titan<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text text-primary text-bold"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-primary text"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"textPrimary"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-primary"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"alert"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"alert-primary"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span><span class="hljs-selector-attr">[title]</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br><span class="hljs-selector-tag">h2</span><span class="hljs-selector-attr">[title="titan"]</span> &#123; <span class="hljs-attribute">color</span>: green; &#125;<br><span class="hljs-selector-tag">h1</span><span class="hljs-selector-attr">[title="titan"]</span><span class="hljs-selector-attr">[class="highlight"]</span> &#123; <span class="hljs-attribute">color</span>: blue; &#125;<br><span class="hljs-selector-tag">h1</span><span class="hljs-selector-attr">[class~="text"]</span> &#123; <span class="hljs-attribute">color</span>: purple; &#125;<br><span class="hljs-selector-tag">h2</span><span class="hljs-selector-attr">[class|="text"]</span> &#123; <span class="hljs-attribute">color</span>: olive; &#125;<br><span class="hljs-selector-tag">h1</span><span class="hljs-selector-attr">[class="alert"]</span>, <span class="hljs-selector-tag">h1</span><span class="hljs-selector-attr">[class="alert-primary"]</span> &#123; <span class="hljs-attribute">color</span>: gray; &#125;<br></code></pre></td></tr></table></figure><ul><li><code>h1[title]</code>ï¼šå¸¶æœ‰ <code>title</code> å±¬æ€§çš„ <code>h1</code> å…ƒç´ </li><li><code>h2[title=&quot;titan&quot;]</code>ï¼šå¸¶æœ‰ <code>title</code> å±¬æ€§çš„ <code>h2</code> å…ƒç´ ï¼Œä¸¦ä¸”è©²å±¬æ€§å€¼ç‚º <code>titan</code></li><li><code>h1[title=&quot;titan&quot;][class=&quot;highlight&quot;]</code>ï¼šå¸¶æœ‰ <code>title</code> å’Œ <code>class</code> å±¬æ€§çš„ <code>h1</code> å…ƒç´ ï¼Œä¸¦ä¸” <code>title</code> çš„å±¬æ€§å€¼ç‚º <code>titan</code> ä»¥åŠ <code>class</code> å±¬æ€§å€¼ç‚º <code>highlight</code></li><li><code>h1[class~=&quot;text&quot;]</code>ï¼šå¸¶æœ‰ <code>class</code> å±¬æ€§çš„ <code>h1</code> å…ƒç´ ï¼Œä¸¦ä¸”è©²å±¬æ€§å€¼éœ€åŒ…å« <code>text</code></li><li><code>h2[class|=&quot;text&quot;]</code>ï¼šå¸¶æœ‰ <code>class</code> å±¬æ€§çš„ <code>h2</code> å…ƒç´ ï¼Œä¸¦ä¸”è©²å±¬æ€§å€¼ç‚ºéœ€ç‚º <code>text</code> æˆ–ä»¥ <code>text-</code> ç‚ºé–‹é ­</li><li><code>h1[class=&quot;alert&quot;], h1[class=&quot;alert-primary&quot;]</code>ï¼šå¸¶æœ‰ <code>class</code> å±¬æ€§çš„ <code>h1</code> å…ƒç´ ï¼Œä¸¦ä¸”è©²å±¬æ€§å€¼ç‚º <code>alert</code>ï¼Œä»¥åŠå¸¶æœ‰ <code>class</code> å±¬æ€§çš„ <code>h1</code> å…ƒç´ ï¼Œä¸¦ä¸”è©²å±¬æ€§å€¼ç‚º <code>alert-primary</code></li></ul><div class="info"><p>è¨»ï¼š<code>[title=&quot;titan&quot;]</code> ä¸­çš„ <code>title</code> æ˜¯å±¬æ€§åç¨±ï¼Œ<code>titan</code> æ˜¯åç‚º <code>title</code> çš„å±¬æ€§å€¼ã€‚</p></div><p>Demoï¼š<a href="https://codepen.io/titangene/pen/MWgPyyG" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-2/attribute-presence-and-value-selector.png" alt=""></p><iframe height="590" style="width:100%" scrolling="no" title="Attribute presence and value selectors" src="https://codepen.io/titangene/embed/MWgPyyG/?height=590&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/MWgPyyG/" target="_blank" rel="noopener">Attribute presence and value selectors</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h3 id="substring-matching-attribute-selector"><a class="header-anchor" href="#substring-matching-attribute-selector"></a>Substring matching attribute selector</h3><p>åœ¨ <a href="https://www.w3.org/TR/selectors-3/#attribute-substrings" target="_blank" rel="noopener">Selectors Level 3</a> æä¾›äº†ä¸‰å€‹é¡å¤–çš„ attribute selectorï¼Œç”¨æ–¼ match å±¬æ€§å€¼ä¸­çš„å­å­—ä¸²ï¼š</p><ul><li><code>[att^=val]</code>ï¼šä»£è¡¨å…·æœ‰ <code>att</code> å±¬æ€§çš„å…ƒç´ ï¼Œè©²å±¬æ€§å€¼ä»¥ <code>val</code> ç‚ºé–‹é ­ã€‚å¦‚æœ <code>val</code> æ˜¯ç©ºå­—ä¸²ï¼Œå‰‡ selector ä¸ä»£è¡¨ä»»ä½•å…§å®¹</li><li><code>[att$=val]</code>ï¼šä»£è¡¨å…·æœ‰ <code>att</code> å±¬æ€§çš„å…ƒç´ ï¼Œè©²å±¬æ€§å€¼ä»¥ <code>val</code> ç‚ºçµå°¾ã€‚å¦‚æœ <code>val</code> æ˜¯ç©ºå­—ä¸²ï¼Œå‰‡ selector ä¸ä»£è¡¨ä»»ä½•å…§å®¹</li><li><code>[att*=val]</code>ï¼šä»£è¡¨å…·æœ‰ <code>att</code> å±¬æ€§çš„å…ƒç´ ï¼Œè©²å±¬æ€§å€¼è‡³å°‘åŒ…å« <code>val</code> é€™å€‹å­å­—ä¸²ã€‚å¦‚æœ <code>val</code> æ˜¯ç©ºå­—ä¸²ï¼Œå‰‡ selector ä¸ä»£è¡¨ä»»ä½•å…§å®¹</li></ul><p>ç›´æ¥çœ‹ç¯„ä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"textPrimary"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-primary"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://titangene.github.io/article/css-selector-2.html"</span>&gt;</span>é‡æ–°èªè­˜ CSS - CSS Selector (2)<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://titangene.github.io"</span>&gt;</span>Titangene Blog<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"my-alert"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"myAlertPrimary"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"my-alert-primary"</span>&gt;</span>Text<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h2</span><span class="hljs-selector-attr">[class^="text"]</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br><span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[href$=".html"]</span> &#123; <span class="hljs-attribute">color</span>: gray; &#125;<br><span class="hljs-selector-tag">h2</span><span class="hljs-selector-attr">[class*="alert"]</span> &#123; <span class="hljs-attribute">color</span>: green; &#125;<br></code></pre></td></tr></table></figure><ul><li><code>h2[class^=&quot;text&quot;]</code>ï¼šä»£è¡¨å…·æœ‰ <code>class</code> å±¬æ€§çš„å…ƒç´ ï¼Œè©²å±¬æ€§å€¼ä»¥ <code>text</code> ç‚ºé–‹é ­</li><li><code>a[href$=&quot;.html&quot;]</code>ï¼šä»£è¡¨å…·æœ‰ <code>href</code> å±¬æ€§çš„å…ƒç´ ï¼Œè©²å±¬æ€§å€¼ä»¥ <code>.html</code> ç‚ºçµå°¾ (ä¹Ÿå°±æ˜¯è©²é é¢ç‚º <code>.html</code> æª”)</li><li><code>h2[class*=&quot;alert&quot;]</code>ï¼šä»£è¡¨å…·æœ‰ <code>class</code> å±¬æ€§çš„å…ƒç´ ï¼Œè©²å±¬æ€§å€¼è‡³å°‘åŒ…å« <code>alert</code> é€™å€‹å­å­—ä¸²</li></ul><p>Demoï¼š<a href="https://codepen.io/titangene/pen/vYBVKEm" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-2/substring-matching-attribute-selector.png" alt=""></p><iframe height="383" style="width:100%" scrolling="no" title="Substring matching attribute selectors" src="https://codepen.io/titangene/embed/vYBVKEm/?height=383&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/vYBVKEm/" target="_blank" rel="noopener">Substring matching attribute selectors</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h2 id="æœ€å¾Œ"><a class="header-anchor" href="#æœ€å¾Œ"></a>æœ€å¾Œ</h2><p>ä»Šå¤©ä»‹ç´¹ä¸€äº› attribute selectorï¼Œæ¥ä¸‹ä¾†å¹¾å¤©æœƒæ¥çºŒä»‹ç´¹å…¶ä»– selectorã€‚</p><p>è³‡æ–™ä¾†æºï¼š</p><ul><li><a href="https://www.w3.org/TR/CSS22/selector.html" target="_blank" rel="noopener">CSS 2.2 Specification - Selectors</a></li><li><a href="https://www.w3.org/TR/selectors-3/" target="_blank" rel="noopener">Selectors Level 3</a></li><li><a href="https://www.w3.org/TR/selectors-4/" target="_blank" rel="noopener">Selectors Level 4</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/css.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Selector (é¸æ“‡å™¨) å¯ç”¨ä¾†é¸æ“‡ HTML å’Œ XML æ–‡ä»¶ä¸­çš„ç¯€é»ï¼Œä¸¦å°‡æ¨£å¼å±¬æ€§ç¶å®šåˆ°æ–‡ä»¶ (HTML å’Œ XML) ä¸­çš„å…ƒç´ ä¸Šã€‚ç•¶é¸æ“‡å™¨èˆ‡æŸå…ƒç´  match çš„æ™‚å€™ï¼Œå°±å¯ä»¥å°é¸åˆ°çš„å…ƒç´ é€²è¡Œ CSS æ¨£å¼è¨­å®šã€‚æœ¬ç¯‡æœƒä»‹ç´¹ attribute selector (å±¬æ€§é¸æ“‡å™¨)ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://titangene.github.io/categories/css/"/>
    
    
      <category term="IT éµäººè³½" scheme="https://titangene.github.io/tags/it-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>é‡æ–°èªè­˜ CSS - CSS Selector (1)</title>
    <link href="https://titangene.github.io/article/css-selector-1.html"/>
    <id>https://titangene.github.io/article/css-selector-1.html</id>
    <published>2019-09-17T10:20:52.000Z</published>
    <updated>2019-09-18T07:17:17.853Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/css.png" alt=""></p><p>Selector (é¸æ“‡å™¨) å¯ç”¨ä¾†é¸æ“‡ HTML å’Œ XML æ–‡ä»¶ä¸­çš„ç¯€é»ï¼Œä¸¦å°‡æ¨£å¼å±¬æ€§ç¶å®šåˆ°æ–‡ä»¶ (HTML å’Œ XML) ä¸­çš„å…ƒç´ ä¸Šã€‚ç•¶é¸æ“‡å™¨èˆ‡æŸå…ƒç´  match çš„æ™‚å€™ï¼Œå°±å¯ä»¥å°é¸åˆ°çš„å…ƒç´ é€²è¡Œ CSS æ¨£å¼è¨­å®šã€‚</p><a id="more"></a><h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€"></a>å‰è¨€</h2><blockquote><p>ã€Œé‡æ–°èªè­˜ CSSã€é€™å€‹ç³»åˆ—åç¨±çš„ç”±ä¾†å°±å¦‚å…¶åï¼Œæˆ‘æƒ³è¦é‡æ–°èªè­˜å®ƒã€‚é›–ç„¶ä»¥å‰å°±æœ‰å­¸é CSSï¼Œä½†é€™æ¬¡æƒ³å¾ CSS Spec ä¸­å­¸åˆ°æœ€åŸå§‹çš„å®šç¾©å’Œå…§å®¹ï¼Œæ›´åŠ äº†è§£ CSS çš„åŸç†ï¼Œè®“æˆ‘åœ¨åˆ‡ç‰ˆçš„æ™‚å€™å¯ä»¥æ›´åŠ ç¢ºå®šè‡ªå·±åœ¨åšä»€éº¼ï¼Œæˆ‘è¸©åˆ°çš„é›·åªæ˜¯å› ç‚ºæˆ‘ä¸å¤ äº†è§£å®ƒæ‰æœƒç‚¸é–‹ã€‚</p><p>åœ¨é€™ 30 å¤©çš„å…§å®¹ä¸­ï¼Œæœƒå°‡ Spec å…§çœ‹åˆ°çš„è³‡æ–™æ•´ç†æˆé€™å€‹ç³»åˆ—ï¼Œä¹Ÿå¸Œæœ›æ­£åœ¨å­¸ CSS çš„å„ä½å¯ä»¥æ›´åŠ äº†è§£å®ƒã€‚å¦å¤–æˆ‘ä¹ŸæœƒåŒæ™‚å°‡æ–‡ç« ç™¼è‡³æˆ‘çš„ Blogï¼Œå¦‚æœæƒ³ç›´æ¥çœ‹æ–‡å…§çš„ç¨‹å¼ç¢¼ Demo ç•«é¢ï¼Œå¯ä»¥åˆ°æˆ‘çš„ Blog ä¾†çœ‹ ğŸ˜ƒã€‚</p><p>æœ¬æ–‡åŒæ­¥ç™¼è¡¨æ–¼ iT é‚¦å¹«å¿™ï¼š<a href="https://ithelp.ithome.com.tw/articles/10216566" target="_blank" rel="noopener">é‡æ–°èªè­˜ CSS - CSS Selector (1)</a></p><p>ã€Œé‡æ–°èªè­˜ CSSã€ç³»åˆ—æ–‡ç« ç™¼æ–‡æ–¼ï¼š</p><ul><li><a href="https://ithelp.ithome.com.tw/users/20117586/ironman/2617" target="_blank" rel="noopener">iT é‚¦å¹«å¿™</a></li><li><a href="https://titangene.github.io/tags/it-%E9%90%B5%E4%BA%BA%E8%B3%BD/">Titangene Blog</a></li></ul></blockquote><h2 id="selector-èªæ³•"><a class="header-anchor" href="#selector-èªæ³•"></a>Selector èªæ³•</h2><p>Selector æ˜¯ç”±ä¸€å€‹æˆ–å¤šå€‹ simple selector (ç°¡å–®é¸æ“‡å™¨) åºåˆ—çµ„åˆï¼Œä¸¦ç”¨ combinator åˆ†éš”çš„ä¸€ä¸²æ±è¥¿ã€‚</p><p>simple selector åºåˆ—ï¼š</p><ul><li>ç”±å¤šå€‹ simple selector çµ„æˆï¼Œæ²’æœ‰è¢« combinator åˆ†éš”</li><li>ä»¥ type selector æˆ– universal selector ç‚ºé–‹é ­</li></ul><p>ä»¥ä¸‹é€™äº›éƒ½æ˜¯ simple selectorï¼š</p><ul><li>type selectorï¼šä¾‹å¦‚ <code>E</code></li><li>universal selectorï¼šä¾‹å¦‚ <code>*</code></li><li>attribute selectorï¼šä¾‹å¦‚ <code>E[foo]</code></li><li>class selectorï¼šä¾‹å¦‚ <code>.myclass</code></li><li>ID selectorï¼šä¾‹å¦‚ <code>#myid</code></li><li>pseudo-classï¼šä¾‹å¦‚ <code>E:hover</code></li></ul><p>combinator æ˜¯ <code></code> (ç©ºç™½å­—å…ƒ)ã€<code>&gt;</code>ã€<code>+</code>ã€<code>~</code>ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs undefined">E F &#123; color: red; &#125;<br>E &gt; F &#123; color: red; &#125;<br>E + F &#123; color: red; &#125;<br>E ~ F &#123; color: red; &#125;<br></code></pre></td></tr></table></figure><p>simple selector èˆ‡ combinator ä¹‹é–“å¯ä»¥åŠ ä¸Šç©ºç™½ï¼Œä¸åŠ ç©ºç™½ä¹Ÿå¯ä»¥ã€‚ä¾‹å¦‚ï¼šä¸‹é¢å…©å€‹é¸æ“‡å™¨æ˜¯ç›¸åŒçš„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs undefined">E &gt; F<br>E&gt;F<br></code></pre></td></tr></table></figure><p>ä¸éï¼Œé€šå¸¸åœ¨ä¹‹é–“éƒ½æœƒåŠ ç©ºç™½ï¼Œå› ç‚ºå¯è®€æ€§è¼ƒä½³ã€‚</p><h2 id="groups-of-selector"><a class="header-anchor" href="#groups-of-selector"></a>Groups of selector</h2><p>ç•¶å¤šå€‹é¸æ“‡å™¨å…±äº«ç›¸åŒçš„å®£å‘Šæ™‚ï¼Œå®ƒå€‘å¯ä»¥ç”¨é€—è™Ÿä¾†åˆ†éš”æ¯å€‹é¸æ“‡å™¨ï¼Œæ¯å€‹é¸æ“‡å™¨éƒ½æœƒé¸åˆ° match çš„æ‰€æœ‰å…ƒç´ ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>header 2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>header 3<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br><span class="hljs-selector-tag">h2</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br><span class="hljs-selector-tag">h3</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>ç­‰åŒæ–¼ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span>, <span class="hljs-selector-tag">h2</span>, <span class="hljs-selector-tag">h3</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/ExYevee" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-1/2019-09-17-15-40-57.png" alt=""></p><p><img src="../images/css-selector-1/2019-09-17-15-41-34.png" alt=""></p><iframe height="244" style="width:100%" scrolling="no" title="Groups of selector" src="https://codepen.io/titangene/embed/ExYevee/?height=244&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/ExYevee/" target="_blank" rel="noopener">Groups of selector</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><p>ä¸è¦è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢å…©å€‹ç¯„ä¾‹æœƒæœ‰ä¸€æ¨£çš„çµæœæ˜¯å› ç‚ºæ‰€æœ‰é¸æ“‡å™¨éƒ½æ˜¯æœ‰æ•ˆçš„é¸æ“‡å™¨ (valid selector)ã€‚å¦‚æœå…¶ä¸­ä¸€å€‹é¸æ“‡å™¨ç‚ºç„¡æ•ˆæ™‚ï¼Œå°±æœƒè®“æ•´å€‹é¸æ“‡å™¨ç¾¤çµ„éƒ½ç„¡æ•ˆã€‚ä¸éï¼Œè‹¥å°‡ä¸‰å€‹é¸æ“‡å™¨åˆ†é–‹å®£å‘Šæ™‚ï¼Œå°±åªæœ‰é‚£ä¸€å€‹æœƒå¤±æ•ˆã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>header 2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>header 3<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br><span class="hljs-selector-tag">h2</span>.<span class="hljs-selector-class">.foo</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br><span class="hljs-selector-tag">h3</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>ä¸ç­‰æ–¼ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span>, <span class="hljs-selector-tag">h2</span>.<span class="hljs-selector-class">.foo</span>, <span class="hljs-selector-tag">h3</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/gOYdxQP" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p>å¦‚ä¸‹åœ–ï¼Œå› ç‚ºä¸Šé¢å…¶ä¸­çš„ <code>h2..foo</code> æ˜¯ç„¡æ•ˆé¸æ“‡å™¨ (invalid selector)ï¼Œæ‰€ä»¥æœƒé€ æˆ <code>h1, h2..foo, h3</code> å®Œå…¨ç„¡æ•ˆï¼Œä¸¦ä¸”æœƒåˆªé™¤é€™å€‹æ¨£å¼è¦å‰‡ï¼š</p><p><img src="../images/css-selector-1/2019-09-17-15-37-08.png" alt=""></p><p>å¦‚æœæ˜¯åˆ†é–‹å®£å‘Šï¼Œå°±åªæœƒåˆªé™¤ <code>h2..foo</code> é€™å€‹æ¨£å¼è¦å‰‡ï¼Œå¦‚ä¸‹åœ–ï¼š</p><p><img src="../images/css-selector-1/2019-09-17-15-38-56.png" alt=""></p><iframe height="268" style="width:100%" scrolling="no" title="Groups of selector: valid selector" src="https://codepen.io/titangene/embed/gOYdxQP/?height=268&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/gOYdxQP/" target="_blank" rel="noopener">Groups of selector: valid selector</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h2 id="simple-selector"><a class="header-anchor" href="#simple-selector"></a>Simple selector</h2><p>ä»¥ä¸‹é€™äº›éƒ½æ˜¯ simple selectorï¼š</p><ul><li>type selector</li><li>universal selector</li><li>attribute selector</li><li>class selector</li><li>ID selector</li><li>pseudo-class</li></ul><h3 id="type-selector"><a class="header-anchor" href="#type-selector"></a>Type selector</h3><p>é¸åˆ° HTML tag åç¨±çš„å…ƒç´ ï¼Œä¾‹å¦‚ï¼šmatch æ‰€æœ‰ h1 å…ƒç´ ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/JjPaMpm" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-1/2019-09-17-15-45-55.png" alt=""></p><iframe height="265" style="width:100%" scrolling="no" title="type selector" src="https://codepen.io/titangene/embed/JjPaMpm/?height=265&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/JjPaMpm/" target="_blank" rel="noopener">type selector</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h3 id="universal-selector"><a class="header-anchor" href="#universal-selector"></a>Universal Selector</h3><p>Universal selector æ˜¯ä½¿ç”¨ <code>*</code> ä¾† match ä»»ä½•å…ƒç´ ã€‚</p><p>ä¾‹å¦‚ï¼šä¸‹é¢ç¯„ä¾‹å¯ä»¥é¸åˆ°æ‰€æœ‰å…ƒç´ ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>header 2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>header 3<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://titangene.github.io/"</span>&gt;</span>Titangene Blog<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">* &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/NWKLvQg" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-1/2019-09-17-15-47-50.png" alt=""></p><iframe height="285" style="width:100%" scrolling="no" title="Universal Selector" src="https://codepen.io/titangene/embed/NWKLvQg/?height=285&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/NWKLvQg/" target="_blank" rel="noopener">Universal Selector</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h3 id="class-selector"><a class="header-anchor" href="#class-selector"></a>Class selector</h3><p>å¦‚æœè¦å°å¤šå€‹å…ƒç´ éœ€è¦ç›¸åŒçš„æ¨£å¼æ™‚ï¼Œå°±å¯ä»¥ç”¨ <code>class</code> é€™å€‹å±¬æ€§ä¾†æ¨™è­˜å®ƒå€‘ã€‚åœ¨ CSS æ˜¯ä½¿ç”¨ <code>.</code> ä¾†ä»£è¡¨ class å±¬æ€§ï¼Œä¹Ÿç­‰åŒæ–¼ <code>~=</code> è¡¨ç¤ºæ³• (notation)ï¼Œå±¬æ€§å€¼å¿…é ˆåœ¨ <code>.</code> ä¹‹å¾Œã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"highlight"</span>&gt;</span>highlight header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span><span class="hljs-selector-class">.highlight</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>ç­‰åŒæ–¼ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span><span class="hljs-selector-attr">[class~=highlight]</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/gOYdXOe" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p>ç¬¬ä¸€å€‹ <code>h1</code> å…ƒç´ çš„å­—é«”é¡è‰²ä¸æœƒè®Šæˆç´…è‰²ï¼Œåªæœ‰ç¬¬äºŒå€‹ <code>h1</code> å…ƒç´ æ‰æœƒè®Šç´…è‰²ï¼š</p><p><img src="../images/css-selector-1/2019-09-17-16-46-57.png" alt=""></p><p><img src="../images/css-selector-1/2019-09-17-16-47-15.png" alt=""></p><iframe height="240" style="width:100%" scrolling="no" title="class selector" src="https://codepen.io/titangene/embed/gOYdXOe/?height=240&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/gOYdXOe/" target="_blank" rel="noopener">class selector</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><p>å¦‚æœåªå–®ç¨ä½¿ç”¨ class selector (ä¹Ÿå°±æ˜¯ <code>.</code> )ï¼Œä¹Ÿç­‰åŒæ–¼åœ¨å‰é¢åŠ ä¸Š universal selector (ä¹Ÿå°±æ˜¯ <code>*</code> )ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"highlight"</span>&gt;</span>highlight header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>header 2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"highlight"</span>&gt;</span>highlight header 2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">*<span class="hljs-selector-class">.highlight</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.highlight</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/GRKXOZx" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p>ç¬¬ä¸€å€‹ <code>h1</code> å’Œ <code>h2</code> å…ƒç´ çš„å­—é«”é¡è‰²ä¸æœƒè®Šæˆç´…è‰²ï¼Œåªæœ‰ç¬¬äºŒå€‹ <code>h1</code> å’Œ <code>h2</code> å…ƒç´ æ‰æœƒè®Šç´…è‰²ï¼š</p><p><img src="../images/css-selector-1/2019-09-17-16-53-46.png" alt=""></p><p><img src="../images/css-selector-1/2019-09-17-16-55-21.png" alt=""></p><iframe height="320" style="width:100%" scrolling="no" title="class selector &amp; universal selector" src="https://codepen.io/titangene/embed/GRKXOZx/?height=320&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/GRKXOZx/" target="_blank" rel="noopener">class selector &amp; universal selector</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><p>å¦‚æœéœ€è¦åŒæ™‚æŒ‡å®šæŸå…ƒç´ ä¸Šçš„å…©å€‹ classï¼Œå¯ä»¥å¯«æˆé€™æ¨£ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-primary highlight"</span>&gt;</span>highlight header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>header 2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"highlight"</span>&gt;</span>highlight header 2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.text-primary</span><span class="hljs-selector-class">.highlight</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><div class="info"><p>è¨»ï¼šåœ¨ HTML è¦å°æŸå…ƒç´ ä¸ŠåŒæ™‚è¨­å®šå¤šå€‹ classï¼Œæ˜¯ä½¿ç”¨ç©ºç™½å­—å…ƒä¾†åˆ†éš”å¤šå€‹ classã€‚ä»¥ä¸Šé¢ç¯„ä¾‹ä¾†èªªï¼Œç¬¬äºŒå€‹ <code>h1</code> ä¸Šæœ‰å…©å€‹ classï¼Œåˆ†åˆ¥æ˜¯ <code>text-primary</code> å’Œ <code>highlight</code>ã€‚</p></div><p>Demoï¼š<a href="https://codepen.io/titangene/pen/WNegdxr" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-1/2019-09-17-17-27-15.png" alt=""></p><iframe height="320" style="width:100%" scrolling="no" title="multi class selector" src="https://codepen.io/titangene/embed/WNegdxr/?height=320&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/WNegdxr/" target="_blank" rel="noopener">multi class selector</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h3 id="id-selector"><a class="header-anchor" href="#id-selector"></a>ID selector</h3><p>å¦‚æœè¦å°æŸå€‹å…ƒç´ ä½œå”¯ä¸€çš„æ¨™ç¤ºï¼Œå°±å¯ä»¥ç”¨ <code>id</code> é€™å€‹å±¬æ€§ä¾†æ¨™è­˜å®ƒå€‘ã€‚åœ¨ CSS æ˜¯ä½¿ç”¨ <code>#</code> ä¾†ä»£è¡¨ id å±¬æ€§ï¼Œå±¬æ€§å€¼å¿…é ˆåœ¨ <code>#</code> ä¹‹å¾Œã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"titan"</span>&gt;</span>header 1<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>header 2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"titan"</span>&gt;</span>header 2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-id">#titan</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/GRKXyjb" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-1/2019-09-17-17-52-36.png" alt=""></p><iframe height="320" style="width:100%" scrolling="no" title="id selector" src="//codepen.io/titangene/embed/GRKXyjb/?height=320&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/GRKXyjb/" target="_blank" rel="noopener">id selector</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><p>å¦‚æœåªæƒ³é¸æ“‡å¸¶æœ‰ <code>titan</code> é€™å€‹ id çš„ <code>h2</code> å…ƒç´ ï¼Œå¯ä»¥å¯«æˆé€™æ¨£ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h2</span><span class="hljs-selector-id">#titan</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š<a href="https://codepen.io/titangene/pen/KKPxZma" target="_blank" rel="noopener">Codepen é€£çµ</a></p><p><img src="../images/css-selector-1/2019-09-17-17-56-01.png" alt=""></p><iframe height="320" style="width:100%" scrolling="no" title="id selector: specific element" src="//codepen.io/titangene/embed/KKPxZma/?height=320&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/KKPxZma/" target="_blank" rel="noopener">id selector: specific element</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h2 id="æœ€å¾Œ"><a class="header-anchor" href="#æœ€å¾Œ"></a>æœ€å¾Œ</h2><p>ä»Šå¤©ä»‹ç´¹ä¸€äº› simple selectorï¼Œæ¥ä¸‹ä¾†å¹¾å¤©æœƒæ¥çºŒä»‹ç´¹å…¶ä»– selectorã€‚</p><p>è³‡æ–™ä¾†æºï¼š</p><ul><li><a href="https://www.w3.org/TR/CSS22/selector.html" target="_blank" rel="noopener">CSS 2.2 Specification - Selectors</a></li><li><a href="https://www.w3.org/TR/selectors-3/" target="_blank" rel="noopener">Selectors Level 3</a></li><li><a href="https://www.w3.org/TR/selectors-4/" target="_blank" rel="noopener">Selectors Level 4</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/css.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Selector (é¸æ“‡å™¨) å¯ç”¨ä¾†é¸æ“‡ HTML å’Œ XML æ–‡ä»¶ä¸­çš„ç¯€é»ï¼Œä¸¦å°‡æ¨£å¼å±¬æ€§ç¶å®šåˆ°æ–‡ä»¶ (HTML å’Œ XML) ä¸­çš„å…ƒç´ ä¸Šã€‚ç•¶é¸æ“‡å™¨èˆ‡æŸå…ƒç´  match çš„æ™‚å€™ï¼Œå°±å¯ä»¥å°é¸åˆ°çš„å…ƒç´ é€²è¡Œ CSS æ¨£å¼è¨­å®šã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://titangene.github.io/categories/css/"/>
    
    
      <category term="IT éµäººè³½" scheme="https://titangene.github.io/tags/it-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>é‡æ–°èªè­˜ CSS - CSS ç°¡ä»‹</title>
    <link href="https://titangene.github.io/article/css-introduction.html"/>
    <id>https://titangene.github.io/article/css-introduction.html</id>
    <published>2019-09-16T10:10:11.000Z</published>
    <updated>2019-09-16T13:58:19.006Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/css.png" alt=""></p><p>CSS æ˜¯ Cascading Style Sheets çš„ç¸®å¯«ï¼Œæ˜¯ä¸€ç¨® style sheet (æ¨£å¼è¡¨) èªè¨€ï¼Œå¯å°‡è‡ªè¨‚çš„æ¨£å¼ (ä¾‹å¦‚ï¼šå­—é«”ã€é¡è‰²) é™„åŠ åœ¨ HTML æ–‡ä»¶ä¸Šã€‚é€™ç¯‡æœƒå…ˆç°¡ä»‹ CSSï¼Œä»¥åŠå¦‚ä½•åœ¨ HTML è¨­å®š CSSã€‚</p><a id="more"></a><h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€"></a>å‰è¨€</h2><blockquote><p>ã€Œé‡æ–°èªè­˜ CSSã€é€™å€‹ç³»åˆ—åç¨±çš„ç”±ä¾†å°±å¦‚å…¶åï¼Œæˆ‘æƒ³è¦é‡æ–°èªè­˜å®ƒã€‚é›–ç„¶ä»¥å‰å°±æœ‰å­¸é CSSï¼Œä½†é€™æ¬¡æƒ³å¾ CSS Spec ä¸­å­¸åˆ°æœ€åŸå§‹çš„å®šç¾©å’Œå…§å®¹ï¼Œæ›´åŠ äº†è§£ CSS çš„åŸç†ï¼Œè®“æˆ‘åœ¨åˆ‡ç‰ˆçš„æ™‚å€™å¯ä»¥æ›´åŠ ç¢ºå®šè‡ªå·±åœ¨åšä»€éº¼ï¼Œæˆ‘è¸©åˆ°çš„é›·åªæ˜¯å› ç‚ºæˆ‘ä¸å¤ äº†è§£å®ƒæ‰æœƒç‚¸é–‹ã€‚</p><p>åœ¨é€™ 30 å¤©çš„å…§å®¹ä¸­ï¼Œæœƒå°‡ Spec å…§çœ‹åˆ°çš„è³‡æ–™æ•´ç†æˆé€™å€‹ç³»åˆ—ï¼Œä¹Ÿå¸Œæœ›æ­£åœ¨å­¸ CSS çš„å„ä½å¯ä»¥æ›´åŠ äº†è§£å®ƒã€‚å¦å¤–æˆ‘ä¹ŸæœƒåŒæ™‚å°‡æ–‡ç« ç™¼è‡³æˆ‘çš„ Blogï¼Œå¦‚æœæƒ³ç›´æ¥çœ‹æ–‡å…§çš„ç¨‹å¼ç¢¼ Demo ç•«é¢ï¼Œå¯ä»¥åˆ°æˆ‘çš„ Blog ä¾†çœ‹ ğŸ˜ƒã€‚</p></blockquote><p>CSS è¦å‰‡æ˜¯ç”± selector å’Œå®£å‘Š (declaration) çµ„æˆï¼Œä»¥ä¸‹é¢ç¨‹å¼ç¢¼çš„ CSS è¦å‰‡ç‚ºä¾‹ï¼Œ<code>h1</code> å°±æ˜¯ selectorï¼Œ<code>color: red</code> å°±æ˜¯å®£å‘Šã€‚åœ¨ HTML ä¸­ï¼Œå…ƒç´ åç¨±ä¸åˆ†å¤§å°å¯«ï¼Œä¾‹å¦‚ï¼š<code>H1</code> å’Œ <code>h1</code> ç›¸åŒï¼Œä½†é€šå¸¸æœƒå¯«å°å¯«ã€‚</p><p>å®£å‘Šåˆç”±å±¬æ€§åç¨±å’Œå±¬æ€§å€¼çµ„æˆï¼Œä»¥ä¸‹é¢ç¨‹å¼ç¢¼ç‚ºä¾‹ï¼Œ<code>color</code> å°±æ˜¯å±¬æ€§åç¨±ï¼Œ<code>red</code> å°±æ˜¯å±¬æ€§å€¼ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><h2 id="åœ¨-html-è¨­å®š-css"><a class="header-anchor" href="#åœ¨-html-è¨­å®š-css"></a>åœ¨ HTML è¨­å®š CSS</h2><p>è¦åœ¨ HTML å…§è¨­å®š CSS æœ‰ä¸‰ç¨®æ–¹æ³•ï¼š</p><ul><li>Inline CSSï¼šå…ƒç´ ä¸Šçš„ <code>style</code> å±¬æ€§</li><li>Internal CSSï¼š<code>style</code> å…ƒç´ </li><li>External CSSï¼š<code>link</code> å…ƒç´ å¼•å…¥å¤–éƒ¨ CSS</li></ul><h3 id="inline-cssï¼šå…ƒç´ ä¸Šçš„-style-å±¬æ€§"><a class="header-anchor" href="#inline-cssï¼šå…ƒç´ ä¸Šçš„-style-å±¬æ€§"></a>Inline CSSï¼šå…ƒç´ ä¸Šçš„ <code>style</code> å±¬æ€§</h3><ul><li>åœ¨æŒ‡å®šçš„å…ƒç´ ä¸Šé€é <code>style</code> å±¬æ€§ä¾†è¨­å®š CSS æ¨£å¼</li><li>ç›¸åŒçš„æ¨£å¼ç„¡æ³•å…±ç”¨ï¼Œå¦‚æœè¦åœ¨ä¸åŒå…ƒç´ è¨­å®šç›¸åŒçš„æ¨£å¼ï¼Œå°±éœ€è¦åœ¨æ¯å€‹å…ƒç´ ä¸Šè¨­å®š <code>style</code> å±¬æ€§</li><li>CSS æ¨£å¼èˆ‡ HTML çµæ§‹å¯«åœ¨ä¸€èµ·ï¼Œå¯è®€æ€§å·®ï¼Œä¸å»ºè­°é€™æ¨£å¯«</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color: red;"</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color: red;"</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>Demoï¼š</p><p><img src="../images/css-introduction/css-style-attr.png" alt=""></p><iframe height="214" style="width:100%" scrolling="no" title="Inline CSS" src="https://codepen.io/titangene/embed/JjPBmzR/?height=214&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen>See the Pen <a href="https://codepen.io/titangene/pen/JjPBmzR/" target="_blank" rel="noopener">Inline CSS</a> by Titangene (<a href="https://codepen.io/titangene" target="_blank" rel="noopener">@titangene</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h3 id="internal-cssï¼šstyle-å…ƒç´ "><a class="header-anchor" href="#internal-cssï¼šstyle-å…ƒç´ "></a>Internal CSSï¼š<code>style</code> å…ƒç´ </h3><ul><li>ç›´æ¥åœ¨ HTML åŸå§‹ç¢¼å…§åˆ©ç”¨ <code>style</code> å…ƒç´ ä¾†è¨­å®š CSS</li><li>åªèƒ½åœ¨å–®ç¨çš„ HTML å…§ä½¿ç”¨ <code>style</code> å…ƒç´ è£¡çš„æ¨£å¼</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><br>      <span class="hljs-selector-tag">h1</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br>    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>Demoï¼š</p><p><img src="../images/css-introduction/title-red.png" alt=""></p><h3 id="external-cssï¼šlink-å…ƒç´ å¼•å…¥å¤–éƒ¨-css"><a class="header-anchor" href="#external-cssï¼šlink-å…ƒç´ å¼•å…¥å¤–éƒ¨-css"></a>External CSSï¼š<code>link</code> å…ƒç´ å¼•å…¥å¤–éƒ¨ CSS</h3><ul><li>ä½¿ç”¨ <code>link</code> å…ƒç´ å¼•å…¥å¤–éƒ¨ CSS æª”æ¡ˆå…§çš„æ¨£å¼</li><li>å¯å°‡ HTML èˆ‡ CSS çš„åŸå§‹ç¢¼åˆ†é–‹ç®¡ç†<ul><li>è‹¥è¦æ›´æ”¹æ¨£å¼ï¼Œåªè¦æ›´æ›æˆå…¶ä»– CSS æª”æ¡ˆæˆ–ä¿®æ”¹å¤–éƒ¨ CSS æª”æ¡ˆå…§çš„æ¨£å¼</li></ul></li><li>åŒä¸€ä»½ CSS æ¨£å¼å¯å¥—ç”¨è‡³å¤šå€‹ HTML æ–‡ä»¶ä½¿ç”¨</li><li>å¸¸è¦‹æœƒä½¿ç”¨ CDN (Content Delivery Network)</li></ul><p><a href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element" target="_blank" rel="noopener"><code>link</code> å…ƒç´ </a> ä¸Šçš„è¨­å®šï¼š</p><ul><li>ç”¨ <code>rel</code> å±¬æ€§ (relationships) è¨­å®šé€£çµé¡å‹ï¼š<code>stylesheet</code></li><li>ç”¨ <code>href</code> å±¬æ€§ (hyperlink reference) æŒ‡å®šçš„ CSS è·¯å¾‘</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"./style.css"</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸‹é¢å…§å®¹ç‚º <code>style.css</code>ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>Demoï¼š</p><p><img src="../images/css-introduction/title-red.png" alt=""></p><h3 id="multiple-style-sheets"><a class="header-anchor" href="#multiple-style-sheets"></a>Multiple Style Sheets</h3><p>å¦‚æœä»¥ä¸åŒçš„æ–¹å¼ä¾†å°åŒä¸€å€‹å…ƒç´ è¨­å®šæ¨£å¼ï¼Œå‰‡æœƒä½¿ç”¨æœ€å¾Œè¨­å®šçš„æ¨£å¼ã€‚</p><p>ä¾‹å¦‚ï¼šåŒæ™‚ä½¿ç”¨ internal CSS å’Œ external CSS çš„æ–¹å¼è¨­å®š CSSï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"./style.css"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><br>      <span class="hljs-selector-tag">h1</span> &#123; <span class="hljs-attribute">color</span>: green; &#125;<br>    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸‹é¢å…§å®¹ç‚º <code>style.css</code>ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">h1</span> &#123; <span class="hljs-attribute">color</span>: red; &#125;<br></code></pre></td></tr></table></figure><p>é‚£ <code>h1</code> çš„é¡è‰²æœƒæ˜¯ç¶ è‰²ï¼š</p><p><img src="../images/css-introduction/title-green.png" alt=""></p><p>å¦‚æœæ›´æ› <code>style</code> å’Œ <code>link</code> å…ƒç´ çš„é †åºï¼Œ<code>h1</code> çš„é¡è‰²å‰‡æœƒæ˜¯ç´…è‰²ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><br>      <span class="hljs-selector-tag">h1</span> &#123; <span class="hljs-attribute">color</span>: green; &#125;<br>    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"./style.css"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="../images/css-introduction/title-red.png" alt=""></p><p>è³‡æ–™ä¾†æºï¼š</p><ul><li><a href="https://www.w3.org/TR/html401/present/styles.html" target="_blank" rel="noopener">Style Sheets in HTML documents</a></li><li><a href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element" target="_blank" rel="noopener">HTML Standard - 4.2.4 The link element</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/css.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;CSS æ˜¯ Cascading Style Sheets çš„ç¸®å¯«ï¼Œæ˜¯ä¸€ç¨® style sheet (æ¨£å¼è¡¨) èªè¨€ï¼Œå¯å°‡è‡ªè¨‚çš„æ¨£å¼ (ä¾‹å¦‚ï¼šå­—é«”ã€é¡è‰²) é™„åŠ åœ¨ HTML æ–‡ä»¶ä¸Šã€‚é€™ç¯‡æœƒå…ˆç°¡ä»‹ CSSï¼Œä»¥åŠå¦‚ä½•åœ¨ HTML è¨­å®š CSSã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://titangene.github.io/categories/css/"/>
    
      <category term="HTML" scheme="https://titangene.github.io/categories/css/html/"/>
    
    
      <category term="IT éµäººè³½" scheme="https://titangene.github.io/tags/it-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>å¥—ç”¨è‡ªè¨‚ HackMD æš—ä¸»é¡Œ</title>
    <link href="https://titangene.github.io/article/hackmd-dark-theme.html"/>
    <id>https://titangene.github.io/article/hackmd-dark-theme.html</id>
    <published>2019-05-18T12:16:35.000Z</published>
    <updated>2019-05-19T16:02:51.484Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/hackmd-dark-theme.jpg" alt=""></p><p>HackMD æ˜¯æˆ‘å¸¸ç”¨çš„å¯«ä½œå¹³å°ï¼Œå› å®˜æ–¹æ²’æœ‰æä¾›æš—ä¸»é¡Œçš„ç€è¦½æ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘å°±åˆ»äº†è‡ªè¨‚çš„æš—ä¸»é¡Œï¼Œä¹Ÿå°‡è‡ªè¨‚ä¸»é¡Œ<a href="https://github.com/titangene/hackmd-dark-theme" target="_blank" rel="noopener">é–‹æºåœ¨ GitHub</a>ï¼Œæ­¡è¿å¤§å®¶ç™¼ PR çµ¦æˆ‘ï¼Œä¸¦è¨˜å¾—å¹«æˆ‘æŒ‰å€‹ â­ï¸ æ˜Ÿã€‚</p><a id="more"></a><p>æ‡‰è©²æœ‰å¾ˆå¤šäººåœ¨ç€è¦½å™¨å®‰è£ <a href="https://chrome.google.com/webstore/detail/dark-reader/eimadpbcbfnmbkopoojfekhnkhdbieeh" target="_blank" rel="noopener">Dark reader</a> é€™å€‹æ“´å……åŠŸèƒ½å§ï¼Ÿé€šå¸¸ä½¿ç”¨çš„åŸå› å¤§å¤šæ˜¯æƒ³æŠŠç•«é¢è®Šæˆæ·±è‰²ç€è¦½æ¨¡å¼ï¼Œæ¯”è¼ƒä¿è­·çœ¼ç›ã€‚ä½†æ˜¯æœ‰äº›ç¶²ç«™ä½¿ç”¨é€™å€‹æ“´å……åŠŸèƒ½ä¹‹å¾Œï¼Œæœ‰äº›é¡è‰²ä¸æ˜¯ä½ ç¿’æ…£æˆ–å–œæ­¡çš„ï¼Œå°¤å…¶æ˜¯åœ¨å€‹äººå¸¸ç”¨çš„ç¶²ç«™ä¸Šæœƒæ„Ÿè¦ºæ²’é‚£éº¼ç¿’æ…£ã€‚</p><p>è€Œ <a href="https://hackmd.io/" target="_blank" rel="noopener">HackMD</a> æ˜¯æˆ‘å¸¸ç”¨ä¾†å¯«æŠ€è¡“ç­†è¨˜çš„å¯«ä½œå¹³å°ï¼Œå°¤å…¶æ˜¯ç¨‹å¼ç¢¼çš„ highlightï¼Œæˆ‘å€‹äººåå¥½ VS Code é è¨­çš„æš—ä¸»é¡Œ (Dark+ é€™å€‹ä¸»é¡Œ)ï¼Œæ‰€ä»¥æˆ‘å°±åœ¨ç¶²é ä¸ŠåŠ ä¸Šè‡ªå·±è‡ªè¨‚çš„ CSS å»æ”¹æˆæˆ‘æƒ³è¦çš„ä¸»é¡Œã€‚</p><p>é‚£å¦‚ä½•å°‡è‡ªå®šçš„ CSS åŠ åœ¨æŒ‡å®šçš„ç¶²ç«™ä¸Šå‘¢ï¼ŸåŸæœ¬æˆ‘æ˜¯ç”¨ <a href="https://userstyles.org/" target="_blank" rel="noopener">Stylish</a> ä¾†ç®¡ç†è‡ªè¨‚çš„ç¶²é æ¨£å¼ï¼Œä½†å¾Œä¾†å› ç‚º<a href="https://forum.userstyles.org/discussion/53233/announcement-to-the-community" target="_blank" rel="noopener">ä¸€äº›åŸå› é€™å€‹æ“´å……åŠŸèƒ½å¤šäº†åœ¨èƒŒæ™¯ä¸Šå‚³è³‡è¨Šçš„åŠŸèƒ½</a> (é›–ç„¶å®˜æ–¹èªªä¸æœƒä¸Šå‚³å€‹è³‡)ï¼Œæ–¼æ˜¯æˆ‘å°±æ”¹ç”¨ <a href="https://github.com/openstyles/stylus" target="_blank" rel="noopener">Stylus</a> ä¾†ç®¡ç†æ¨£å¼ã€‚Stylus æ˜¯ Stylish çš„åˆ†æ”¯ï¼Œåˆªé™¤äº†ä»»ä½•èˆ‡åˆ†æã€å›å‚³è³‡æ–™çš„åŠŸèƒ½ã€‚</p><h2 id="å¦‚ä½•ä½¿ç”¨ä¸»é¡Œ"><a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨ä¸»é¡Œ"></a>å¦‚ä½•ä½¿ç”¨ä¸»é¡Œ</h2><ol><li>åœ¨ç€è¦½å™¨å®‰è£ <a href="https://github.com/openstyles/stylus" target="_blank" rel="noopener">Stylus</a> æ“´å……åŠŸèƒ½ï¼ŒStylus ç›®å‰æä¾›é€™å¹¾ç¨®ç€è¦½å™¨ç‰ˆæœ¬çš„æ“´å……åŠŸèƒ½ï¼š<ul><li><a href="https://chrome.google.com/webstore/detail/stylus/clngdbkpkpeebahjckkjfobafhncgmne" target="_blank" rel="noopener">Chrome</a></li><li><a href="https://addons.mozilla.org/zh-TW/firefox/addon/styl-us/" target="_blank" rel="noopener">Firefox</a></li><li><a href="https://addons.opera.com/zh-tw/extensions/details/stylus/" target="_blank" rel="noopener">Opera</a></li></ul></li><li>ä¸‹è¼‰æˆ‘è‡ªå®šçš„ <a href="https://userstyles.org/styles/147272/hackmd-dark-theme" target="_blank" rel="noopener">HackMD dark theme</a> è‡³ Stylus</li></ol><p><img src="../images/hackmd-dark-theme/install-style.png" alt=""></p><ol start="3"><li>ä¸‹è¼‰æ¨£å¼å¾Œæœƒè‡ªå‹•å¥—ç”¨ï¼Œé–‹å•Ÿ HackMD å°±æœƒçœ‹åˆ°ä»‹é¢è®Šæˆæš—ä¸»é¡Œå›‰ï¼å¦‚æœæ˜¯ä¹‹å‰å°±é–‹å•Ÿçš„ HackMD é é¢ï¼Œæœ‰æ™‚æœƒéœ€è¦é‡æ–°æ•´ç†é é¢æ‰æœƒå¥—ç”¨æš—ä¸»é¡Œã€‚</li></ol><p>å°±æ˜¯é€™éº¼ç°¡å–® ğŸ˜„ã€‚</p><p>é€™é‚Šè¦å¦å¤–èªªæ˜ä¸€ä¸‹ï¼Œé›–ç„¶å‰›å‰›æåˆ°å› ç‚º Stylish æœ‰æ”¶é›†è³‡æ–™çš„å•é¡Œï¼Œæ‰€ä»¥æˆ‘æ”¹ç”¨ Stylus ä¾†ç®¡ç†è‡ªå®šæ¨£å¼ï¼Œä½†æ˜¯è¦å°‡è‡ªå®šçš„æ¨£æ˜¯åˆ†äº«çµ¦åˆ¥äººä½¿ç”¨ï¼Œé‚„æ˜¯è¦è¨»å†Š <a href="https://userstyles.org/" target="_blank" rel="noopener">Stylish</a> å®˜æ–¹å¹³å°çš„å¸³è™Ÿï¼Œå°‡è¦åˆ†äº«çš„æ¨£å¼ä¸Šå‚³è‡³é€™å€‹å¹³å°ï¼Œè®“å…¶ä»–äººå¯ä»¥ä¸‹è¼‰ä½¿ç”¨ã€‚</p><p>ä¸éå¦‚æœåªæ˜¯ä¸‹è¼‰åˆ¥äººçš„ä¸»é¡Œæ˜¯ä¸éœ€è¦è¨»å†Šå¸³è™Ÿï¼Œæ‰€ä»¥ä¸ç”¨æ“”å› ã€‚</p><h2 id="åŸå§‹ç¢¼"><a class="header-anchor" href="#åŸå§‹ç¢¼"></a>åŸå§‹ç¢¼</h2><p>é€™å°±æ˜¯æˆ‘è‡ªå®š HackMD æ¨£å¼çš„åŸå§‹ç¢¼ï¼š<a href="https://github.com/titangene/hackmd-dark-theme" target="_blank" rel="noopener">titangene/hackmd-dark-theme</a></p><p>å¦‚æœç™¼ç¾éœ€ä¿®æ­£çš„åœ°æ–¹ï¼Œæ­¡è¿ç™¼ pull request çµ¦æˆ‘ ğŸ˜ã€‚<br>å¦‚æœå–œæ­¡ï¼Œè¨˜å¾—å¹«æˆ‘æŒ‰å€‹ â­ï¸ æ˜Ÿï¼ŒThanksã€‚</p><h2 id="ç•«é¢æˆªåœ–"><a class="header-anchor" href="#ç•«é¢æˆªåœ–"></a>ç•«é¢æˆªåœ–</h2><h3 id="overview"><a class="header-anchor" href="#overview"></a>Overview</h3><p><img src="../images/hackmd-dark-theme/overview.png" alt=""></p><h3 id="recent"><a class="header-anchor" href="#recent"></a>Recent</h3><p><img src="../images/hackmd-dark-theme/recent.png" alt=""></p><h3 id="view-mode"><a class="header-anchor" href="#view-mode"></a>View mode</h3><p><img src="../images/hackmd-dark-theme/view.png" alt=""></p><h3 id="book-mode"><a class="header-anchor" href="#book-mode"></a>Book mode</h3><p><img src="../images/hackmd-dark-theme/book-mode.png" alt=""></p><h3 id="slide-mode"><a class="header-anchor" href="#slide-mode"></a>Slide mode</h3><p><img src="../images/hackmd-dark-theme/slide.png" alt=""></p><h3 id="emoji-todo-list-code-block-highlight"><a class="header-anchor" href="#emoji-todo-list-code-block-highlight"></a>Emoji &amp; Todo list &amp; Code block highlight</h3><p><img src="../images/hackmd-dark-theme/emoji_todo-list_code-block.png" alt=""></p><h3 id="github-gist"><a class="header-anchor" href="#github-gist"></a>Github Gist</h3><p><img src="../images/hackmd-dark-theme/gist.png" alt=""></p><h3 id="latex-uml"><a class="header-anchor" href="#latex-uml"></a>LaTeX &amp; UML</h3><p><img src="../images/hackmd-dark-theme/latex_uml.png" alt=""></p><h3 id="table"><a class="header-anchor" href="#table"></a>Table</h3><p><img src="../images/hackmd-dark-theme/table.png" alt=""></p><h3 id="toc-table-of-contents"><a class="header-anchor" href="#toc-table-of-contents"></a>ToC (Table of Contents)</h3><p><img src="../images/hackmd-dark-theme/toc.png" alt=""></p><h3 id="history"><a class="header-anchor" href="#history"></a>History</h3><p><img src="../images/hackmd-dark-theme/history.png" alt=""></p><h3 id="permission"><a class="header-anchor" href="#permission"></a>Permission</h3><p><img src="../images/hackmd-dark-theme/permission.png" alt=""></p><h3 id="comment"><a class="header-anchor" href="#comment"></a>Comment</h3><p><img src="../images/hackmd-dark-theme/comment.png" alt=""></p><h2 id="å°çµ"><a class="header-anchor" href="#å°çµ"></a>å°çµ</h2><p>å…¶å¯¦é€™å€‹ side project æˆ‘åœ¨ 2017 å¹´ 8 æœˆå°±é–‹å§‹åšäº†ï¼ŒæœŸé–“åšäº†ä¸€äº›ä¸å®šæœŸçš„æ›´æ–°ï¼Œé€™æ¬¡çš„æ›´æ–°ç®—æ˜¯æ‰€æœ‰æˆ‘ç™¼ç¾æƒ³æ”¹çš„éƒ¨åˆ† (æ´) éƒ½å¡«å¥½äº† (æœ‰å¯èƒ½æˆ‘çœ¼æ®˜æ²’ç™¼ç¾çš„éƒ¨åˆ†ä¹Ÿéœ€è¦æ”¹ XDï¼Œæ­¡è¿å¤§å®¶ç™¼ PR çµ¦æˆ‘)ï¼ŒåŒ…æ‹¬æœ€è¿‘ HackMD å®˜æ–¹æ¨å‡ºçš„å¯åˆ†äº«æ–‡ä»¶çµ¦æŒ‡å®šå¸³è™Ÿçš„åŠŸèƒ½ï¼Œæˆ‘ä¹ŸæŠŠä»‹é¢è®Šæˆæš—ä¸»é¡Œäº†ã€‚</p><h2 id="å¥—ç”¨æš—ä¸»é¡Œçš„å…¶ä»–ç§˜è¨£"><a class="header-anchor" href="#å¥—ç”¨æš—ä¸»é¡Œçš„å…¶ä»–ç§˜è¨£"></a>å¥—ç”¨æš—ä¸»é¡Œçš„å…¶ä»–ç§˜è¨£</h2><p>åœ¨ HackMD æ“”ä»» Developer çš„ <a href="https://www.facebook.com/yukaihuangtw" target="_blank" rel="noopener">é»ƒéˆºå‡±</a> åœ¨æˆ‘ç™¼æ–‡çš„ Facebook ç¤¾åœ˜ <a href="https://www.facebook.com/groups/markdown.tw/permalink/1535146039952824/" target="_blank" rel="noopener">Markdown å°ç£</a>ï¼Œè·Ÿå¤§å®¶åˆ†äº«å¦ä¸€ç¨®å¯ä»¥å¥—ç”¨æš—ä¸»é¡Œçš„å°ç§˜è¨£ï¼Œè€Œä¸”é€™å€‹æ–¹æ³•å¯ä»¥å°‡ä½ è‡ªå®šçš„æ¨£å¼ï¼Œå¥—ç”¨è‡³ä½ åˆ†äº«çš„ç­†è¨˜ï¼Œæˆ–æ˜¯è·Ÿå¤¥ä¼´åƒèˆ‡çš„å…±ç­†ï¼Œè®“å¤§å®¶éƒ½èƒ½å…±äº«åŒæ¨£çš„æš—ä¸»é¡Œã€‚</p><p>é€™å€‹ç¥•è¨£å°±æ˜¯åœ¨ç­†è¨˜å…§ï¼ŒåŠ ä¸Š HackMD çš„å…§åµŒç­†è¨˜èªæ³•ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">&#123;%hackmd BJrTq20hE %&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ <a href="https://hackmd.io/IpJEFpXkQg2yvdsY9IbTVg?both" target="_blank" rel="noopener">https://hackmd.io/IpJEFpXkQg2yvdsY9IbTVg?both</a> (é€™å€‹é€£çµæ˜¯ç”± <a href="https://www.facebook.com/yukaihuangtw" target="_blank" rel="noopener">é»ƒéˆºå‡±</a> å¤§å¤§æä¾›) é€™å€‹ç­†è¨˜ç‚ºä¾‹ï¼Œåœ¨é€™å€‹ç­†è¨˜å…§å¯ä»¥çœ‹åˆ° HackMD çš„å…§åµŒç­†è¨˜èªæ³•ï¼Œè€Œä¸”å¯ä»¥çœ‹åˆ°æˆ‘æ²’æœ‰åœ¨ Stylus é–‹å•Ÿæˆ‘è‡ªå®šçš„ <a href="https://userstyles.org/styles/147272/hackmd-dark-theme" target="_blank" rel="noopener">HackMD dark theme</a>ï¼Œç«Ÿç„¶é‚„å¯ä»¥ä¿æœ‰æš—ä¸»é¡Œçš„æ¨£å¼ï¼š</p><p><img src="../images/hackmd-dark-theme/2019-05-19-23-38-41.png" alt=""></p><p>åŸå› å°±ç™¼ç”Ÿåœ¨é€™å€‹ HackMD çš„å…§åµŒç­†è¨˜èªæ³•ï¼Œå› ç‚ºé€™å€‹èªæ³•èƒŒå¾Œå¹«ä½ å¤šåŠ äº†æš—ä¸»é¡Œçš„æ¨£å¼ã€‚é‚£æ˜¯æ€éº¼åšåˆ°çš„å‘¢ï¼Ÿæ–¼æ˜¯æˆ‘å°±å¾ <code>BJrTq20hE</code> é€™å€‹çœ‹ä¼¼å¥‡æ€ªäº‚ç¢¼çš„æ±è¥¿ä¸‹æ‰‹ã€‚</p><p>é¦¬ä¸Šå°±ç›´è¦ºæƒ³åˆ°ï¼Œå…¶å¯¦ <code>BJrTq20hE</code> æ˜¯å¦ä¸€ç¯‡ç­†è¨˜çš„ç·¨è™Ÿï¼Œé€™å€‹ç­†è¨˜çš„å®Œæ•´é€£çµåƒæ˜¯ä¸‹é¢é€™æ¨£ï¼Œç¶²å€å…¶ä¸­çš„ <code>s</code> æ˜¯ HackMD çš„ç™¼è¡¨æ¨¡å¼ (æ‡‰è©²æ˜¯å«é€™æ¨£å§ï¼Ÿ)ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">https://hackmd.io/s/BJrTq20hE<br></code></pre></td></tr></table></figure><p>é€²å…¥é€™å€‹é€£çµå¾Œï¼Œå¯ä»¥çœ‹åˆ°æ•´å€‹ç­†è¨˜ç•«é¢æ²’æœ‰ä»»ä½•æ–‡å­—å…§å®¹ï¼Œä½†æ˜¯ä¸€æ¨£åœ¨æ²’æœ‰å¥—ç”¨è‡ªè¨‚æš—ä¸»é¡Œçš„æƒ…æ³ä¸‹ï¼Œé‚„èƒ½æœ‰æš—ä¸»é¡Œçš„æ¨£å¼ã€‚</p><p><img src="../images/hackmd-dark-theme/2019-05-19-23-46-11.png" alt=""></p><p>æ¥è‘—æˆ‘é€²å…¥é€™å€‹ç­†è¨˜çš„ç·¨è¼¯æ¨¡å¼å°±ç™¼ç¾ç­”æ¡ˆå·²æ­æ›‰ï¼ŒåŸä¾†é€™å€‹çœ‹ä¼¼æ²’å…§æ–‡çš„ç­†è¨˜ä¸­ï¼Œæœ‰æˆ‘å¯«çš„æš—ä¸»é¡Œæ¨£å¼ï¼Œé€™äº›æ¨£å¼ç›´æ¥è¢«å¯«åœ¨é€™ç¯‡ HackMD çš„ç­†è¨˜è£¡é¢ï¼Œä¸¦ä¸”æ”¾åœ¨ <code>&lt;style&gt;</code> çš„ HTML element å…§ï¼š</p><p><img src="../images/hackmd-dark-theme/2019-05-19-23-48-02.png" alt=""></p><p>ä¹Ÿå°±æ˜¯èªªå¦‚æœæœªä¾†æƒ³åœ¨å…¶ä»–ç­†è¨˜ä¹Ÿå¥—ç”¨ç›¸åŒçš„ä¸»é¡Œæ¨£å¼ï¼Œåªè¦å»ºç«‹å°ˆé–€æ”¾æ¨£å¼çš„ç­†è¨˜ï¼Œç„¶å¾Œå°‡é€™å€‹ç­†è¨˜é€é HackMD çš„å…§åµŒç­†è¨˜èªæ³•å¥—ç”¨è‡³å…¶ä»–ç­†è¨˜ä¸Šï¼Œé€™æ¨£é‚£äº›ç­†è¨˜éƒ½æœƒå…±äº«ç›¸åŒçš„æ¨£å¼å›‰ï¼å¥½ç¥å¥‡å•Šï¼æ„Ÿè¬ HackMD Developer å¤§å¤§çš„åˆ†äº«ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/hackmd-dark-theme.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;HackMD æ˜¯æˆ‘å¸¸ç”¨çš„å¯«ä½œå¹³å°ï¼Œå› å®˜æ–¹æ²’æœ‰æä¾›æš—ä¸»é¡Œçš„ç€è¦½æ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘å°±åˆ»äº†è‡ªè¨‚çš„æš—ä¸»é¡Œï¼Œä¹Ÿå°‡è‡ªè¨‚ä¸»é¡Œ&lt;a href=&quot;https://github.com/titangene/hackmd-dark-theme&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é–‹æºåœ¨ GitHub&lt;/a&gt;ï¼Œæ­¡è¿å¤§å®¶ç™¼ PR çµ¦æˆ‘ï¼Œä¸¦è¨˜å¾—å¹«æˆ‘æŒ‰å€‹ â­ï¸ æ˜Ÿã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Blog" scheme="https://titangene.github.io/categories/blog/"/>
    
      <category term="CSS" scheme="https://titangene.github.io/categories/blog/css/"/>
    
    
      <category term="Markdown" scheme="https://titangene.github.io/tags/markdown/"/>
    
      <category term="Dark Theme" scheme="https://titangene.github.io/tags/dark-theme/"/>
    
  </entry>
  
  <entry>
    <title>é€é Docker Compose è¨­å®š network</title>
    <link href="https://titangene.github.io/article/networking-in-docker-compose.html"/>
    <id>https://titangene.github.io/article/networking-in-docker-compose.html</id>
    <published>2019-05-15T13:03:15.000Z</published>
    <updated>2019-05-15T13:02:26.117Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/docker-compose.jpg" alt=""></p><p>Docker Compose é è¨­æœƒå»ºç«‹ default networkï¼Œé€™ç¯‡æœƒå‘Šè¨´ä½ å¦‚ä½•è‡ªè¨‚ networkã€å¦‚ä½•ä½¿ç”¨ç¾æœ‰çš„ networkï¼Œä»¥åŠå¦‚ä½•è‡ªè¨‚ network åç¨±ã€‚</p><a id="more"></a><p>Docker Compose é è¨­æœƒå¹«ä½ çš„æ‡‰ç”¨ç¨‹å¼è¨­å®šä¸€å€‹ networkï¼Œservice çš„æ¯å€‹å®¹å™¨éƒ½æœƒåŠ å…¥ default networkï¼Œä¸¦ä¸”è©² network ä¸Šçš„å…¶ä»–å®¹å™¨éƒ½å¯ä»¥é€£æ¥ (reachable) ä»¥åŠç™¼ç¾ (discoverable) èˆ‡å®¹å™¨åç¨±ç›¸åŒçš„ hostnameã€‚</p><p>é è¨­çš„ network åç¨±æ˜¯åŸºæ–¼ â€œå°ˆæ¡ˆç›®éŒ„åç¨±â€ï¼Œä¸¦åŠ ä¸Š <code>_default</code>ã€‚ä¾‹å¦‚ï¼šä½ çš„æ‡‰ç”¨ç¨‹å¼æ”¾åœ¨åç‚º <code>myapp</code> çš„å°ˆæ¡ˆç›®éŒ„ä¸­ï¼Œè€Œ <code>docker-compose.yml</code> çš„å…§å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3'</span><br><br><span class="hljs-attr">services:</span><br><span class="hljs-attr">  web:</span><br><span class="hljs-attr">    build:</span> <span class="hljs-string">.</span><br><span class="hljs-attr">    ports:</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">'8000:8000'</span><br><span class="hljs-attr">  db:</span><br><span class="hljs-attr">    image:</span> <span class="hljs-string">postgres</span><br><span class="hljs-attr">    ports:</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">'8001:5432'</span><br></code></pre></td></tr></table></figure><p>ç•¶ä½ åŸ·è¡Œ <code>docker-compose up</code> æŒ‡ä»¤æ™‚ï¼Œæœƒç™¼ç”Ÿä»¥ä¸‹æƒ…æ³ï¼š</p><ol><li>å»ºç«‹ä¸€å€‹åç‚º <code>myapp_default</code> çš„ network</li><li>ä½¿ç”¨ <code>web</code> çš„è¨­å®šå»ºç«‹å®¹å™¨ï¼Œä¸¦ä»¥ <code>web</code> é€™å€‹åç¨±åŠ å…¥åç‚º <code>myapp_default</code> çš„ network</li><li>ä½¿ç”¨ <code>db</code> çš„è¨­å®šå»ºç«‹å®¹å™¨ï¼Œä¸¦ä»¥ <code>db</code> é€™å€‹åç¨±åŠ å…¥åç‚º <code>myapp_default</code> çš„ network</li></ol><div class="info"><p>ç•¶ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <a href="https://docs.docker.com/compose/reference/overview/" target="_blank" rel="noopener"><code>--project-name</code> (å¯ç°¡å¯«æˆ <code>-p</code> ) åƒæ•¸</a> æˆ–ä½¿ç”¨ <code>COMPOSE_PROJECT_NAME</code> é€™å€‹ <a href="https://docs.docker.com/compose/reference/envvars/#compose-project-name" target="_blank" rel="noopener">ç’°å¢ƒè®Šæ•¸</a> ä¾†è¤‡å¯«å°ˆæ¡ˆåç¨±ã€‚</p></div><p>ç¾åœ¨ï¼Œæ¯å€‹å®¹å™¨éƒ½å¯ä»¥æ‰¾åˆ°åç‚º <code>web</code> æˆ– <code>db</code> çš„ hostnameï¼Œä¸¦ç²å¾—å°æ‡‰å®¹å™¨çš„ IP ä½å€ã€‚ä¾‹å¦‚ï¼š<code>web</code> çš„æ‡‰ç”¨ç¨‹å¼çš„ç¨‹å¼ç¢¼å¯ä»¥é€£æ¥åˆ° <code>postgres://db:5432</code> çš„ URLï¼Œä¸¦é–‹å§‹ä½¿ç”¨ Postgres è³‡æ–™åº«ã€‚</p><p>ä¸éè¦æ³¨æ„ <code>HOST_PORT</code> å’Œ <code>CONTAINER_PORT</code> ä¹‹é–“çš„å·®åˆ¥ã€‚ä»¥ä¸Šé¢ç¯„ä¾‹ä¸­çš„ <code>db</code> ä¾†èªªï¼Œ<code>HOST_PORT</code> æ˜¯ <code>8001</code>ï¼Œ<code>CONTAINER_PORT</code> æ˜¯ <code>5432</code> (postgres çš„é è¨­ port)ã€‚Networked service-to-service é€šè¨Šä½¿ç”¨ <code>CONTAINER_PORT</code>ã€‚å®šç¾© <code>HOST_PORT</code> ä¹‹å¾Œï¼Œservice ä¹Ÿå¯ä»¥åœ¨ swarm å¤–éƒ¨å­˜å–ã€‚</p><p>åœ¨ <code>web</code> çš„å®¹å™¨ä¸­ï¼Œå¦‚æœè¦é€£æ¥åˆ° <code>db</code> çš„é€£æ¥å­—ä¸²æœƒçœ‹èµ·ä¾†åƒæ˜¯ <code>postgres://db:5432</code> é€™æ¨£ï¼Œè€Œå¾ host machine ä¾†çœ‹ï¼Œé€£æ¥å­—ä¸²çœ‹èµ·ä¾†åƒæ˜¯ <code>postgres://{DOCKER_IP}:8001</code>ã€‚</p><h2 id="æ›´æ–°å®¹å™¨"><a class="header-anchor" href="#æ›´æ–°å®¹å™¨"></a>æ›´æ–°å®¹å™¨</h2><p>å¦‚æœæœ‰è®Šæ›´ service çš„è¨­å®šï¼Œè«‹åŸ·è¡Œ <code>docker-compose up</code> æŒ‡ä»¤ä¾†æ›´æ–° serviceï¼Œå®ƒæœƒåˆªé™¤èˆŠçš„å®¹å™¨ï¼Œè€Œæ–°å®¹å™¨æœƒä»¥ä¸åŒçš„ IP ä½å€åŠ å…¥ç›¸åŒåç¨±çš„ networkã€‚åŸ·è¡Œä¸­çš„å®¹å™¨å¯ä»¥æ‰¾åˆ°è©²åç¨±ä¸¦é€£æ¥åˆ°æ–°çš„ IP ä½å€ï¼Œè€ŒèˆŠçš„ IP ä½å€å°±ç„¡æ³•ä½¿ç”¨ã€‚</p><p>å¦‚æœä»»ä½•å®¹å™¨å°èˆŠå®¹å™¨é–‹æ”¾é€£ç·šï¼Œé‚£é€™äº›å®¹å™¨å°±æœƒè¢«é—œé–‰é€£ç·šã€‚å®¹å™¨æœ‰è²¬ä»»æª¢æ¸¬é€™å€‹æƒ…æ³ï¼Œå†æ¬¡æ‰¾åˆ°åç¨±ä¸¦é‡æ–°é€£æ¥ã€‚</p><h2 id="links"><a class="header-anchor" href="#links"></a>Links</h2><p>link åˆ°å¦ä¸€å€‹ service ä¸­çš„å®¹å™¨ã€‚é€é link å¯ä»¥æŒ‡å®š service åç¨±å’Œ link åˆ¥å ( <code>SERVICE:ALIAS</code> ï¼‰ï¼Œæˆ–åƒ…æŒ‡å®š service åç¨±ã€‚é€éè©²åˆ¥åå¯ä»¥å¾å…¶ä»– service å­˜å–åˆ° serviceã€‚link ä¸éœ€è¦å•Ÿç”¨ service é€²è¡Œé€šè¨Š - é è¨­æƒ…æ³ä¸‹ï¼Œä»»ä½• service éƒ½å¯ä»¥é€šéè©² service çš„åç¨±å­˜å–ä»»ä½•å…¶ä»– serviceã€‚</p><p>éˆæ¥ (linked) service çš„å®¹å™¨å¯åœ¨åˆ¥åç›¸åŒçš„ hostname ä¸Šå­˜å–ï¼Œå¦‚æœæœªæŒ‡å®šåˆ¥åï¼Œå‰‡å¯ä»¥å­˜å– service åç¨±ã€‚</p><p>åœ¨ä¸‹é¢ç¯„ä¾‹ä¸­ï¼Œå¯ä»¥å¾ <code>web</code> çš„ hostname <code>db</code> å’Œ <code>database</code> å­˜å–åˆ° <code>db</code>ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3'</span><br><br><span class="hljs-attr">services:</span><br><span class="hljs-attr">  web:</span><br><span class="hljs-attr">    build:</span> <span class="hljs-string">.</span><br><span class="hljs-attr">    links:</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">'db:database'</span><br><span class="hljs-attr">  db:</span><br><span class="hljs-attr">    image:</span> <span class="hljs-string">postgres</span><br></code></pre></td></tr></table></figure><p><code>link</code> å’Œ <a href="https://docs.docker.com/compose/compose-file/#depends_on" target="_blank" rel="noopener"><code>depends_on</code></a> éƒ½æ˜¯ä»¥ç›¸åŒçš„æ–¹å¼è¡¨é” service ä¹‹é–“çš„ä¾è³´é—œä¿‚ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å®ƒå€‘ä¾†æ±ºå®š service å•Ÿå‹•çš„é †åºã€‚</p><div class="info"><ul><li>å¦‚æœåŒæ™‚å®šç¾© <code>links</code> å’Œ <code>networks</code>ï¼Œå‰‡å®ƒå€‘ä¹‹é–“å…·æœ‰ <code>links</code> çš„ service å¿…é ˆå…±äº«è‡³å°‘ä¸€å€‹å…±åŒçš„ç¶²çµ¡æ‰èƒ½é€²è¡Œé€šè¨Šã€‚å»ºè­°ä½¿ç”¨ network</li><li><a href="https://docs.docker.com/engine/reference/commandline/stack_deploy/" target="_blank" rel="noopener">åœ¨ swarm æ¨¡å¼ä¸‹ä½¿ç”¨ Compose æª”æ¡ˆ (v3) éƒ¨ç½² stack æ™‚</a>ï¼Œæœƒå¿½ç•¥ <code>links</code> é€™å€‹ option</li></ul></div><div class="warning"><p><code>--link</code> åƒæ•¸ç‚º legacy åŠŸèƒ½ï¼Œå¯èƒ½æœƒè¢«åˆªé™¤ã€‚ä¸å»ºè­°ä½¿ç”¨ <code>--link</code>ï¼Œå»ºè­°ä½¿ç”¨ <a href="https://docs.docker.com/network/" target="_blank" rel="noopener">user-defined networks</a> (ä½¿ç”¨è€…å®šç¾©çš„ç¶²è·¯) ä¾†ä¿ƒæˆå…©å€‹å®¹å™¨ä¹‹é–“çš„æºé€šã€‚user-defined networks ä¸æ”¯æ´ä½ ç”¨ <code>--link</code> åƒæ•¸åœ¨å®¹å™¨ä¹‹é–“å…±äº«ç’°å¢ƒè®Šæ•¸ã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨å…¶ä»–æ©Ÿåˆ¶ (ä¾‹å¦‚ï¼švolume)ï¼Œä»¥æ›´å¯æ§çš„æ–¹å¼åœ¨å®¹å™¨ä¹‹é–“å…±äº«ç’°å¢ƒè®Šæ•¸ã€‚</p></div><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://docs.docker.com/compose/compose-file/#links" target="_blank" rel="noopener">Compose file version 3 reference | Docker Documentation</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="multi-host-networking"><a class="header-anchor" href="#multi-host-networking"></a>Multi-host networking</h2><div class="info"><p>æ³¨æ„ï¼šæœ¬ç¯€ä¸­çš„èªªæ˜åªé©ç”¨æ–¼ <a href="https://docs.docker.com/compose/swarm/" target="_blank" rel="noopener">legacy Docker Swarm</a> çš„ç›¸é—œæ“ä½œï¼Œä¸¦ä¸”åªæœ‰ç›®æ¨™ç‚º legacy Swarm å¢é›†æ‰æœ‰ç”¨ã€‚æœ‰é—œå°‡ compose å°ˆæ¡ˆéƒ¨ç½²è‡³è¼ƒæ–°çš„æ•´åˆ swarm modeï¼Œè«‹åƒè€ƒ<a href="https://docs.docker.com/compose/bundles/" target="_blank" rel="noopener">Docker Stacks</a> æ–‡ä»¶ã€‚</p></div><p>å°‡ <a href="https://docs.docker.com/compose/swarm/" target="_blank" rel="noopener">Compose æ‡‰ç”¨ç¨‹å¼éƒ¨ç½²è‡³ Swarm å¢é›†</a> æ™‚ï¼Œå¯ä»¥ä½¿ç”¨å…§å»ºçš„ <code>overlay</code> driver åœ¨å®¹å™¨ä¹‹é–“å•Ÿç”¨ multi-host é€šè¨Šï¼Œè€Œç„¡éœ€æ›´æ”¹ Compose æª”æ¡ˆæˆ–æ‡‰ç”¨ç¨‹å¼çš„ç¨‹å¼ç¢¼ã€‚</p><p>æƒ³äº†è§£å¦‚ä½•è¨­å®š Swarm å¢é›†å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://docs.docker.com/network/overlay-standalone.swarm/" target="_blank" rel="noopener">Multi-host networking</a> é€™ç¯‡ã€‚å¢é›†é è¨­æ˜¯ä½¿ç”¨ <code>overlay</code> driverï¼Œä¸éä¹Ÿå¯ä»¥åƒè€ƒä¸‹ä¸€ç¯€æŒ‡å®šå…¶ä»– driverã€‚</p><h2 id="æŒ‡å®šè‡ªå®š-network"><a class="header-anchor" href="#æŒ‡å®šè‡ªå®š-network"></a>æŒ‡å®šè‡ªå®š network</h2><p>è‹¥ä¸æƒ³ä½¿ç”¨é è¨­çš„ app networkï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://docs.docker.com/compose/compose-file/#network-configuration-reference" target="_blank" rel="noopener">top-level <code>networks</code> key</a> ä¾†æŒ‡å®šè‡ªå·±çš„ networkï¼Œè®“ä½ å¯ä»¥å»ºç«‹æ›´è¤‡é›œçš„æ‹“æ’²ï¼Œä¸¦æŒ‡å®š <a href="https://docs.docker.com/engine/extend/plugins_network/" target="_blank" rel="noopener">custom network driver</a> å’Œ optionã€‚é‚„å¯ä»¥ä½¿ç”¨å®ƒï¼Œå°‡ service é€£æ¥åˆ°ä¸ç”± Compose ç®¡ç†ï¼Œè€Œæ˜¯ç”±å¤–éƒ¨å»ºç«‹çš„ networkã€‚</p><p>æ¯å€‹ service éƒ½å¯ä»¥ä½¿ç”¨ <a href="https://docs.docker.com/compose/compose-file/#networks" target="_blank" rel="noopener">service-level <code>networks</code> key</a> æŒ‡å®šè¦é€£æ¥çš„ networkï¼Œè©² key æ˜¯å¼•ç”¨è‡³ <a href="https://docs.docker.com/compose/compose-file/#network-configuration-reference" target="_blank" rel="noopener">top-level <code>networks</code> key</a> ä¸‹çš„åç¨±ã€‚</p><p>ä»¥ä¸‹é¢å®šç¾©çš„å…©å€‹è‡ªå®š network çš„ Compose æª”æ¡ˆç‚ºä¾‹ï¼Œ<code>proxy</code> service èˆ‡ <code>db</code> service éš”é›¢ï¼Œå› ç‚ºå®ƒå€‘ä¸å…±äº«å…±åŒçš„ networkï¼Œåªæœ‰ <code>app</code> å¯ä»¥èˆ‡å…©è€…æºé€šï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3'</span><br><br><span class="hljs-attr">services:</span><br><span class="hljs-attr">  proxy:</span><br><span class="hljs-attr">    build:</span> <span class="hljs-string">./proxy</span><br><span class="hljs-attr">    networks:</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">frontend</span><br><span class="hljs-attr">  app:</span><br><span class="hljs-attr">    build:</span> <span class="hljs-string">./app</span><br><span class="hljs-attr">    networks:</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">frontend</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">backend</span><br><span class="hljs-attr">  db:</span><br><span class="hljs-attr">    image:</span> <span class="hljs-string">postgres</span><br><span class="hljs-attr">    networks:</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">backend</span><br><br><span class="hljs-attr">networks:</span><br><span class="hljs-attr">  frontend:</span><br>    <span class="hljs-comment"># Use a custom driver</span><br><span class="hljs-attr">    driver:</span> <span class="hljs-string">custom-driver-1</span><br><span class="hljs-attr">  backend:</span><br>    <span class="hljs-comment"># Use a custom driver which takes special options</span><br><span class="hljs-attr">    driver:</span> <span class="hljs-string">custom-driver-2</span><br><span class="hljs-attr">    driver_opts:</span><br><span class="hljs-attr">      foo:</span> <span class="hljs-string">'1'</span><br><span class="hljs-attr">      bar:</span> <span class="hljs-string">'2'</span><br></code></pre></td></tr></table></figure><p>é€šéç‚ºæ¯å€‹é€£æ¥ (attached) çš„ network è¨­å®š <a href="https://docs.docker.com/compose/compose-file/#ipv4_address-ipv6_address" target="_blank" rel="noopener"><code>ipv4_address</code> å’Œ/æˆ– <code>ipv6_address</code></a>ï¼Œå¯ä»¥ç‚º network è¨­å®šéœæ…‹ IP ä½å€ã€‚</p><h2 id="è¨­å®š-default-network"><a class="header-anchor" href="#è¨­å®š-default-network"></a>è¨­å®š default network</h2><p>é€éåœ¨ top-level <code>networks</code> key å…§ï¼Œåç‚º <code>default</code> network ä¸‹å®šç¾© entryï¼Œä¾†æ›´æ”¹æ‡‰ç”¨ç¨‹åºç¯„åœ (app-wide) çš„ default network çš„è¨­å®šï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3'</span><br><br><span class="hljs-attr">services:</span><br><span class="hljs-attr">  web:</span><br><span class="hljs-attr">    build:</span> <span class="hljs-string">.</span><br><span class="hljs-attr">    ports:</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">'8000:8000'</span><br><span class="hljs-attr">  db:</span><br><span class="hljs-attr">    image:</span> <span class="hljs-string">postgres</span><br><br><span class="hljs-attr">networks:</span><br><span class="hljs-attr">  default:</span><br>    <span class="hljs-comment"># Use a custom driver</span><br><span class="hljs-attr">    driver:</span> <span class="hljs-string">custom-driver-1</span><br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-pre-existing-network"><a class="header-anchor" href="#ä½¿ç”¨-pre-existing-network"></a>ä½¿ç”¨ pre-existing network</h2><p>å¦‚æœå¸Œæœ›å®¹å™¨åŠ å…¥é å…ˆå®šç¾©å¥½çš„ networkï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>external</code> optionã€‚</p><p>å¦‚æœ <code>external</code> è¨­ç‚º <code>true</code>ï¼Œå°±æœƒæŒ‡å®šå·²åœ¨ Compose ä¹‹å¤–å…ˆå»ºç«‹çš„é‚£å€‹ networkï¼Œæ‰€ä»¥ <code>docker-compose up</code> ä¸æœƒå˜—è©¦å»ºç«‹æ­¤ networkã€‚</p><p>å¦‚æœæ­¤ network ä¸å­˜åœ¨ï¼Œæœƒå› ç‚ºæ‰¾ä¸åˆ°åƒè€ƒçš„ç›®æ¨™ network è€Œç™¼ç”ŸéŒ¯èª¤ã€‚éŒ¯èª¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> docker-compose up<br>ERROR: Network my_network declared as external, but could be found. Please create the network manually using `docker network create my_network` and try again.<br></code></pre></td></tr></table></figure><p>å¦‚æœæ‰¾ä¸åˆ°æ­¤ networkï¼Œå¯ä»¥åŸ·è¡Œ <code>docker network create [network_name]</code> ä¾†å»ºç«‹ networkã€‚</p><p>åœ¨ Compose v3.3 ä»¥åŠæ›´èˆŠç‰ˆçš„æª”æ¡ˆæ ¼å¼ä¸‹ï¼Œ<code>external</code> ä¸èƒ½è·Ÿå…¶ä»– network configuration keys ä¸€èµ·ä½¿ç”¨ï¼ŒåŒ…æ‹¬ï¼š<code>driver</code>ã€<code>driver_opts</code>ã€<code>ipam</code> å’Œ <code>internal</code> ã€‚Compose <a href="https://docs.docker.com/compose/compose-file/compose-versioning/#version-34" target="_blank" rel="noopener">v3.4</a> ä»¥åŠæ›´æ–°ç‰ˆçš„æ ¼å¼å°±æ²’æœ‰é€™å€‹é™åˆ¶ã€‚</p><p>ä¸‹é¢ç¯„ä¾‹çš„ Compose æœƒæ‰¾åˆ°åç‚º <code>my-network-name</code> çš„å·²å­˜åœ¨çš„ networkï¼Œä¸¦å°‡æ‡‰ç”¨ç¨‹å¼çš„å®¹å™¨é€£æ¥åˆ°è©² networkï¼Œé€™æ¨£å°±ä¸æœƒå˜—è©¦å»ºç«‹ä¸€å€‹åç‚º <code>[projectname]_default</code> çš„ networkï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">"3.7"</span><br><br><span class="hljs-attr">services:</span><br><span class="hljs-attr">  app:</span><br><span class="hljs-attr">    image:</span> <span class="hljs-string">whatever</span><br><span class="hljs-attr">  networks:</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">my-network</span><br><br><span class="hljs-attr">networks:</span><br><span class="hljs-attr">  my-network:</span><br><span class="hljs-attr">    external:</span><br><span class="hljs-attr">      name:</span> <span class="hljs-string">my-network-name</span><br></code></pre></td></tr></table></figure><p>åœ¨ä¸‹é¢ç¯„ä¾‹ä¸­ï¼Œ<code>proxy</code> æ˜¯é€šå¾€å¤–éƒ¨ä¸–ç•Œçš„ gatewayï¼Œæ‰€ä»¥ä¸éœ€è¦å»ºç«‹ä¸€å€‹åç‚º <code>[projectname]_outside</code> çš„ networkã€‚Compose æœƒæ‰¾åˆ°ä¸€å€‹åç‚º <code>outside</code> çš„å·²å­˜åœ¨çš„ networkï¼Œä¸¦å°‡ <code>proxy</code> service çš„å®¹å™¨é€£æ¥åˆ° <code>outside</code> networkã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">"3.7"</span><br><br><span class="hljs-attr">services:</span><br><span class="hljs-attr">  proxy:</span><br><span class="hljs-attr">    build:</span> <span class="hljs-string">./proxy</span><br><span class="hljs-attr">    networks:</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">outside</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">default</span><br><span class="hljs-attr">  app:</span><br><span class="hljs-attr">    build:</span> <span class="hljs-string">./app</span><br><span class="hljs-attr">    networks:</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">default</span><br><br><span class="hljs-attr">networks:</span><br><span class="hljs-attr">  outside:</span><br><span class="hljs-attr">    external:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>ä¸‹é¢ç¯„ä¾‹çš„ Compose ä¸æœƒå˜—è©¦å»ºç«‹ä¸€å€‹åç‚º <code>[projectname]_default</code> çš„ networkï¼ŒCompose æœƒæ‰¾åˆ°åç‚º <code>my-pre-existing-network</code> çš„ networkï¼Œä¸¦å°‡æ‡‰ç”¨ç¨‹å¼çš„å®¹å™¨é€£æ¥åˆ°è©² networkã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">"3.7"</span><br><br><span class="hljs-attr">networks:</span><br><span class="hljs-attr">  default:</span><br><span class="hljs-attr">    external:</span><br><span class="hljs-attr">      name:</span> <span class="hljs-string">my-pre-existing-network</span><br></code></pre></td></tr></table></figure><div class="info"><p><code>external.name</code> åœ¨ <a href="https://docs.docker.com/compose/compose-file/compose-versioning/#version-35" target="_blank" rel="noopener">Compose v3.5 æª”æ¡ˆæ ¼å¼</a> ä¸­å·²è¢«æ£„ç”¨ï¼Œè«‹æ”¹ç”¨åŒç‰ˆæœ¬æ–°å¢çš„ <code>name</code>ï¼Œä¸‹ä¸€ç¯€æœƒèªªæ˜ã€‚</p></div><h2 id="è‡ªè¨‚-network-åç¨±"><a class="header-anchor" href="#è‡ªè¨‚-network-åç¨±"></a>è‡ªè¨‚ network åç¨±</h2><p>network ä¹Ÿå¯ä»¥è‡ªè¨‚åç¨±ï¼Œ<code>name</code> å±¬æ€§å¯å¼•ç”¨åŒ…å«ç‰¹æ®Šå­—å…ƒçš„ networkã€‚</p><p>ä¸‹é¢ä»¥é€™å€‹ Compose ç‚ºä¾‹ï¼Œä»‹ç´¹å¦‚ä½•è‡ªè¨‚ network åç¨±ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.5'</span><br><br><span class="hljs-attr">services:</span><br><span class="hljs-attr">  app:</span><br><span class="hljs-attr">    image:</span> <span class="hljs-string">whatever</span><br><span class="hljs-attr">    networks:</span><br><span class="hljs-bullet">      -</span> <span class="hljs-string">my-network</span><br><br><span class="hljs-attr">networks:</span><br><span class="hljs-attr">  my-network:</span><br><span class="hljs-attr">    name:</span> <span class="hljs-string">my-app-network</span><br></code></pre></td></tr></table></figure><p>åœ¨ <a href="https://docs.docker.com/compose/compose-file/#network-configuration-reference" target="_blank" rel="noopener">top-level <code>networks</code> key</a></p><ol><li>å…ˆæŠŠ Compose è£¡é¢çš„ <code>version</code> æ”¹æˆ 3.5 ä»¥ä¸Šï¼Œå› ç‚ºåœ¨ v3.5 ç‰ˆæ‰é–‹å§‹æä¾›è‡ªè¨‚ network åç¨± (ä¹Ÿå°±æ˜¯å¢åŠ  <code>name</code> å±¬æ€§)</li><li>åœ¨ <a href="https://docs.docker.com/compose/compose-file/#networks" target="_blank" rel="noopener">service-level <code>networks</code> key</a> è£¡é¢ (ä¹Ÿå°±æ˜¯è‡ªè¨‚çš„ service å…§çš„ <code>networks</code> )ï¼ŒåŠ å…¥è‡ªè¨‚çš„ network åç¨± (æ­¤ç¯„ä¾‹ç‚º <code>my-network</code> )</li><li>network çš„è©³ç´°å®šç¾©æ˜¯å¯«åœ¨ <a href="https://docs.docker.com/compose/compose-file/#network-configuration-reference" target="_blank" rel="noopener">top-level <code>networks</code> key</a> (ä¹Ÿå°±æ˜¯é€šå¸¸å¯«åœ¨æª”æ¡ˆæœ€å¾Œé¢çš„ <code>networks</code> ) è£¡é¢ã€‚é€™è£¡çš„ network åç¨±è¦å’Œ service-level <code>networks</code> key è£¡é¢è‡ªè¨‚çš„åç¨±å°æ‡‰ (ä¹Ÿå°±æ˜¯ <code>my-network</code> é€™å€‹ network åç¨±è¦å’Œä¸Šé¢ <code>services</code> å…§çš„ä¸€æ¨£)ï¼Œåœ¨ <code>my-network</code> ä¸‹é¢å°±å¯ä»¥ä½¿ç”¨ <code>name</code> å±¬æ€§ä¾†è‡ªå®š network åç¨± ( <code>my-app-network</code> å°±æ˜¯ä½ çœŸæ­£è‡ªè¨‚çš„ network åç¨± )</li></ol><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://docs.docker.com/compose/compose-file/#name-1" target="_blank" rel="noopener">Compose file version 3 reference | Docker Documentation</a> æ–‡ä»¶ã€‚</p></blockquote><p>ä¹Ÿå¯ä»¥èˆ‡ <code>external</code> å±¬æ€§ä¸€èµ·ä½¿ç”¨ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">"3.7"</span><br><br><span class="hljs-attr">networks:</span><br><span class="hljs-attr">  network1:</span><br><span class="hljs-attr">    external:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">    name:</span> <span class="hljs-string">my-app-network</span><br></code></pre></td></tr></table></figure><h2 id="åƒè€ƒä¾†æº"><a class="header-anchor" href="#åƒè€ƒä¾†æº"></a>åƒè€ƒä¾†æº</h2><ul><li><a href="https://docs.docker.com/compose/networking" target="_blank" rel="noopener">Networking in Compose | Docker Documentation</a></li><li><a href="https://docs.docker.com/compose/compose-file" target="_blank" rel="noopener">Compose file version 3 reference | Docker Documentation</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/docker-compose.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Docker Compose é è¨­æœƒå»ºç«‹ default networkï¼Œé€™ç¯‡æœƒå‘Šè¨´ä½ å¦‚ä½•è‡ªè¨‚ networkã€å¦‚ä½•ä½¿ç”¨ç¾æœ‰çš„ networkï¼Œä»¥åŠå¦‚ä½•è‡ªè¨‚ network åç¨±ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="DevOps" scheme="https://titangene.github.io/categories/devops/"/>
    
    
      <category term="Docker" scheme="https://titangene.github.io/tags/docker/"/>
    
      <category term="Container" scheme="https://titangene.github.io/tags/container/"/>
    
      <category term="Docker Compose" scheme="https://titangene.github.io/tags/docker-compose/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ GCP å»ºç«‹ Network Load Balancer å’Œ HTTP Load Balancer</title>
    <link href="https://titangene.github.io/article/gcp-network-and-http-load-balancer.html"/>
    <id>https://titangene.github.io/article/gcp-network-and-http-load-balancer.html</id>
    <published>2019-04-24T14:22:43.000Z</published>
    <updated>2019-04-24T14:21:10.799Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/gcp.jpg" alt=""></p><p>æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ<a href="https://www.qwiklabs.com/focuses/558?parent=catalog" target="_blank" rel="noopener">Set Up Network and HTTP Load Balancers</a>ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•å»ºç«‹å¤šå€‹ web server instanceï¼Œä»¥åŠå¦‚ä½•å»ºç«‹ network load balancer å’Œ HTTP load balancerã€‚</p><a id="more"></a><p><img src="../images/gcp-network-and-http-load-balancer/2019-04-24-22-19-00.png" alt=""></p><p>åœ¨æ­¤ lab ä¸­ï¼Œä½ å°‡äº†è§£ network load balancer å’Œ HTTP load balancer ä¹‹é–“çš„å·®ç•°ï¼Œä»¥åŠå¦‚ä½•ç‚º Google Compute Engine (GCE) VM ä¸ŠåŸ·è¡Œçš„æ‡‰ç”¨ç¨‹å¼è¨­å®š load balancerã€‚</p><p>ä½ å¯é€šéå¤šç¨®æ–¹å¼<a href="https://cloud.google.com/load-balancing/docs/load-balancing-overview#a_closer_look_at_cloud_load_balancers" target="_blank" rel="noopener">åœ¨ GCP å…§é€²è¡Œè² è¼‰å¹³è¡¡ (load balance)</a>ã€‚æ­¤ lab å°‡æ•™ä½ å®Œæˆä»¥ä¸‹ load balancer çš„è¨­å®šï¼š</p><ul><li>L3 (Network Layer) <a href="https://cloud.google.com/compute/docs/load-balancing/network/" target="_blank" rel="noopener">Network Load Balancer</a></li><li>L7 (Application Layer) <a href="https://cloud.google.com/compute/docs/load-balancing/http/" target="_blank" rel="noopener">HTTP(s) Load Balancer</a></li></ul><h2 id="æœ¬ç¯‡å°‡æœƒåšä»€éº¼ï¼Ÿ"><a class="header-anchor" href="#æœ¬ç¯‡å°‡æœƒåšä»€éº¼ï¼Ÿ"></a>æœ¬ç¯‡å°‡æœƒåšä»€éº¼ï¼Ÿ</h2><ul><li>è¨­å®š network load balancer</li><li>è¨­å®š HTTP load balancer</li><li>é€éå¯¦ä½œï¼Œäº†è§£ network load balancer å’Œ HTTP load balancer ä¹‹é–“çš„å·®ç•°</li></ul><h2 id="æº–å‚™"><a class="header-anchor" href="#æº–å‚™"></a>æº–å‚™</h2><p>åœ¨é»æ“Šã€ŒStart Labã€ä¹‹å‰ï¼Œæº–å‚™å¥½ç¶²è·¯ç€è¦½å™¨ (æ¨è–¦ç”¨ Google Chrome)ï¼Œä¸¦ä¸”è‡³å°‘ 40 åˆ†é˜å¯ä»¥å°ˆæ³¨çš„æ™‚é–“ï¼Œå› ç‚º lab æ˜¯æœ‰æ™‚é–“é™åˆ¶ï¼Œç•¶ä½ æŒ‰ä¸‹ã€ŒStart Labã€é–‹å§‹å­¸ç¿’æ™‚ï¼Œç„¡æ³•æš«åœå€’æ•¸è¨ˆæ™‚ï¼Œä½ åªèƒ½åœ¨é€™æ®µæ™‚é–“å…§ä½¿ç”¨ lab æä¾›çµ¦ä½ çš„å…¨æ–°æš«æ™‚ GCP Console å¯ç”¨å¸³è™Ÿï¼Œæ™‚é–“åˆ°ä¹‹å¾Œçš„å¹¾åˆ†é˜å°±æœƒè‡ªå‹•ç™»å‡ºã€‚</p><div class="warning"><p>æ³¨æ„ï¼šå¦‚æœä½ æœ‰è‡ªå·±çš„å€‹äºº GCP å¸³è™Ÿæˆ–å°ˆæ¡ˆï¼Œè«‹ä¸è¦åœ¨æ­¤ lab ä½¿ç”¨</p></div><h2 id="é–‹å§‹ä½ çš„-lab-ç„¶å¾Œç™»å…¥-gcp-console"><a class="header-anchor" href="#é–‹å§‹ä½ çš„-lab-ç„¶å¾Œç™»å…¥-gcp-console"></a>é–‹å§‹ä½ çš„ Labï¼Œç„¶å¾Œç™»å…¥ GCP Console</h2><ol><li>å¦‚æœæº–å‚™è¦é–‹å§‹ï¼Œå¯ä»¥é»æ“Šå³ä¸Šè§’çš„ã€ŒStart Labã€é–‹å§‹ï¼š</li></ol><p><img src="../images/getting-started-with-cloud-shell-gcloud-and-gsutil/2019-04-16-00-25-52.png" alt=""></p><ol start="2"><li>æ¥è‘—æœƒå‡ºç¾é€™å€‹ç•«é¢ï¼Œå› ç‚ºæˆ‘åƒåŠ  <a href="https://www.facebook.com/events/2005848903055499/" target="_blank" rel="noopener">GDG Tainan</a> çš„æ´»å‹•ï¼Œæ´»å‹•æœ‰æä¾› Qwiklabs ä¸€å€‹æœˆçš„å…è²»é¡åº¦ï¼Œæ‰€ä»¥æˆ‘é»é¸ä¸‹åœ–å·¦é‚Šçš„ã€ŒUse Subscriptionã€ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-21-15.png" alt=""></p><ol start="3"><li>Lab æœƒæä¾›çµ¦ä½ å…è²»æš«æ™‚çš„ GCP å¸³è™Ÿï¼Œè¤‡è£½å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œç„¶å¾Œé»æ“Šã€ŒOpen Google Consoleã€é–‹å•Ÿ <a href="https://cloud.google.com/storage/docs/cloud-console" target="_blank" rel="noopener">GCP Console</a>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-15-33-31.png" alt=""></p><p>åœ–ç‰‡ä¾†æºï¼š<a href="https://www.qwiklabs.com/focuses/3563?parent=catalog" target="_blank" rel="noopener">Creating a Virtual Machine | Qwiklabs</a></p><ol start="4"><li>æ¥è‘—å°±æœƒé–‹å•Ÿç™»å…¥é é¢ï¼Œå»ºè­°å¦å¤–é–‹ Chrome ç„¡ç—•æ¨¡å¼ä¾†ç™»å…¥ lab æä¾›çš„å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œå› ç‚º Chrome æœƒç´€éŒ„å¸³å¯†ï¼Œç¾åœ¨ç™»å…¥çš„åªæ˜¯æš«æ™‚å¸³è™Ÿï¼Œæœªä¾†ä¸éœ€è¦ç”¨åˆ°ï¼š</li></ol><div class="warning"><p>æ³¨æ„ï¼šé€™é‚Šæ˜¯ç™»å…¥ lab æä¾›çš„å¸³è™Ÿ (ä¹Ÿå°±æ˜¯ email å¿…é ˆç‚º <code>googlexxxxxx_student@qwiklabs.net</code> )ï¼Œå¦‚æœä½ æœ‰è‡ªå·±çš„ GCP å¸³è™Ÿï¼Œè«‹ä¸è¦ç”¨æ–¼æ­¤ labï¼Œé¿å…ç”¢ç”Ÿè²»ç”¨</p><blockquote><p>é¡ä¼¼æ–¼ <code>googlexxxxxx_student@qwiklabs.net</code> çš„å¸³è™Ÿæ˜¯ä¸€å€‹ Google å¸³è™Ÿï¼Œå°ˆç‚º Qwiklabs å­¸ç”Ÿä½¿ç”¨è€Œå»ºç«‹çš„ã€‚å®ƒå…·æœ‰ç‰¹å®šçš„åŸŸå (ä¹Ÿå°±æ˜¯ <code>qwiklabs.net</code> )ï¼Œä¸¦ä¸”å·²åˆ†é…äº† IAM è§’è‰²ï¼Œå…è¨±ä½ å»å­˜å–è©² GCP å°ˆæ¡ˆã€‚</p></blockquote></div><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-30.png" alt=""></p><ol start="5"><li>æ¥å— terms å’Œ conditionsï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-59.png" alt=""></p><ol start="6"><li>ä¸è¦æ–°å¢ recovery options æˆ– two-factor authentication (å› ç‚ºé€™æ˜¯ä¸€å€‹è‡¨æ™‚å¸³è™Ÿ)ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-23-18.png" alt=""></p><ol start="7"><li>å‹¾é¸åŒæ„æœå‹™æ¢æ¬¾ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-15.png" alt=""></p><p>ä¹‹å¾Œå°±å¯ä»¥é–‹å§‹ä½¿ç”¨ GCP Console å›‰ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-14-14-23-55.png" alt=""></p><h2 id="å•Ÿå‹•-google-cloud-shell"><a class="header-anchor" href="#å•Ÿå‹•-google-cloud-shell"></a>å•Ÿå‹• Google Cloud Shell</h2><p>Google Cloud Shell æ˜¯è¼‰å…¥äº†é–‹ç™¼å·¥å…·çš„ VMï¼Œå®ƒæä¾› 5GB çš„ home ç›®éŒ„ï¼Œä¸¦åœ¨ Google Cloud ä¸ŠåŸ·è¡Œã€‚å¯ç”¨ Google Cloud Shell æä¾›çš„ command-line ä¾†å­˜å– GCP çš„è³‡æºã€‚</p><ol><li>åœ¨ GCP console çš„å³ä¸Šæ–¹å·¥å…·åˆ—ä¸­ï¼Œé»æ“Šã€ŒActivate Cloud Shellã€æŒ‰éˆ•ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-42.png" alt=""></p><ol start="2"><li>åœ¨æ‰“é–‹çš„å°è©±æ¡†å…§ï¼Œé»æ“Šã€ŒSTART CLOUD SHELLã€ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-25-23.png" alt=""></p><ol start="3"><li>é€£æ¥å’Œæä¾›ç’°å¢ƒéœ€è¦ä¸€äº›æ™‚é–“ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-26-05.png" alt=""></p><ol start="4"><li>é€£æ¥å¾Œï¼Œå°±ä»£è¡¨ä½ å·²ç¶“éèº«ä»½é©—è­‰ï¼Œå°ˆæ¡ˆå·²è¨­ç½®ç‚º <code>PROJECT_ID</code>ï¼Œä»¥ä¸‹åœ–çš„ç‚ºä¾‹ï¼Œæ­¤å°ˆæ¡ˆçš„ ID ç‚º <code>qwiklabs-gcp-f9d61ede8167e6b0</code>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-26-34.png" alt=""></p><p><code>gcloud</code> æ˜¯ GCP çš„ command-line å·¥å…·ï¼Œä»–å·²é å…ˆå®‰è£åœ¨ Cloud Shell ä¸Šï¼Œä¸¦ä¸”æ”¯æ´ tab è‡ªå‹•è£œé½Š (tab-completion)ã€‚</p><p>ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤å¯åˆ—å‡ºæœ‰æ•ˆå¸³è™Ÿåç¨±ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud auth list<br>          Credentialed Accounts<br>ACTIVE  ACCOUNT<br>*       google3043863_student@qwiklabs.net<br><br>To set the active account, run:<br>    $ gcloud config set account `ACCOUNT`<br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤åˆ—å‡ºå°ˆæ¡ˆ IDï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud config list project<br>[core]<br>project = qwiklabs-gcp-f9d61ede8167e6b0<br><br>Your active configuration is: [cloudshell-9292]<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/sdk/gcloud/" target="_blank" rel="noopener">Google Cloud gcloud Overview</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="ç‚ºæ‰€æœ‰è³‡æºè¨­å®šé è¨­çš„-region-å’Œ-zone"><a class="header-anchor" href="#ç‚ºæ‰€æœ‰è³‡æºè¨­å®šé è¨­çš„-region-å’Œ-zone"></a>ç‚ºæ‰€æœ‰è³‡æºè¨­å®šé è¨­çš„ region å’Œ zone</h2><p>åœ¨ Cloud Shell ä¸­ï¼ŒåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤è¨­å®šé è¨­ zone ç‚º <code>us-central1-a</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud config set compute/zone us-central1-a<br>Updated property [compute/zone].<br></code></pre></td></tr></table></figure><p>åœ¨ Cloud Shell ä¸­ï¼ŒåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤è¨­å®šé è¨­ region ç‚º <code>us-central1</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud config set compute/region us-central1<br>Updated property [compute/region].<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/regions-zones/" target="_blank" rel="noopener">Regions &amp; Zones</a> æ–‡ä»¶ã€‚</p></blockquote><div class="info"><p>æ³¨æ„ï¼šåœ¨è‡ªå·±çš„æ©Ÿå™¨ä¸ŠåŸ·è¡Œ <code>gcloud</code> æ™‚ï¼Œ<code>config</code> è¨­å®šåœ¨ session ä¸­ä¿æŒä¸è®Š (persist across)ã€‚åœ¨ Cloud Shell ä¸­ï¼Œä½ éœ€è¦ç‚ºæ¯å€‹æ–°çš„ session æˆ–é‡æ–°é€£æ¥è¨­å®šæ­¤é …ã€‚</p></div><h2 id="å»ºç«‹å¤šå€‹-web-server-instance"><a class="header-anchor" href="#å»ºç«‹å¤šå€‹-web-server-instance"></a>å»ºç«‹å¤šå€‹ web server instance</h2><p>ç‚ºäº†æ¨¡æ“¬ä¾†è‡³ä¸€å€‹å¢é›†ä¸»æ©Ÿçš„æœå‹™ï¼Œè«‹ä½¿ç”¨ <a href="https://cloud.google.com/compute/docs/instance-templates" target="_blank" rel="noopener">Instance Templates</a> å’Œ <a href="https://cloud.google.com/compute/docs/instance-groups/" target="_blank" rel="noopener">Managed Instance Groups</a> å»ºç«‹ä¸€å€‹ç°¡å–®çš„ Nginx web server å¢é›†ä¾†æä¾›éœæ…‹å…§å®¹ã€‚Instance Templates å®šç¾©å¢é›†ä¸­æ¯å€‹ VM çš„è¦æ ¼ (ç¡¬ç¢Ÿã€CPUã€è¨˜æ†¶é«”â€¦ç­‰)ï¼ŒManaged Instance Groups ä½¿ç”¨ Instance Templates å¯¦ä¾‹åŒ– (instantiate) å¤šå€‹ VM instanceã€‚</p><p>è¦å»ºç«‹ä¸€å€‹ Nginx web server å¢é›†ï¼Œè«‹å»ºç«‹ä»¥ä¸‹å…§å®¹ï¼š</p><ul><li>ä¸€å€‹ç”¨ä¾†åœ¨æ¯å€‹ VM instance å•Ÿå‹•æ™‚è¨­å®š Nginx server çš„ startup script</li><li>ä¸€å€‹è¦ä½¿ç”¨ startup script çš„ instance template</li><li>ä¸€å€‹ target pool</li><li>ä¸€å€‹ä½¿ç”¨ instance template çš„ managed instance group</li></ul><h3 id="å»ºç«‹-startup-script"><a class="header-anchor" href="#å»ºç«‹-startup-script"></a>å»ºç«‹ startup script</h3><p>åœ¨ Cloud Shell åŸ·è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œå»ºç«‹è¦è®“æ¯å€‹ VM instance ä½¿ç”¨çš„ startup scriptã€‚æ­¤ script æœƒåœ¨å•Ÿå‹•æ™‚è¨­å®š Nginx serverï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">cat &lt;&lt; EOF &gt; startup.sh<br><span class="hljs-meta">#! /bin/bash</span><br>apt-get update<br>apt-get install -y nginx<br>service nginx start<br>sed -i -- <span class="hljs-string">'s/nginx/Google Cloud Platform - '</span><span class="hljs-string">"\$HOSTNAME"</span><span class="hljs-string">'/'</span> /var/www/html/index.nginx-debian.html<br>EOF<br></code></pre></td></tr></table></figure><h3 id="å»ºç«‹-instance-template"><a class="header-anchor" href="#å»ºç«‹-instance-template"></a>å»ºç«‹ instance template</h3><p>å»ºç«‹ä¸€å€‹ä½¿ç”¨ startup script çš„ instance templateï¼š</p><ul><li><code>nginx-template</code>ï¼šinstance template çš„åç¨±</li><li><code>--metadata-from-file startup-script=startup.sh</code>ï¼š<code>--metadata-from-file</code> åƒæ•¸æœƒå¾ local æª”æ¡ˆä¸­æ‰¾åˆ°æŒ‡å®šçš„ startup script</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute instance-templates create nginx-template \</span><br>         --metadata-from-file startup-script=startup.sh<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../global/instanceTemplates/nginx-template].<br>NAME            MACHINE_TYPE   PREEMPTIBLE  CREATION_TIMESTAMP<br>nginx-template  n1-standard-1               2019-04-22T04:53:53.045-07:00<br></code></pre></td></tr></table></figure><p>å¦‚æœä¸Šé¢æŒ‡ä»¤æ²’æœ‰æä¾›æ˜ç¢ºçš„ template è¨­å®šï¼Œ<code>gcloud compute</code> æœƒä½¿ç”¨ä»¥ä¸‹é è¨­å€¼å»ºç«‹ templateï¼š</p><ul><li>æ©Ÿå‹ï¼š<code>n1-standard-1</code></li><li>imageï¼šæœ€æ–°ç‰ˆçš„ Debian image</li><li>é–‹æ©Ÿç£ç¢Ÿï¼šä»¥ instance å‘½åçš„æ–°æ¨™æº–é–‹æ©Ÿç£ç¢Ÿ</li><li>ç¶²è·¯ï¼š<code>default</code> VPC ç¶²è·¯</li><li>IP ä½å€ï¼šè‡¨æ™‚çš„å¤–éƒ¨ IP ä½å€</li></ul><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/sdk/gcloud/reference/compute/instance-templates/" target="_blank" rel="noopener"><code>gcloud compute instance-templates</code></a> æ–‡ä»¶ã€‚</p></blockquote><blockquote><p>è‹¥æƒ³äº†è§£æ›´å¤šå»ºç«‹ instance template çš„æ–¹æ³•ï¼Œè©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/instance-templates/create-instance-templates" target="_blank" rel="noopener">Creating Instance Templates</a> æ–‡ä»¶ã€‚</p></blockquote><h3 id="å»ºç«‹-target-pool"><a class="header-anchor" href="#å»ºç«‹-target-pool"></a>å»ºç«‹ target pool</h3><p>target pool è³‡æºå®šç¾©äº†ä¸€çµ„å¯ä»¥å¾ forwarding rules æ¥æ”¶æ”¶åˆ°æµé‡çš„ instanceã€‚ç•¶ forwarding rules å°‡æµé‡å°å‘åˆ° target pool æ™‚ï¼ŒGoogle Cloud Load Balancing æœƒæ ¹æ“š source IP å’Œ port ä»¥åŠç›®æ¨™ IP å’Œ port çš„ hash å€¼ï¼Œå¾é€™äº› target pool ä¸­é¸æ“‡ä¸€å€‹ instanceã€‚</p><p>å»ºç«‹ target poolï¼Œtarget pool å…è¨±å–®å€‹å­˜å–é»åˆ°ç¾¤çµ„ä¸­çš„æ‰€æœ‰ instanceï¼Œè€Œä¸”å°æ–¼ä¹‹å¾Œæ­¥é©Ÿçš„è² è¼‰å¹³è¡¡ä¾†èªªæ˜¯å¿…éœ€çš„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute target-pools create nginx-pool</span><br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../regions/us-central1/targetPools/nginx-pool].<br>NAME        REGION       SESSION_AFFINITY  BACKUP  HEALTH_CHECKS<br>nginx-pool  us-central1  NONE<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹æ–‡ä»¶ï¼š</p><ul><li>å»ºç«‹ target pool æŒ‡ä»¤ï¼š<a href="https://cloud.google.com/sdk/gcloud/reference/compute/target-pools/create" target="_blank" rel="noopener"><code>gcloud compute target-pools create</code></a></li><li><a href="https://cloud.google.com/load-balancing/docs/network/" target="_blank" rel="noopener">Network Load Balancing Concepts</a></li><li><a href="https://cloud.google.com/load-balancing/docs/target-pools" target="_blank" rel="noopener">Using Target Pools</a></li></ul></blockquote><h3 id="å»ºç«‹-managed-instance-group"><a class="header-anchor" href="#å»ºç«‹-managed-instance-group"></a>å»ºç«‹ managed instance group</h3><p>ä½¿ç”¨ instance template å»ºç«‹ managed instance groupï¼š</p><ul><li><code>nginx-group</code>ï¼šinstance group çš„åç¨±</li><li><code>--base-instance-name nginx</code>ï¼šå…¶ä¸­çš„ <code>nginx</code> æ˜¯æŒ‡åœ¨æ­¤ managed instance group ä¸­å»ºç«‹çš„ instance ä½¿ç”¨çš„åç¨±ã€‚ç”±æ–¼é€™äº› instance éƒ½ä¸€æ¨£ï¼Œç³»çµ±æœƒç”¨éš¨æ©Ÿå­—ä¸²ä¾†ä½œç‚º instance åç¨±çš„ä¸€éƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼šå¦‚æœ base åç¨±æ˜¯ <code>nginx</code>ï¼Œinstance çš„åç¨±å°±å¯èƒ½æœƒæ˜¯ <code>nginx-cl3t</code>ã€<code>nginx-sqgw</code> â€¦ ç­‰</li><li><code>--size 2</code>ï¼šinstance group çš„å¤§å°</li><li><code>--template nginx-template</code>ï¼šç”¨æ–¼æ­¤ç¾¤çµ„çš„ instance template çš„åç¨±</li><li><code>--target-pool nginx-pool</code>ï¼šè¦æ–°å¢æ­¤ instance group çš„ target pool çš„åç¨± (å¯å¤šå€‹ target pool)</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute instance-groups managed create nginx-group \</span><br>         --base-instance-name nginx \<br>         --size 2 \<br>         --template nginx-template \<br>         --target-pool nginx-pool<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../zones/us-central1-a/instanceGroupManagers/nginx-group].<br>NAME         LOCATION       SCOPE  BASE_INSTANCE_NAME  SIZE  TARGET_SIZE  INSTANCE_TEMPLATE  AUTOSCALED<br>nginx-group  us-central1-a  zone   nginx               0     2            nginx-template     no<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/instance-groups/creating-groups-of-managed-instances" target="_blank" rel="noopener">Creating groups of managed instances</a> æ–‡ä»¶ã€‚</p></blockquote><p>åŸ·è¡Œä¸Šé¢çš„æŒ‡ä»¤å¾Œï¼Œæœƒå»ºç«‹å…©å€‹ VM instanceï¼Œåç¨±æœƒä»¥ <code>nginx-</code> ç‚ºå‰ç¶´ï¼Œå¯èƒ½éœ€è¦ç­‰å¹¾åˆ†é˜ã€‚</p><p>æ¥è‘—æŸ¥çœ‹å·²å»ºç«‹çš„æ‰€æœ‰ compute engine instanceï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute instances list</span><br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">NAME        ZONE           MACHINE_TYPE   PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP     STATUS<br>nginx-cl3t  us-central1-a  n1-standard-1               10.128.0.3   35.193.149.246  RUNNING<br>nginx-sqgw  us-central1-a  n1-standard-1               10.128.0.2   130.211.208.12  RUNNING<br></code></pre></td></tr></table></figure><h3 id="è¨­å®šé˜²ç«ç‰†"><a class="header-anchor" href="#è¨­å®šé˜²ç«ç‰†"></a>è¨­å®šé˜²ç«ç‰†</h3><p>è¨­å®šé˜²ç«ç‰†å¾Œï¼Œå°±å¯ä»¥é€é <code>EXTERNAL_IP</code> ä½å€å’Œ 80 port ä¾†é€£æ¥æ©Ÿå™¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute firewall-rules create www-firewall --allow tcp:80</span><br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">Creating firewall...â ›Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../global/firewalls/www-firewall].<br>Creating firewall...done.<br>NAME          NETWORK  DIRECTION  PRIORITY  ALLOW   DENY  DISABLED<br>www-firewall  default  INGRESS    1000      tcp:80        False<br></code></pre></td></tr></table></figure><p>åŸ·è¡Œä¸Šé¢çš„æŒ‡ä»¤å¾Œï¼Œæ‡‰è©²å°±èƒ½é€éå¤–éƒ¨ IP ä½å€ (ä¹Ÿå°±æ˜¯ <code>http://EXTERNAL_IP/</code> ) ä¾†é€£æ¥å‰›å‰›å»ºç«‹çš„å…©å€‹ instanceï¼Œå¯ä»¥åœ¨å„åˆ¥çš„é é¢ä¸­ï¼Œçœ‹åˆ°å„å€‹ instance çš„åç¨±ï¼š</p><p><img src="../images/gcp-network-and-http-load-balancer/2019-04-22-20-01-58.png" alt=""></p><p><img src="../images/gcp-network-and-http-load-balancer/2019-04-22-20-02-42.png" alt=""></p><h2 id="å»ºç«‹-network-load-balancer"><a class="header-anchor" href="#å»ºç«‹-network-load-balancer"></a>å»ºç«‹ Network Load Balancer</h2><p>Network load balancing å…è¨±ä½ ä¾æ“šæ”¶åˆ°çš„ IP å”å®šè³‡æ–™ (ä¾‹å¦‚ï¼šä½å€ã€port å’Œå”å®šé¡å‹) ä¾†å¹³è¡¡ç³»çµ±çš„è² è¼‰ã€‚ä½ é‚„å¯ä»¥å–å¾— HTTP(S) load balancing æ²’æœ‰æä¾›çš„ä¸€äº›é¸é …ã€‚ä¾‹å¦‚ï¼šå¯ä»¥å°å…¶ä»–åŸºæ–¼ TCP/UDP çš„å”å®š (ä¾‹å¦‚ï¼šSMTP æµé‡) é€²è¡Œè² è¼‰å¹³è¡¡ã€‚å¦‚æœä½ çš„æ‡‰ç”¨ç¨‹å¼å° TCP é€£æ¥ç›¸é—œçš„ç‰¹æ€§æ„Ÿèˆˆè¶£ï¼Œnetwork load balancing ä¹Ÿå…è¨±ä½ çš„æ‡‰ç”¨ç¨‹å¼å»æª¢æŸ¥å°åŒ…ï¼Œè€Œ HTTP(S) load balancing å‰‡æ²’æœ‰æä¾›ã€‚</p><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/load-balancing/network/" target="_blank" rel="noopener">Setting Up Network Load Balancing</a> æ–‡ä»¶ã€‚</p></blockquote><p>é‡å°ä½ çš„ instance group ä¾†å»ºç«‹ L3 network load balancerï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute forwarding-rules create nginx-lb \</span><br>         --region us-central1 \<br>         --ports=80 \<br>         --target-pool nginx-pool<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../regions/us-central1/forwardingRules/nginx-lb].<br></code></pre></td></tr></table></figure><p>Forwarding rule è¦èˆ‡ target pool ä¸€èµ·ä½¿ç”¨ï¼Œä»¥æ”¯æ´ load balancing åŠŸèƒ½ï¼Œè¦ä½¿ç”¨ load balancing å°±å¿…é ˆå»ºç«‹ forwarding ruleï¼Œé€™æ¨£æ‰æœƒå°‡æµé‡å°å‘åˆ°ç‰¹å®šçš„ target pool (ç”¨æ–¼ load balancing)ï¼Œè€Œä¸‹é¢æŒ‡ä»¤ä¸­çš„ <code>--ports=80</code> ä»£è¡¨æŒ‡å‘ target pool çš„å¤–éƒ¨ port ç¯„åœã€‚</p><p>åˆ—å‡ºå°ˆæ¡ˆä¸­æ‰€æœ‰ Google Compute Engine (GCE) çš„ Forwarding ruleï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute forwarding-rules list</span><br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">NAME      REGION       IP_ADDRESS      IP_PROTOCOL  TARGET<br>nginx-lb  us-central1  35.202.173.185  TCP          us-central1/targetPools/nginx-pool<br></code></pre></td></tr></table></figure><p>æ¥è‘—é€é <code>http://IP_ADDRESS/</code> ä¾†å­˜å– load balancerï¼Œ<code>IP_ADDRESS</code> æ˜¯ä¸Šé¢åŸ·è¡Œçš„æŒ‡ä»¤ä¸­æ‰€è¼¸å‡ºçš„ IP ä½å€ã€‚</p><p><img src="../images/gcp-network-and-http-load-balancer/2019-04-22-20-05-28.png" alt=""></p><h2 id="å»ºç«‹-http-s-load-balancer"><a class="header-anchor" href="#å»ºç«‹-http-s-load-balancer"></a>å»ºç«‹ HTTP(S) Load Balancer</h2><p>HTTP(S) Load Balancing æä¾›å…¨çƒæ€§çš„ load balancingï¼Œèƒ½å°‡ HTTP è«‹æ±‚é€å¾€ä½ çš„ instanceã€‚ä½ å¯ä»¥è¨­å®š URL è¦å‰‡ï¼Œå°‡ä¸€äº› URL è·¯ç”± (route) åˆ°ä¸€çµ„ instanceï¼Œä¸¦å°‡å…¶ä»– URL è·¯ç”±åˆ°å…¶ä»– instanceã€‚è«‹æ±‚éƒ½æœƒè·¯ç”±åˆ°æœ€æ¥è¿‘ä½¿ç”¨è€…çš„ instance groupï¼Œå‰ææ˜¯è©² group å…·æœ‰è¶³å¤ çš„è³‡æºï¼Œä¸¦ä¸”é©åˆè«‹æ±‚ã€‚å¦‚æœæœ€è¿‘çš„ group æ²’æœ‰è¶³å¤ çš„è³‡æºï¼Œé‚£è«‹æ±‚å°‡æœƒé€è‡³å…·æœ‰è¶³å¤ è³‡æºï¼Œä¸¦ä¸”æ˜¯æœ€æ¥è¿‘ä½¿ç”¨è€…çš„ groupã€‚</p><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/load-balancing/http/" target="_blank" rel="noopener">HTTP(S) Load Balancer</a> æ–‡ä»¶ã€‚</p></blockquote><p>é¦–å…ˆï¼Œå»ºç«‹ <a href="https://cloud.google.com/compute/docs/load-balancing/health-checks" target="_blank" rel="noopener">health check</a>ã€‚health check å¯ä»¥ç¢ºèª instance æ˜¯å¦æœ‰å›æ‡‰ HTTP æˆ– HTTPS æµé‡ï¼Œå…¶ä»–çš„ <code>http-basic-check</code> æ˜¯ legacy health check çš„åç¨±ã€‚åœ¨å°ˆæ¡ˆä¸­ï¼Œæ¯å€‹ legacy health check çš„åç¨±ä¸èƒ½é‡è¤‡ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute http-health-checks create http-basic-check</span><br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../global/httpHealthChecks/http-basic-check].<br>NAME              HOST  PORT  REQUEST_PATH<br>http-basic-check        80    /<br></code></pre></td></tr></table></figure><p>å®šç¾© HTTP serviceï¼Œä¸¦å°‡ port è™Ÿ map åˆ° instance group çš„ç›¸é—œ portã€‚ç¾åœ¨ load balancing service å¯ä»¥å°‡æµé‡ forward åˆ°æŒ‡å®šçš„ port è™Ÿï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute instance-groups managed \</span><br>       set-named-ports nginx-group \<br>       --named-ports http:80<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Updated [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../zones/us-central1-a/instanceGroups/nginx-group].<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/instance-groups/creating-groups-of-managed-instances" target="_blank" rel="noopener">Creating groups of managed instances</a> æ–‡ä»¶ã€‚</p></blockquote><p>å»ºç«‹ <a href="https://cloud.google.com/compute/docs/reference/latest/backendServices" target="_blank" rel="noopener">å¾Œç«¯æœå‹™ (backend service)</a>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute backend-services create nginx-backend \</span><br>      --protocol HTTP \<br>      --http-health-checks http-basic-check \<br>      --global<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../global/backendServices/nginx-backend].<br>NAME           BACKENDS  PROTOCOL<br>nginx-backend            HTTP<br></code></pre></td></tr></table></figure><p>å°‡ instance group åŠ åˆ°å¾Œç«¯æœå‹™ä¸­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute backend-services add-backend nginx-backend \</span><br>    --instance-group nginx-group \<br>    --instance-group-zone us-central1-a \<br>    --global<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Updated [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../global/backendServices/nginx-backend].<br></code></pre></td></tr></table></figure><p>å»ºç«‹ä¸€å€‹é è¨­çš„ URL mapï¼Œå°‡æ‰€æœ‰æ”¶åˆ°çš„è«‹æ±‚å°å‘ä½ çš„æ‰€æœ‰ instanceï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute url-maps create web-map \</span><br>    --default-service nginx-backend<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../global/urlMaps/web-map].<br>NAME     DEFAULT_SERVICE<br>web-map  backendServices/nginx-backend<br></code></pre></td></tr></table></figure><blockquote><p>è‹¥è¦æ ¹æ“šè«‹æ±‚çš„ URL å°‡æµé‡å°å‘ä¸åŒçš„ instanceï¼Œè©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/load-balancing/http/content-based-example" target="_blank" rel="noopener">content-based routing</a> æ–‡ä»¶ã€‚</p></blockquote><p>å»ºç«‹ target HTTP proxyï¼Œå°‡è«‹æ±‚è·¯ç”±åˆ° URL mapï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute target-http-proxies create http-lb-proxy \</span><br>    --url-map web-map<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../global/targetHttpProxies/http-lb-proxy].<br>NAME           URL_MAP<br>http-lb-proxy  web-map<br></code></pre></td></tr></table></figure><p>å»ºç«‹ <a href="https://cloud.google.com/load-balancing/docs/https/global-forwarding-rules" target="_blank" rel="noopener">global forwarding rule</a>ï¼Œä»¥è™•ç†å’Œè·¯ç”±æ”¶åˆ°çš„è«‹æ±‚ã€‚forwarding rule æœƒæ ¹æ“šæŒ‡å®šçš„ IP ä½å€ã€IP å”å®šå’Œ portï¼Œå°‡æµé‡é€è‡³ç‰¹å®šçš„ target HTTP æˆ– HTTPS proxyã€‚global forwarding rule ä¸æ”¯æ´å¤š portã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute forwarding-rules create http-content-rule \</span><br>        --global \<br>        --target-http-proxy http-lb-proxy \<br>        --ports 80<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-.../global/forwardingRules/http-content-rule].<br></code></pre></td></tr></table></figure><p>å»ºç«‹ global forwarding rule å¾Œï¼Œè¨­å®šå¯èƒ½éœ€è¦å¹¾åˆ†é˜æ‰èƒ½å‚³æ’­ (propagate)ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute forwarding-rules list</span><br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">NAME               REGION       IP_ADDRESS      IP_PROTOCOL  TARGET<br>http-content-rule               34.96.77.47     TCP          http-lb-proxy<br>nginx-lb           us-central1  35.202.173.185  TCP          us-central1/targetPools/nginx-pool<br></code></pre></td></tr></table></figure><p>è¤‡è£½ forwarding rule å…§çš„ <code>http-content-rule</code> ä¸­çš„ <code>IP_ADDRESS</code>ã€‚</p><p>ä½ å¯èƒ½éœ€è¦å¹¾åˆ†é˜æ‰èƒ½é€éç€è¦½å™¨é€£æ¥åˆ° <code>http://IP_ADDRESS/</code>ã€‚å¦‚æœç„¡æ³•é€£æ¥ (å°±åƒä¸‹åœ–é€™æ¨£)ï¼Œè«‹ç¨ç­‰ä¸€ä¸‹ï¼Œå†é‡æ–°æ•´ç†ç€è¦½å™¨ï¼š</p><p><img src="../images/gcp-network-and-http-load-balancer/2019-04-22-20-15-02.png" alt=""></p><p>ä¸‹é¢å…©å¼µåœ–å°±æ˜¯å¤šæ¬¡é€£æ¥ <code>http://IP_ADDRESS/</code> çš„æ™‚å€™ï¼Œå¸¸æœƒçœ‹åˆ°ç•«é¢åœ¨é€™å…©å€‹ä¹‹å‰å»ºç«‹çš„ VM instance é–“åˆ‡æ›ï¼š</p><p><img src="../images/gcp-network-and-http-load-balancer/2019-04-22-20-16-47.png" alt=""></p><p><img src="../images/gcp-network-and-http-load-balancer/2019-04-22-20-17-26.png" alt=""></p><h2 id="åƒè€ƒä¾†æº"><a class="header-anchor" href="#åƒè€ƒä¾†æº"></a>åƒè€ƒä¾†æº</h2><ul><li><a href="https://www.qwiklabs.com/focuses/558?parent=catalog" target="_blank" rel="noopener">Set Up Network and HTTP Load Balancers</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/gcp.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ&lt;a href=&quot;https://www.qwiklabs.com/focuses/558?parent=catalog&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Set Up Network and HTTP Load Balancers&lt;/a&gt;ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•å»ºç«‹å¤šå€‹ web server instanceï¼Œä»¥åŠå¦‚ä½•å»ºç«‹ network load balancer å’Œ HTTP load balancerã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Cloud" scheme="https://titangene.github.io/categories/cloud/"/>
    
    
      <category term="GCP" scheme="https://titangene.github.io/tags/gcp/"/>
    
      <category term="HTTP" scheme="https://titangene.github.io/tags/http/"/>
    
      <category term="Load Balancer" scheme="https://titangene.github.io/tags/load-balancer/"/>
    
  </entry>
  
  <entry>
    <title>Google Kubernetes Engine (GKE) å…¥é–€</title>
    <link href="https://titangene.github.io/article/getting-started-with-google-k8s-engine.html"/>
    <id>https://titangene.github.io/article/getting-started-with-google-k8s-engine.html</id>
    <published>2019-04-19T09:30:24.000Z</published>
    <updated>2019-04-30T16:00:09.450Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/gke.jpg" alt=""></p><p>æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ<a href="https://www.qwiklabs.com/focuses/878?parent=catalog" target="_blank" rel="noopener">Kubernetes Engine: Qwik Start</a>ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•é€é GKE å»ºç«‹å®¹å™¨å’Œéƒ¨ç½²å®¹å™¨åŒ–æ‡‰ç”¨ç¨‹å¼ã€‚</p><a id="more"></a><p><img src="../images/getting-started-with-google-k8s-engine/2019-04-18-23-36-15.png" alt=""></p><p><a href="https://cloud.google.com/kubernetes-engine/" target="_blank" rel="noopener">Google Kubernetes Engine</a> (GKE) æä¾›äº†ä¸€å€‹ä»£ç®¡ç’°å¢ƒï¼Œå¯ä»¥ä½¿ç”¨ Google åŸºç¤æ¶æ§‹ä¾†éƒ¨ç½²ã€ç®¡ç†å’Œæ“´å±•å®¹å™¨åŒ–æ‡‰ç”¨ç¨‹å¼ã€‚GKE æä¾›çš„ç’°å¢ƒæ˜¯ç”±å¤šå°æ©Ÿå™¨ (ç‰¹åˆ¥æ˜¯ <a href="https://cloud.google.com/compute" target="_blank" rel="noopener">Google Compute Engine</a> instance) çµ„æˆï¼Œçµ„æˆä¸€å€‹<a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-architecture" target="_blank" rel="noopener">å®¹å™¨å¢é›†</a>ã€‚åœ¨æ­¤ lab ä¸­ï¼Œä½ å°‡é€é GKE ä¾†å¯¦éš›ç·´ç¿’å¦‚ä½•å»ºç«‹å®¹å™¨å’Œéƒ¨ç½²æ‡‰ç”¨ç¨‹å¼ã€‚</p><h2 id="gke-çš„å¢é›†ç·¨æ’ç®¡ç†-orchestration"><a class="header-anchor" href="#gke-çš„å¢é›†ç·¨æ’ç®¡ç†-orchestration"></a>GKE çš„å¢é›†ç·¨æ’ç®¡ç† (orchestration)</h2><p>GKE å¢é›†æ˜¯ç”± <a href="https://kubernetes.io/" target="_blank" rel="noopener">Kubernetes</a> é–‹æºå¢é›†ç®¡ç†ç³»çµ±æä¾›æŠ€è¡“æ”¯æ´ã€‚ä½ å¯ä»¥é€é Kubernetes æä¾›çš„æ©Ÿåˆ¶èˆ‡å®¹å™¨å¢é›†äº’å‹•ã€‚å¯ä»¥ä½¿ç”¨ Kubernetes æŒ‡ä»¤å’Œè³‡æºä¾†éƒ¨ç½²ä»¥åŠç®¡ç†æ‡‰ç”¨ç¨‹å¼ã€åŸ·è¡Œç®¡ç†ä»»å‹™ã€åˆ¶è¨‚æ”¿ç­–ï¼Œä»¥åŠç›£æ§å·²éƒ¨ç½²å·¥ä½œè² è¼‰ (workload) çš„å¥åº·ç‹€æ…‹ã€‚</p><p>Kubernetes æ¡ç”¨ç›¸åŒçš„è¨­è¨ˆåŸå‰‡ä¾†åŸ·è¡Œå¸¸ç”¨çš„ Google æœå‹™ï¼Œä¸¦æä¾›ç›¸åŒçš„å„ªå‹¢ï¼šæ‡‰ç”¨ç¨‹åºå®¹å™¨çš„è‡ªå‹•ç®¡ç†ã€ç›£æ§èˆ‡æœ‰æ•ˆæ€§æ¢æ¸¬ (liveness probe)ã€è‡ªå‹•æ“´å±•ï¼Œæ»¾å‹•å‡ç´šâ€¦ç­‰ã€‚ç•¶æ‚¨åœ¨å®¹å™¨å¢é›†ä¸ŠåŸ·è¡Œæ‡‰ç”¨ç¨‹åºæ™‚ï¼Œä½ æ‰€ä½¿ç”¨çš„æŠ€è¡“æ˜¯ç”± Google åœ¨å®¹å™¨ä¸­åŸ·è¡Œ production å·¥ä½œè² è¼‰çš„åé¤˜å¹´ç¶“é©—çš„æŠ€è¡“ã€‚</p><h2 id="gcp-ä¸Šçš„-kubernetes"><a class="header-anchor" href="#gcp-ä¸Šçš„-kubernetes"></a>GCP ä¸Šçš„ Kubernetes</h2><p>åŸ·è¡Œ GKE å¢é›†æ™‚ï¼Œä½ ä¹Ÿå¯ä»¥ç²å¾— GCP æ‰€æä¾›çš„é€²éšå¢é›†ç®¡ç†åŠŸèƒ½å„ªé»ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š</p><ul><li>Google Compute Engine (GCE) instances æä¾›çš„<a href="https://cloud.google.com/compute/docs/load-balancing-and-autoscaling" target="_blank" rel="noopener">è² è¼‰å¹³è¡¡</a></li><li><a href="https://cloud.google.com/kubernetes-engine/docs/concepts/node-pools" target="_blank" rel="noopener">ç¯€é»æ±  (Node Pools)</a> å¯ä»¥æŒ‡å®šå¢é›†ä¸­çš„å­é›†ç¯€é»ï¼Œä»¥ç²å¾—é¡å¤–çš„éˆæ´»æ€§</li><li><a href="https://cloud.google.com/kubernetes-engine/docs/cluster-autoscaler" target="_blank" rel="noopener">è‡ªå‹•æ“´å±• (Automatic scaling)</a> å¢é›†çš„ç¯€é» instance æ•¸é‡</li><li><a href="https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-upgrades" target="_blank" rel="noopener">è‡ªå‹•å‡ç´š</a>å¢é›†çš„ç¯€é»è»Ÿé«”</li><li><a href="https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-repair" target="_blank" rel="noopener">è‡ªå‹•ä¿®å¾©ç¯€é»</a>ï¼šå¯ç¶­è­·ç¯€é»çš„å¥åº·ç‹€æ…‹å’Œå¯ç”¨æ€§</li><li>ä½¿ç”¨ Stackdriver ä¾†<a href="https://cloud.google.com/kubernetes-engine/docs/how-to/logging" target="_blank" rel="noopener">è¨˜éŒ„ (logging)</a> å’Œ<a href="https://cloud.google.com/kubernetes-engine/docs/how-to/monitoring" target="_blank" rel="noopener">ç›£æ§</a>ï¼Œç”¨æ–¼æŸ¥çœ‹å¢é›†çš„ç‹€æ…‹</li></ul><h2 id="æº–å‚™"><a class="header-anchor" href="#æº–å‚™"></a>æº–å‚™</h2><p>åœ¨é»æ“Šã€ŒStart Labã€ä¹‹å‰ï¼Œæº–å‚™å¥½ç¶²è·¯ç€è¦½å™¨ (æ¨è–¦ç”¨ Google Chrome)ï¼Œä¸¦ä¸”è‡³å°‘ 40 åˆ†é˜å¯ä»¥å°ˆæ³¨çš„æ™‚é–“ï¼Œå› ç‚º lab æ˜¯æœ‰æ™‚é–“é™åˆ¶ï¼Œç•¶ä½ æŒ‰ä¸‹ã€ŒStart Labã€é–‹å§‹å­¸ç¿’æ™‚ï¼Œç„¡æ³•æš«åœå€’æ•¸è¨ˆæ™‚ï¼Œä½ åªèƒ½åœ¨é€™æ®µæ™‚é–“å…§ä½¿ç”¨ lab æä¾›çµ¦ä½ çš„å…¨æ–°æš«æ™‚ GCP Console å¯ç”¨å¸³è™Ÿï¼Œæ™‚é–“åˆ°ä¹‹å¾Œçš„å¹¾åˆ†é˜å°±æœƒè‡ªå‹•ç™»å‡ºã€‚</p><div class="warning"><p>æ³¨æ„ï¼šå¦‚æœä½ æœ‰è‡ªå·±çš„å€‹äºº GCP å¸³è™Ÿæˆ–å°ˆæ¡ˆï¼Œè«‹ä¸è¦åœ¨æ­¤ lab ä½¿ç”¨</p></div><h2 id="é–‹å§‹ä½ çš„-lab-ç„¶å¾Œç™»å…¥-gcp-console"><a class="header-anchor" href="#é–‹å§‹ä½ çš„-lab-ç„¶å¾Œç™»å…¥-gcp-console"></a>é–‹å§‹ä½ çš„ Labï¼Œç„¶å¾Œç™»å…¥ GCP Console</h2><ol><li>å¦‚æœæº–å‚™è¦é–‹å§‹ï¼Œå¯ä»¥é»æ“Šå³ä¸Šè§’çš„ã€ŒStart Labã€é–‹å§‹ï¼š</li></ol><p><img src="../images/getting-started-with-cloud-shell-gcloud-and-gsutil/2019-04-16-00-25-52.png" alt=""></p><ol start="2"><li>æ¥è‘—æœƒå‡ºç¾é€™å€‹ç•«é¢ï¼Œå› ç‚ºæˆ‘åƒåŠ  <a href="https://www.facebook.com/events/2005848903055499/" target="_blank" rel="noopener">GDG Tainan</a> çš„æ´»å‹•ï¼Œæ´»å‹•æœ‰æä¾› Qwiklabs ä¸€å€‹æœˆçš„å…è²»é¡åº¦ï¼Œæ‰€ä»¥æˆ‘é»é¸ä¸‹åœ–å·¦é‚Šçš„ã€ŒUse Subscriptionã€ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-21-15.png" alt=""></p><ol start="3"><li>Lab æœƒæä¾›çµ¦ä½ å…è²»æš«æ™‚çš„ GCP å¸³è™Ÿï¼Œè¤‡è£½å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œç„¶å¾Œé»æ“Šã€ŒOpen Google Consoleã€é–‹å•Ÿ <a href="https://cloud.google.com/storage/docs/cloud-console" target="_blank" rel="noopener">GCP Console</a>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-15-33-31.png" alt=""></p><p>åœ–ç‰‡ä¾†æºï¼š<a href="https://www.qwiklabs.com/focuses/3563?parent=catalog" target="_blank" rel="noopener">Creating a Virtual Machine | Qwiklabs</a></p><ol start="4"><li>æ¥è‘—å°±æœƒé–‹å•Ÿç™»å…¥é é¢ï¼Œå»ºè­°å¦å¤–é–‹ Chrome ç„¡ç—•æ¨¡å¼ä¾†ç™»å…¥ lab æä¾›çš„å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œå› ç‚º Chrome æœƒç´€éŒ„å¸³å¯†ï¼Œç¾åœ¨ç™»å…¥çš„åªæ˜¯æš«æ™‚å¸³è™Ÿï¼Œæœªä¾†ä¸éœ€è¦ç”¨åˆ°ï¼š</li></ol><div class="warning"><p>æ³¨æ„ï¼šé€™é‚Šæ˜¯ç™»å…¥ lab æä¾›çš„å¸³è™Ÿ (ä¹Ÿå°±æ˜¯ email å¿…é ˆç‚º <code>googlexxxxxx_student@qwiklabs.net</code> )ï¼Œå¦‚æœä½ æœ‰è‡ªå·±çš„ GCP å¸³è™Ÿï¼Œè«‹ä¸è¦ç”¨æ–¼æ­¤ labï¼Œé¿å…ç”¢ç”Ÿè²»ç”¨</p><blockquote><p>é¡ä¼¼æ–¼ <code>googlexxxxxx_student@qwiklabs.net</code> çš„å¸³è™Ÿæ˜¯ä¸€å€‹ Google å¸³è™Ÿï¼Œå°ˆç‚º Qwiklabs å­¸ç”Ÿä½¿ç”¨è€Œå»ºç«‹çš„ã€‚å®ƒå…·æœ‰ç‰¹å®šçš„åŸŸå (ä¹Ÿå°±æ˜¯ <code>qwiklabs.net</code> )ï¼Œä¸¦ä¸”å·²åˆ†é…äº† IAM è§’è‰²ï¼Œå…è¨±ä½ å»å­˜å–è©² GCP å°ˆæ¡ˆã€‚</p></blockquote></div><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-30.png" alt=""></p><ol start="5"><li>æ¥å— terms å’Œ conditionsï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-59.png" alt=""></p><ol start="6"><li>ä¸è¦æ–°å¢ recovery options æˆ– two-factor authentication (å› ç‚ºé€™æ˜¯ä¸€å€‹è‡¨æ™‚å¸³è™Ÿ)ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-23-18.png" alt=""></p><ol start="7"><li>å‹¾é¸åŒæ„æœå‹™æ¢æ¬¾ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-15.png" alt=""></p><p>ä¹‹å¾Œå°±å¯ä»¥é–‹å§‹ä½¿ç”¨ GCP Console å›‰ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-14-14-23-55.png" alt=""></p><h2 id="å•Ÿå‹•-google-cloud-shell"><a class="header-anchor" href="#å•Ÿå‹•-google-cloud-shell"></a>å•Ÿå‹• Google Cloud Shell</h2><p>Google Cloud Shell æ˜¯è¼‰å…¥äº†é–‹ç™¼å·¥å…·çš„ VMï¼Œå®ƒæä¾› 5GB çš„ home ç›®éŒ„ï¼Œä¸¦åœ¨ Google Cloud ä¸ŠåŸ·è¡Œã€‚å¯ç”¨ Google Cloud Shell æä¾›çš„ command-line ä¾†å­˜å– GCP çš„è³‡æºã€‚</p><ol><li>åœ¨ GCP console çš„å³ä¸Šæ–¹å·¥å…·åˆ—ä¸­ï¼Œé»æ“Šã€ŒActivate Cloud Shellã€æŒ‰éˆ•ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-42.png" alt=""></p><ol start="2"><li>åœ¨æ‰“é–‹çš„å°è©±æ¡†å…§ï¼Œé»æ“Šã€ŒSTART CLOUD SHELLã€ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-25-23.png" alt=""></p><ol start="3"><li>é€£æ¥å’Œæä¾›ç’°å¢ƒéœ€è¦ä¸€äº›æ™‚é–“ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-26-05.png" alt=""></p><ol start="4"><li>é€£æ¥å¾Œï¼Œå°±ä»£è¡¨ä½ å·²ç¶“éèº«ä»½é©—è­‰ï¼Œå°ˆæ¡ˆå·²è¨­ç½®ç‚º <code>PROJECT_ID</code>ï¼Œä»¥ä¸‹åœ–çš„ç‚ºä¾‹ï¼Œæ­¤å°ˆæ¡ˆçš„ ID ç‚º <code>qwiklabs-gcp-f9d61ede8167e6b0</code>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-26-34.png" alt=""></p><p><code>gcloud</code> æ˜¯ GCP çš„ command-line å·¥å…·ï¼Œä»–å·²é å…ˆå®‰è£åœ¨ Cloud Shell ä¸Šï¼Œä¸¦ä¸”æ”¯æ´ tab è‡ªå‹•è£œé½Š (tab-completion)ã€‚</p><p>ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤å¯åˆ—å‡ºæœ‰æ•ˆå¸³è™Ÿåç¨±ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud auth list</span><br>          Credentialed Accounts<br>ACTIVE  ACCOUNT<br>*       google3043863_student@qwiklabs.net<br><br>To set the active account, run:<br>    $ gcloud config set account `ACCOUNT`<br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤åˆ—å‡ºå°ˆæ¡ˆ IDï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud config list project</span><br>[core]<br>project = qwiklabs-gcp-f9d61ede8167e6b0<br><br>Your active configuration is: [cloudshell-9292]<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/sdk/gcloud/" target="_blank" rel="noopener">Google Cloud gcloud Overview</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="è¨­å®šé è¨­çš„-compute-zone"><a class="header-anchor" href="#è¨­å®šé è¨­çš„-compute-zone"></a>è¨­å®šé è¨­çš„ compute zone</h2><p><a href="https://cloud.google.com/compute/docs/regions-zones/#available" target="_blank" rel="noopener">compute zone</a> æ˜¯ä½ çš„å¢é›†åŠå…¶è³‡æºæ‰€åœ¨çš„å¤§æ¦‚å€åŸŸä½ç½®ï¼Œä¾‹å¦‚ï¼š<code>us-central1-a</code> æ˜¯ <code>us-central1</code> region ä¸­çš„ä¸€å€‹ zoneã€‚</p><p>åœ¨ Cloud Shell ä¸­å•Ÿç”¨æ–°çš„ session ä¸¦åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼Œå°‡é è¨­ compute zone è¨­ç‚º <code>us-central1-a</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud config <span class="hljs-built_in">set</span> compute/zone us-central1<span class="hljs-_">-a</span></span><br>Updated property [compute/zone].<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/managing-clusters#before_you_begin" target="_blank" rel="noopener">Managing clusters</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="å»ºç«‹-gke-å¢é›†"><a class="header-anchor" href="#å»ºç«‹-gke-å¢é›†"></a>å»ºç«‹ GKE å¢é›†</h2><p>ä¸€å€‹<a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-architecture" target="_blank" rel="noopener">å¢é›†</a>åŒ…å«è‡³å°‘ä¸€å€‹å¢é›†ä¸»è¦ (master) æ©Ÿå™¨å’Œå¤šå€‹ç¨±ç‚º node çš„å·¥ä½œ (worker) æ©Ÿå™¨çµ„æˆã€‚node æ˜¯ <a href="https://cloud.google.com/compute/docs/instances/" target="_blank" rel="noopener">Google Compute Engine (GCE) çš„ VM instance</a>ï¼ŒåŸ·è¡Œ Kubernetes çš„å¿…è¦ç¨‹åº (process)ï¼Œä½¿å®ƒå€‘æˆç‚ºå¢é›†çš„ä¸€éƒ¨åˆ†ã€‚</p><p>è‹¥è¦å»ºç«‹å¢é›†ï¼Œè«‹åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼Œä¸¦å°‡ <code>[CLUSTER-NAME]</code> æ›¿æ›ç‚ºè‡ªè¨‚çš„å¢é›†åç¨± (ä¾‹å¦‚ï¼š<code>my-cluster</code> )ã€‚å¢é›†åç¨±å¿…é ˆä»¥å­—æ¯é–‹é ­ï¼Œçµå°¾å¿…é ˆæ˜¯å­—æ¯æˆ–æ•¸å­—ï¼Œä¸”ä¸èƒ½è¶…é 40 å€‹å­—å…ƒã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud container clusters create [CLUSTER-NAME]</span><br></code></pre></td></tr></table></figure><p>ä½ å¯ä»¥ç„¡è¦–ä¸‹é¢é€™äº›è¼¸å‡ºå…§çš„ä»»ä½•è­¦å‘Šï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">WARNING: In June 2019, node auto-upgrade will be enabled by default for newly created clusters and node pools. To disable it, use the `--no-enable-autoupgrade`flag.<br>WARNING: Starting in 1.12, new clusters will have basic authentication disabled by default. Basic authentication can be enabled (or disabled) manually using the `--[no-]enable-basic-auth` flag.<br>WARNING: Starting in 1.12, new clusters will not have a client certificate issued. You can manually enable (or disable) the issuance of the client certificate using the `--[no-]issue-client-certificate` flag.<br>WARNING: Currently VPC-native is not the default mode during cluster creation. In the future, this will become the default mode and can be disabled using `--no-enable-ip-alias` flag. Use `--[no-]enable-ip-alias` flag to suppress this warning.<br>WARNING: Starting in 1.12, default node pools in new clusters will have their legacy Compute Engine instance metadata endpoints disabled by default. To create a cluster with legacy instance metadata endpoints disabled in the default node pool, run `clusters create` with the flag `--metadata disable-legacy-endpoints=true`.<br>This will enable the autorepair feature for nodes. Please see https://cloud.google.com/kubernetes-engine/docs/node-auto-repair for more information on node autorepairs.<br>WARNING: Starting in Kubernetes v1.10, new clusters will no longer get compute-rw and storage-ro scopes added to what is specified in --scopes (though the latter will remain included in the default --scopes). To use these scopes, add them explicitly to --scopes. To use the new behavior, set container/new_scopes_behavior property (gcloud config set container/new_scopes_behavior true).<br></code></pre></td></tr></table></figure><p>å»ºç«‹å¢é›†å¯èƒ½éœ€è¦ä¸€äº›æ™‚é–“ï¼Œå¾ˆå¿«æ‡‰è©²æœƒçœ‹åˆ°é¡ä¼¼ä¸‹é¢çš„è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">NAME        LOCATION       MASTER_VERSION  MASTER_IP      MACHINE_TYPE   NODE_VERSION   NUM_NODES  STATUS<br>my-cluster  us-central1-a  1.11.7-gke.12   104.154.18.48  n1-standard-1  1.11.7-gke.12  3          RUNNING<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/creating-a-cluster" target="_blank" rel="noopener">Creating a cluster</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="å–å¾—å¢é›†çš„é©—è­‰æ†‘è­‰"><a class="header-anchor" href="#å–å¾—å¢é›†çš„é©—è­‰æ†‘è­‰"></a>å–å¾—å¢é›†çš„é©—è­‰æ†‘è­‰</h2><p>å»ºç«‹å¢é›†å¾Œï¼Œéœ€è¦å–å¾—é©—è­‰æ†‘è­‰ (authentication credentials) æ‰èƒ½æ“ä½œå¢é›†ã€‚</p><p>åŸ·è¡Œä¸‹é¢æŒ‡å®šä¾†å°å¢é›†é€²è¡Œé©—è­‰ï¼Œå°‡ <code>[CLUSTER-NAME]</code> æ›¿æ›æˆå¢é›†åæˆï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud container clusters get-credentials [CLUSTER-NAME]</span><br></code></pre></td></tr></table></figure><p>è¼¸å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">Fetching cluster endpoint and auth data.<br>kubeconfig entry generated for my-cluster.<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl" target="_blank" rel="noopener">Cluster access for kubectl</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="å°‡æ‡‰ç”¨éƒ¨ç½²è‡³å¢é›†"><a class="header-anchor" href="#å°‡æ‡‰ç”¨éƒ¨ç½²è‡³å¢é›†"></a>å°‡æ‡‰ç”¨éƒ¨ç½²è‡³å¢é›†</h2><p>ç¾åœ¨ä½ å·²ç¶“å»ºç«‹äº†ä¸€å€‹å¢é›†ï¼Œå¯ä»¥å°‡<a href="https://cloud.google.com/kubernetes-engine/docs/concepts/kubernetes-engine-overview" target="_blank" rel="noopener">å®¹å™¨åŒ–æ‡‰ç”¨ç¨‹å¼</a>éƒ¨ç½²åˆ°è©²å¢é›†ã€‚åœ¨æ­¤ lab ä¸­ï¼Œä½ å°‡åœ¨å¢é›†ä¸­åŸ·è¡Œ <code>hello-app</code>ã€‚</p><p>GKE ä½¿ç”¨ Kubernetes ç‰©ä»¶ä¾†å»ºç«‹å’Œç®¡ç†å¢é›†çš„è³‡æºã€‚Kubernetes æä¾› <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/" target="_blank" rel="noopener">Deployment</a> ç‰©ä»¶ä¾†éƒ¨ç½² stateless çš„æ‡‰ç”¨ï¼Œä¾‹å¦‚ï¼šweb serverã€‚<a href="https://kubernetes.io/docs/concepts/services-networking/service/" target="_blank" rel="noopener">Service</a> ç‰©ä»¶å®šç¾©äº†å¾ç¶²éš›ç¶²è·¯ä¸Šå­˜å–æ‡‰ç”¨ç¨‹å¼çš„è¦å‰‡å’Œè² è¼‰å¹³è¡¡ã€‚</p><p>åœ¨ Cloud Shell ä¸­åŸ·è¡Œä¸‹é¢çš„ <a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#run" target="_blank" rel="noopener"><code>kubectl run</code></a> æŒ‡ä»¤ï¼Œå¾ <code>hello-app</code> å®¹å™¨ image å»ºç«‹æ–°çš„åç‚º <code>hello-server</code> çš„ <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/" target="_blank" rel="noopener">Deployment</a>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> kubectl run hello-server --image=gcr.io/google-samples/hello-app:1.0 --port 8080</span><br>deployment.apps "hello-server" created<br></code></pre></td></tr></table></figure><blockquote><p>æˆ‘åœ¨ Github ä¸Šé¢æ‰¾åˆ° <code>hello-app</code> image çš„å°ˆæ¡ˆåŸå§‹ç¢¼ï¼š<a href="https://github.com/GoogleCloudPlatform/kubernetes-engine-samples/tree/master/hello-app" target="_blank" rel="noopener">GoogleCloudPlatform/kubernetes-engine-samples</a></p></blockquote><blockquote><p>å¦‚æœæƒ³åœ¨è‡ªå·±çš„å°ˆæ¡ˆä¸Šä½¿ç”¨è‡ªå·±å»ºç½®çš„å®¹å™¨ imageï¼Œä¸¦å°‡æ­¤ image çš„æ‡‰ç”¨éƒ¨ç½²è‡³ GKEï¼Œå¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/kubernetes-engine/docs/tutorials/hello-app" target="_blank" rel="noopener">Deploying a containerized web application</a> æ–‡ä»¶ã€‚</p></blockquote><p>æ­¤ Kubernetes æŒ‡ä»¤å»ºç«‹ä¸€å€‹ä»£è¡¨ <code>hello-app</code> çš„ Deployment ç‰©ä»¶ã€‚åœ¨æ­¤æŒ‡ä»¤ä¸­ï¼š</p><ul><li><code>--image</code>ï¼šæŒ‡å®šè¦éƒ¨ç½²çš„å®¹å™¨ imageã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œè©²æŒ‡ä»¤å¾ <a href="https://cloud.google.com/container-registry/docs" target="_blank" rel="noopener">Google Container Registry</a> bucket ä¸­ pull ç¯„ä¾‹ imageã€‚<code>gcr.io/google-samples/hello-app:1.0</code> ä»£è¡¨é€™å€‹æŒ‡ä»¤è¦ pull çš„ç‰¹å®š image ç‰ˆæœ¬ã€‚å¦‚æœæœªæŒ‡å®šç‰ˆæœ¬ï¼Œæœƒä½¿ç”¨æœ€æ–°ç‰ˆ</li><li><code>--port</code>ï¼šæŒ‡å®šå®¹å™¨è¦å…¬é–‹çš„ port</li></ul><h2 id="å°‡æ‡‰ç”¨å…¬é–‹ç™¼ä½ˆåˆ°ç¶²éš›ç¶²è·¯"><a class="header-anchor" href="#å°‡æ‡‰ç”¨å…¬é–‹ç™¼ä½ˆåˆ°ç¶²éš›ç¶²è·¯"></a>å°‡æ‡‰ç”¨å…¬é–‹ç™¼ä½ˆåˆ°ç¶²éš›ç¶²è·¯</h2><p>æ ¹æ“šé è¨­ï¼Œåœ¨ GKE ä¸ŠåŸ·è¡Œçš„å®¹å™¨ç„¡æ³•å¾ç¶²éš›ç¶²è·¯å­˜å–ï¼Œå› ç‚ºé€™äº›å®¹å™¨æ²’æœ‰å¤–éƒ¨ IP ä½å€ã€‚æ‰€ä»¥ä½ å¿…é ˆåŸ·è¡Œ <a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#expose" target="_blank" rel="noopener"><code>kubectl expose</code></a> é€™å€‹æŒ‡ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> kubectl expose deployment hello-server --<span class="hljs-built_in">type</span>=<span class="hljs-string">"LoadBalancer"</span></span><br>service/hello-server exposed<br></code></pre></td></tr></table></figure><p>æ­¤æŒ‡ä»¤æœƒå»ºç«‹ä¸€å€‹ Kubernetes Serviceï¼Œå®ƒæ˜¯ä¸€å€‹ Kubernetes è³‡æºã€‚GKE æœƒç‚ºæ‡‰ç”¨ç¨‹å¼å»ºç«‹å¤–éƒ¨ IPï¼Œæ˜ç¢ºåœ°å°‡æ‡‰ç”¨ç¨‹åºå…¬é–‹çµ¦ä¾†è‡ªç¶²éš›ç¶²è·¯çš„æµé‡ (å¤–éƒ¨æµé‡)ã€‚åŠ ä¸Š <code>type=&quot;LoadBalancer&quot;</code> åƒæ•¸æœƒç‚ºå®¹å™¨å»ºç«‹ä¸€å€‹ GCE çš„ Load Balancer (åœ¨è‡ªå·±çš„å°ˆæ¡ˆä¸Šä½¿ç”¨<a href="https://cloud.google.com/compute/pricing#lb" target="_blank" rel="noopener">éœ€è¦è¨ˆè²»</a>)ã€‚</p><p>GKE æœƒå°‡å¤–éƒ¨ IP ä½å€æŒ‡æ´¾çµ¦ Service è³‡æºï¼Œè€Œä¸æ˜¯æŒ‡æ´¾çµ¦ Deploymentã€‚å¦‚æœä½ æƒ³è¦æ‰¾å‡º GKE ç‚ºæ‡‰ç”¨ç¨‹å¼ä½ˆå»º (provisioned) çš„å¤–éƒ¨ IPï¼Œå¯åŸ·è¡Œ <a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#get" target="_blank" rel="noopener"><code>kubectl get service</code></a> ä¾†æª¢æŸ¥ <code>hello-server</code> Serviceï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> kubectl get service hello-server</span><br></code></pre></td></tr></table></figure><div class="info"><p>ç”¢ç”Ÿå¤–éƒ¨ IP ä½å€å¯èƒ½éœ€è¦ä¸€åˆ†é˜ã€‚å¦‚æœ <code>EXTERNAL-IP</code> æ¬„ä½é¡¯ç¤ºç‚º <code>pending</code> ç‹€æ…‹æ™‚ (å¦‚ä¸‹)ï¼Œè«‹ç­‰å¾…ä¸€æ®µæ™‚é–“å¾Œï¼Œå†æ¬¡åŸ·è¡Œä¸Šé¢çš„æŒ‡ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">NAME           TYPE           CLUSTER-IP     EXTERNAL-IP   PORT(S)          AGE<br>hello-server   LoadBalancer   10.39.249.21   &lt;pending&gt;     8080:31693/TCP   51s<br></code></pre></td></tr></table></figure></div><p>ç¢ºèªæ‡‰ç”¨ç¨‹å¼çš„å¤–éƒ¨ IP ä½å€å¾Œ ( <code>EXTERNAL-IP</code> æ¬„ä½æä¾›çš„ IP)ï¼Œè«‹è¤‡è£½æ­¤ IP ä½å€ï¼Œä»¥ä¸‹é¢çš„è¼¸å‡ºç¯„ä¾‹ä¾†èªªï¼Œè¦è¤‡è£½çš„ Service å¤–éƒ¨ IP ä½å€å°±æ˜¯ <code>35.222.35.96</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">NAME           TYPE           CLUSTER-IP     EXTERNAL-IP    PORT(S)          AGE<br>hello-server   LoadBalancer   10.39.249.21   35.222.35.96   8080:31693/TCP   1m<br></code></pre></td></tr></table></figure><p>æ¥è‘—å°‡å‰›å‰›è¤‡è£½çš„å¤–éƒ¨ IP ä½å€ï¼ŒåŠ ä¸Šå…¬é–‹çš„ portï¼Œç¶²å€æ ¼å¼å°±æœƒåƒä¸‹é¢é€™æ¨£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">http://[EXTERNAL-IP]:8080<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ç€è¦½å™¨é–‹å•Ÿæ­¤ç¶²å€ï¼ŒæŸ¥çœ‹æ‡‰ç”¨ç¨‹å¼æ˜¯å¦èƒ½å­˜å–ã€‚</p><p>çœ‹åˆ°çš„é é¢æ‡‰è©²æœƒåƒä¸‹åœ–é€™æ¨£ï¼š</p><p><img src="../images/getting-started-with-google-k8s-engine/2019-04-18-23-26-18.png" alt=""></p><h2 id="æ¸…é™¤"><a class="header-anchor" href="#æ¸…é™¤"></a>æ¸…é™¤</h2><p>åŸ·è¡Œä¸‹é¢çš„æŒ‡ä»¤ä¾†åˆªé™¤ Serviceï¼Œæ­¤æ­¥é©Ÿå°‡å–æ¶ˆåˆ†é…ç‚ºä½ çš„ Service æ‰€å»ºç«‹çš„ Cloud Load Balancerï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> kubectl delete service hello-server</span><br></code></pre></td></tr></table></figure><p>åŸ·è¡Œä¸‹é¢çš„æŒ‡ä»¤ä¾†åˆªé™¤å®¹å™¨å¢é›†ï¼Œæ­¤æ­¥é©Ÿæœƒä¸€ä½µåˆªé™¤å®¹å™¨å¢é›†çš„çµ„æˆè³‡æºï¼Œä¾‹å¦‚ï¼šé‹ç®—åŸ·è¡Œå€‹é«”ã€ç£ç¢Ÿå’Œç¶²è·¯è³‡æºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud container clusters delete [CLUSTER-NAME]</span><br>The following clusters will be deleted.<br> - [my-cluster] in [us-central1-a]<br><br>Do you want to continue (Y/n)?<br></code></pre></td></tr></table></figure><p>ç•¶å‡ºç¾æç¤ºæ™‚ï¼Œè¼¸å…¥ <code>Y</code> é€²è¡Œç¢ºèªã€‚åˆªé™¤å¢é›†å¯èƒ½éœ€è¦ä¸€äº›æ™‚é–“ã€‚åˆªé™¤å¢é›†å¾Œçš„è¼¸å‡ºæœƒåƒä¸‹é¢é€™æ¨£ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">The following clusters will be deleted.<br> - [my-cluster] in [us-central1-a]<br><br>Do you want to continue (Y/n)?  y<br><br>Deleting cluster my-cluster...done.<br>Deleted [https://container.googleapis.com/v1/projects/qwiklabs-gcp-deb218c6553ee39c/zones/us-central1-a/clusters/my-cluster].<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯æŸ¥çœ‹å®˜æ–¹çš„ <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/deleting-a-cluster" target="_blank" rel="noopener">Deleting a cluster |Â Google Kubernetes Engine</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="åƒè€ƒä¾†æº"><a class="header-anchor" href="#åƒè€ƒä¾†æº"></a>åƒè€ƒä¾†æº</h2><ul><li><a href="https://www.qwiklabs.com/focuses/878?parent=catalog" target="_blank" rel="noopener">Kubernetes Engine: Qwik Start | Qwiklabs</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/gke.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ&lt;a href=&quot;https://www.qwiklabs.com/focuses/878?parent=catalog&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Kubernetes Engine: Qwik Start&lt;/a&gt;ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•é€é GKE å»ºç«‹å®¹å™¨å’Œéƒ¨ç½²å®¹å™¨åŒ–æ‡‰ç”¨ç¨‹å¼ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Cloud" scheme="https://titangene.github.io/categories/cloud/"/>
    
    
      <category term="Container" scheme="https://titangene.github.io/tags/container/"/>
    
      <category term="GCP" scheme="https://titangene.github.io/tags/gcp/"/>
    
      <category term="Load Balancer" scheme="https://titangene.github.io/tags/load-balancer/"/>
    
      <category term="Kubernetes" scheme="https://titangene.github.io/tags/kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>Google Cloud Shell å…¥é–€ï¼šgcloud &amp; gsutil</title>
    <link href="https://titangene.github.io/article/getting-started-with-cloud-shell-gcloud-and-gsutil.html"/>
    <id>https://titangene.github.io/article/getting-started-with-cloud-shell-gcloud-and-gsutil.html</id>
    <published>2019-04-17T08:56:38.000Z</published>
    <updated>2019-04-17T08:56:02.565Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/gcp.jpg" alt=""></p><p>æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ<a href="https://www.qwiklabs.com/focuses/563?parent=catalog" target="_blank" rel="noopener">Getting Started with Cloud Shell &amp; gcloud</a>ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•ä½¿ç”¨ <code>gcloud</code> æŒ‡ä»¤ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ <code>gsutil</code> å·¥å…·ä¾†ç®¡ç† Cloud Storage è³‡æºï¼Œå°‡æª”æ¡ˆä¸Šå‚³è‡³æŒ‡å®šçš„ bucketã€‚</p><a id="more"></a><p><img src="../images/getting-started-with-cloud-shell-gcloud-and-gsutil/2019-04-16-01-56-04.png" alt=""></p><p>Google Cloud Shell ç‚ºä½ æä¾› <code>gcloud</code> command-line å­˜å– GCP ä¸Šè¨—ç®¡çš„é‹ç®—è³‡æºã€‚Cloud Shell æ˜¯åŸºæ–¼ Debian çš„ VMï¼Œå…·æœ‰ 5 GB persistent disk çš„ home ç›®éŒ„ï¼Œè®“ä½ å¯ä»¥è¼•é¬†ç®¡ç† GCP å°ˆæ¡ˆå’Œè³‡æºã€‚ä½ éœ€è¦çš„ Cloud SDK <code>gcloud</code> å’Œå…¶ä»–å·¥å…·éƒ½å·²é è£åœ¨ Cloud Shell ä¸­ï¼Œè®“ä½ å¯ä»¥å¿«é€Ÿå•Ÿå‹•å’ŒåŸ·è¡Œã€‚</p><blockquote><p>è‹¥æƒ³äº†è§£å¦‚ä½• <a href="./gcp-vm-nignx-web-server.html">åœ¨ GCP ä¸Šå»ºç«‹ VM æ¶è¨­ NIGNX Web server</a> å¯åƒè€ƒæ­¤ç¯‡ã€‚<br>è‹¥æƒ³äº†è§£å¦‚ä½• <a href="./gcp-vm-windows-server.html">åœ¨ GCP ä¸Šå»ºç«‹ VM æ¶è¨­ Windows Server</a> å¯åƒè€ƒæ­¤ç¯‡ã€‚</p></blockquote><h2 id="æº–å‚™"><a class="header-anchor" href="#æº–å‚™"></a>æº–å‚™</h2><p>åœ¨é»æ“Šã€ŒStart Labã€ä¹‹å‰ï¼Œæº–å‚™å¥½ç¶²è·¯ç€è¦½å™¨ (æ¨è–¦ç”¨ Google Chrome)ï¼Œä¸¦ä¸”è‡³å°‘ 40 åˆ†é˜å¯ä»¥å°ˆæ³¨çš„æ™‚é–“ï¼Œå› ç‚º lab æ˜¯æœ‰æ™‚é–“é™åˆ¶ï¼Œç•¶ä½ æŒ‰ä¸‹ã€ŒStart Labã€é–‹å§‹å­¸ç¿’æ™‚ï¼Œç„¡æ³•æš«åœå€’æ•¸è¨ˆæ™‚ï¼Œä½ åªèƒ½åœ¨é€™æ®µæ™‚é–“å…§ä½¿ç”¨ lab æä¾›çµ¦ä½ çš„å…¨æ–°æš«æ™‚ GCP Console å¯ç”¨å¸³è™Ÿï¼Œæ™‚é–“åˆ°ä¹‹å¾Œçš„å¹¾åˆ†é˜å°±æœƒè‡ªå‹•ç™»å‡ºã€‚</p><div class="warning"><p>æ³¨æ„ï¼šå¦‚æœä½ æœ‰è‡ªå·±çš„å€‹äºº GCP å¸³è™Ÿæˆ–å°ˆæ¡ˆï¼Œè«‹ä¸è¦åœ¨æ­¤ lab ä½¿ç”¨</p></div><h2 id="é–‹å§‹ä½ çš„-lab-ç„¶å¾Œç™»å…¥-gcp-console"><a class="header-anchor" href="#é–‹å§‹ä½ çš„-lab-ç„¶å¾Œç™»å…¥-gcp-console"></a>é–‹å§‹ä½ çš„ Labï¼Œç„¶å¾Œç™»å…¥ GCP Console</h2><ol><li>å¦‚æœæº–å‚™è¦é–‹å§‹ï¼Œå¯ä»¥é»æ“Šå³ä¸Šè§’çš„ã€ŒStart Labã€é–‹å§‹ï¼š</li></ol><p><img src="../images/getting-started-with-cloud-shell-gcloud-and-gsutil/2019-04-16-00-25-52.png" alt=""></p><ol start="2"><li>æ¥è‘—æœƒå‡ºç¾é€™å€‹ç•«é¢ï¼Œå› ç‚ºæˆ‘åƒåŠ  <a href="https://www.facebook.com/events/2005848903055499/" target="_blank" rel="noopener">GDG Tainan</a> çš„æ´»å‹•ï¼Œæ´»å‹•æœ‰æä¾› Qwiklabs ä¸€å€‹æœˆçš„å…è²»é¡åº¦ï¼Œæ‰€ä»¥æˆ‘é»é¸ä¸‹åœ–å·¦é‚Šçš„ã€ŒUse Subscriptionã€ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-21-15.png" alt=""></p><ol start="3"><li>Lab æœƒæä¾›çµ¦ä½ å…è²»æš«æ™‚çš„ GCP å¸³è™Ÿï¼Œè¤‡è£½å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œç„¶å¾Œé»æ“Šã€ŒOpen Google Consoleã€é–‹å•Ÿ <a href="https://cloud.google.com/storage/docs/cloud-console" target="_blank" rel="noopener">GCP Console</a>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-15-33-31.png" alt=""></p><p>åœ–ç‰‡ä¾†æºï¼š<a href="https://www.qwiklabs.com/focuses/3563?parent=catalog" target="_blank" rel="noopener">Creating a Virtual Machine | Qwiklabs</a></p><ol start="4"><li>æ¥è‘—å°±æœƒé–‹å•Ÿç™»å…¥é é¢ï¼Œå»ºè­°å¦å¤–é–‹ Chrome ç„¡ç—•æ¨¡å¼ä¾†ç™»å…¥ lab æä¾›çš„å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œå› ç‚º Chrome æœƒç´€éŒ„å¸³å¯†ï¼Œç¾åœ¨ç™»å…¥çš„åªæ˜¯æš«æ™‚å¸³è™Ÿï¼Œæœªä¾†ä¸éœ€è¦ç”¨åˆ°ï¼š</li></ol><div class="warning"><p>æ³¨æ„ï¼šé€™é‚Šæ˜¯ç™»å…¥ lab æä¾›çš„å¸³è™Ÿ (ä¹Ÿå°±æ˜¯ email å¿…é ˆç‚º <code>googlexxxxxx_student@qwiklabs.net</code> )ï¼Œå¦‚æœä½ æœ‰è‡ªå·±çš„ GCP å¸³è™Ÿï¼Œè«‹ä¸è¦ç”¨æ–¼æ­¤ labï¼Œé¿å…ç”¢ç”Ÿè²»ç”¨</p><blockquote><p>é¡ä¼¼æ–¼ <code>googlexxxxxx_student@qwiklabs.net</code> çš„å¸³è™Ÿæ˜¯ä¸€å€‹ Google å¸³è™Ÿï¼Œå°ˆç‚º Qwiklabs å­¸ç”Ÿä½¿ç”¨è€Œå»ºç«‹çš„ã€‚å®ƒå…·æœ‰ç‰¹å®šçš„åŸŸå (ä¹Ÿå°±æ˜¯ <code>qwiklabs.net</code> )ï¼Œä¸¦ä¸”å·²åˆ†é…äº† IAM è§’è‰²ï¼Œå…è¨±ä½ å»å­˜å–è©² GCP å°ˆæ¡ˆã€‚</p></blockquote></div><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-30.png" alt=""></p><ol start="5"><li>æ¥å— terms å’Œ conditionsï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-59.png" alt=""></p><ol start="6"><li>ä¸è¦æ–°å¢ recovery options æˆ– two-factor authentication (å› ç‚ºé€™æ˜¯ä¸€å€‹è‡¨æ™‚å¸³è™Ÿ)ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-23-18.png" alt=""></p><ol start="7"><li>å‹¾é¸åŒæ„æœå‹™æ¢æ¬¾ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-15.png" alt=""></p><p>ä¹‹å¾Œå°±å¯ä»¥é–‹å§‹ä½¿ç”¨ GCP Console å›‰ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-14-14-23-55.png" alt=""></p><h2 id="å•Ÿå‹•-google-cloud-shell"><a class="header-anchor" href="#å•Ÿå‹•-google-cloud-shell"></a>å•Ÿå‹• Google Cloud Shell</h2><p>Google Cloud Shell æ˜¯è¼‰å…¥äº†é–‹ç™¼å·¥å…·çš„ VMï¼Œå®ƒæä¾› 5GB çš„ home ç›®éŒ„ï¼Œä¸¦åœ¨ Google Cloud ä¸ŠåŸ·è¡Œã€‚å¯ç”¨ Google Cloud Shell æä¾›çš„ command-line ä¾†å­˜å– GCP çš„è³‡æºã€‚</p><ol><li>åœ¨ GCP console çš„å³ä¸Šæ–¹å·¥å…·åˆ—ä¸­ï¼Œé»æ“Šã€ŒActivate Cloud Shellã€æŒ‰éˆ•ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-42.png" alt=""></p><ol start="2"><li>åœ¨æ‰“é–‹çš„å°è©±æ¡†å…§ï¼Œé»æ“Šã€ŒSTART CLOUD SHELLã€ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-25-23.png" alt=""></p><ol start="3"><li>é€£æ¥å’Œæä¾›ç’°å¢ƒéœ€è¦ä¸€äº›æ™‚é–“ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-26-05.png" alt=""></p><ol start="4"><li>é€£æ¥å¾Œï¼Œå°±ä»£è¡¨ä½ å·²ç¶“éèº«ä»½é©—è­‰ï¼Œå°ˆæ¡ˆå·²è¨­ç½®ç‚º <code>PROJECT_ID</code>ï¼Œä»¥ä¸‹åœ–çš„ç‚ºä¾‹ï¼Œæ­¤å°ˆæ¡ˆçš„ ID ç‚º <code>qwiklabs-gcp-f9d61ede8167e6b0</code>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-26-34.png" alt=""></p><p><code>gcloud</code> æ˜¯ GCP çš„ command-line å·¥å…·ï¼Œä»–å·²é å…ˆå®‰è£åœ¨ Cloud Shell ä¸Šï¼Œä¸¦ä¸”æ”¯æ´ tab è‡ªå‹•è£œé½Š (tab-completion)ã€‚</p><p>ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤å¯åˆ—å‡ºæœ‰æ•ˆå¸³è™Ÿåç¨±ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud auth list<br>          Credentialed Accounts<br>ACTIVE  ACCOUNT<br>*       google3043863_student@qwiklabs.net<br><br>To set the active account, run:<br>    $ gcloud config set account `ACCOUNT`<br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤åˆ—å‡ºå°ˆæ¡ˆ IDï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud config list project<br>[core]<br>project = qwiklabs-gcp-f9d61ede8167e6b0<br><br>Your active configuration is: [cloudshell-9292]<br></code></pre></td></tr></table></figure><h2 id="ç†è§£-regions-å’Œ-zones"><a class="header-anchor" href="#ç†è§£-regions-å’Œ-zones"></a>ç†è§£ Regions å’Œ Zones</h2><p>Compute Engine è³‡æºä½æ–¼ä¸åŒçš„ regions (åœ°å€) æˆ– zones (å€åŸŸ)ã€‚region æ˜¯ä½ å¯ä»¥åŸ·è¡Œè³‡æºçš„æ‰€åœ¨ç‰¹å®šåœ°ç†ä½ç½®ã€‚æ¯å€‹ region éƒ½æœ‰ä¸€å€‹æˆ–å¤šå€‹ zonesã€‚ä¾‹å¦‚ï¼Œ<code>us-central1</code> region ä»£è¡¨ç¾åœ‹ä¸­éƒ¨åœ°å€ï¼Œå…¶ä¸­åŒ…å«çš„ Zones æœ‰ <code>us-central1-a</code>ã€<code>us-central1-b</code>ã€<code>us-central1-c</code> èˆ‡ <code>us-central1-f</code>ã€‚</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-17-58-23.png" alt=""></p><p>åœ–ç‰‡ä¾†æºï¼š<a href="https://www.qwiklabs.com/focuses/3563?parent=catalog" target="_blank" rel="noopener">Creating a Virtual Machine | Qwiklabs</a></p><p>ä½æ–¼ zone ä¸­çš„è³‡æºéƒ½ç¨±ç‚º zonel (å€åŸŸ) è³‡æºï¼ŒVM instance (å¯¦ä¾‹) å’Œ persistent disk (æ°¸ä¹…ç£ç¢Ÿ) éƒ½ä½æ–¼ zone ä¸­ï¼Œå¦‚æœè¦å°‡ persistent disk é™„åŠ åˆ° VM instanceï¼Œé€™å…©å€‹è³‡æºéƒ½å¿…é ˆä½æ–¼åŒä¸€å€‹ zone ä¸­ã€‚åŒæ¨£ï¼Œå¦‚æœè¦å°‡éœæ…‹ IP ä½å€åˆ†é…åˆ° instanceï¼Œæ­¤ instance å°±å¿…é ˆèˆ‡éœæ…‹ IP ä½æ–¼åŒä¸€å€‹ region ä¸­ã€‚</p><blockquote><p>è©³æƒ…å¯åƒè€ƒ GCP å®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/regions-zones/" target="_blank" rel="noopener">Regions &amp; Zones</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="ä½¿ç”¨-command-line"><a class="header-anchor" href="#ä½¿ç”¨-command-line"></a>ä½¿ç”¨ command line</h2><p>åœ¨ GCP console çš„å³ä¸Šæ–¹å·¥å…·åˆ—ä¸­ï¼Œé»æ“Šã€ŒActivate Cloud Shellã€æŒ‰éˆ•é–‹å•Ÿæ–°çš„ Cloud Shell sessionï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-42.png" alt=""></p><p>å•Ÿç”¨ Cloud Shell å¾Œï¼Œä½ å¯ä»¥ä½¿ç”¨ command line invoke Cloud SDK <code>gcloud</code> æŒ‡ä»¤æˆ– VM instance ä¸Šå¯ç”¨çš„å…¶ä»–å·¥å…·ï¼Œé‚„å¯ä»¥åœ¨ä¸åŒå°ˆæ¡ˆå’Œ Cloud Shell session ä¹‹é–“ï¼Œå°‡è¦å­˜å–çš„æª”æ¡ˆå„²å­˜åœ¨ persistent disk storage çš„ <code>$HOME</code> ç›®éŒ„å…§ã€‚<code>$HOME</code> ç›®éŒ„æ˜¯ç§æœ‰çš„ï¼Œå…¶ä»–ä½¿ç”¨è€…ç„¡æ³•å­˜å–ã€‚</p><p>å¯ä»¥åœ¨ä»»ä½• <code>gcloud</code> æŒ‡ä»¤çš„æœ«ç«¯åŠ ä¸Š <code>-h</code> åƒæ•¸ä¾†æŸ¥çœ‹ä½¿ç”¨æŒ‡å—ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud -h<br></code></pre></td></tr></table></figure><p>åŠ ä¸Š <code>--help</code> åƒæ•¸æˆ–åŸ·è¡Œ <code>gcloud help</code> å¯ä»¥æŸ¥çœ‹æ›´è©³ç´°çš„ help å…§å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud config --help<br></code></pre></td></tr></table></figure><p>é€éæŒ‰ <code>Enter</code> æˆ–ç©ºç™½å»ºä¾†æ²å‹•ç€è¦½ help å…§å®¹ï¼ŒæŒ‰ <code>q</code> æŒ‰éµæœƒé€€å‡ºå…§å®¹ã€‚</p><p>ä¸‹é¢å…©å€‹æŒ‡ä»¤æ˜¯ä¸€æ¨£çš„æ„æ€ï¼Œéƒ½æ˜¯ç”¨ä¾†æŸ¥çœ‹è©³ç´°çš„ help å…§å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud config --help<br><span class="hljs-meta">$</span> gcloud help config<br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨ä½ çš„-home-ç›®éŒ„"><a class="header-anchor" href="#ä½¿ç”¨ä½ çš„-home-ç›®éŒ„"></a>ä½¿ç”¨ä½ çš„ home ç›®éŒ„</h2><p>ç¾åœ¨è®“æˆ‘å€‘è©¦è©¦ä½ çš„ <code>HOME</code> ç›®éŒ„ã€‚å°±ç®—å»çµ‚æ­¢å’Œé‡å•Ÿ VMï¼ŒCloud Shell <code>HOME</code> éŒ„çš„å…§å®¹éƒ½æœƒåœ¨æ‰€æœ‰ Cloud Shell session ä¹‹é–“çš„å°ˆæ¡ˆä¸­ä¿ç•™ã€‚</p><p>è®Šæ›´ç›®å‰çš„å·¥ä½œç›®éŒ„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> cd $HOME<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>vi</code> æ‰“é–‹ <code>.bashrc</code> è¨­å®šæª”ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> vi ./.bashrc<br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-gcloud-æŒ‡ä»¤"><a class="header-anchor" href="#ä½¿ç”¨-gcloud-æŒ‡ä»¤"></a>ä½¿ç”¨ gcloud æŒ‡ä»¤</h2><p>æª¢è¦–ç’°å¢ƒå…§çš„è¨­å®šåˆ—è¡¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud config list<br></code></pre></td></tr></table></figure><p>å¦‚æœè¦æª¢æŸ¥å…¶ä»–å±¬æ€§çš„è¨­å®šï¼Œè«‹åœ¨æŒ‡ä»¤å¾Œé¢åŠ ä¸Š <code>--all</code> åƒæ•¸ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud config list --all<br></code></pre></td></tr></table></figure><h2 id="ç®¡ç†-cloud-storage-è³‡æ–™"><a class="header-anchor" href="#ç®¡ç†-cloud-storage-è³‡æ–™"></a>ç®¡ç† Cloud Storage è³‡æ–™</h2><p>å¯ä»¥ä½¿ç”¨ Cloud Shell ä¸­çš„ <code>gsutil</code> å·¥å…·ä¾†ç®¡ç† Cloud Storage è³‡æºï¼ŒåŒ…æ‹¬å»ºç«‹å’Œåˆªé™¤ bucket å’Œç‰©ä»¶ã€è¤‡è£½å’Œç§»å‹•å„²å­˜è³‡æ–™ä»¥åŠç®¡ç† bucket å’Œç‰©ä»¶ ACLs (Access Control List)ã€‚<code>gsutil</code> é‚„èƒ½å°‡è³‡æ–™å‚³å…¥å’Œå‚³å‡º Cloud Shell instanceã€‚</p><p>bucket æ˜¯ç”¨æ–¼å„²å­˜è³‡æ–™çš„åŸºæœ¬å®¹å™¨ï¼Œå„²å­˜åœ¨ Cloud Storage çš„æ‰€æœ‰è³‡æ–™éƒ½å¿…é ˆæ”¾åœ¨ bucket ä¸­ã€‚ä½ å¯ä»¥ç”¨ bucket ä¾†æ•´ç†è³‡æ–™ã€æ§åˆ¶è³‡æ–™çš„å­˜å–æ¬Šï¼Œä½† bucket ä¸èƒ½åƒç›®éŒ„å’Œè³‡æ–™å¤¾å¯ä»¥å·¢ç‹€å„²å­˜ã€‚ç”±æ–¼<a href="https://cloud.google.com/storage/quotas" target="_blank" rel="noopener">å»ºç«‹å’Œåˆªé™¤ bucket æœ‰ä¸€äº›é™åˆ¶</a>ï¼Œæ‰€ä»¥ä½ è¨­è¨ˆçš„å„²å­˜æ‡‰ç”¨ç¨‹å¼æ‡‰å„˜é‡åŸ·è¡Œå¯†é›†çš„ç‰©ä»¶ä½œæ¥­å’Œç›¸å°è¼ƒå°‘çš„ bucket ä½œæ¥­ã€‚</p><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/storage/docs/key-terms#buckets" target="_blank" rel="noopener">Buckets</a>ã€<a href="https://cloud.google.com/storage/docs/creating-buckets#storage-create-bucket-gsutil" target="_blank" rel="noopener">Creating Storage Buckets</a> å’Œ <a href="https://cloud.google.com/storage/docs/access-control/lists?hl=zh-tw" target="_blank" rel="noopener">Access Control List (ACL)</a> æ–‡ä»¶ã€‚</p></blockquote><p>å˜—è©¦å»ºç«‹ Cloud Storage bucketï¼Œbucket åç¨±ä¸èƒ½é‡è¤‡ï¼Œå› æ­¤è«‹å°‡ <code>unique-name</code> æ›¿æ›ç‚ºå…¶ä»–åç¨±ï¼Œæˆ–è€… append åç¨±è®“å®ƒä¸é‡è¤‡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gsutil mb gs://unique-name<br></code></pre></td></tr></table></figure><p>åƒæˆ‘æ˜¯ä½¿ç”¨åç‚º <code>unique-name-titan</code> çš„ bucketï¼Œå‰›å¥½æ²’æœ‰é‡è¤‡ï¼Œæ‰€ä»¥æˆåŠŸå»ºç«‹äº† bucketï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gsutil mb gs://unique-name-titan<br>Creating gs://unique-name-titan/...<br></code></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨é‡è¤‡çš„ bucket åç¨±å°±æœƒå‡ºç¾é¡ä¼¼ä¸‹é¢çš„è¨Šæ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gsutil mb gs://unique-name<br>Creating gs://unique-name/...<br>ServiceException: 409 Bucket unique-name already exists.<br></code></pre></td></tr></table></figure><p>ç¾åœ¨ä¾†å»ºç«‹ä¸€äº›è³‡æ–™ï¼Œä¸Šå‚³åˆ°ä½ çš„ bucketã€‚é¦–å…ˆï¼Œå»ºç«‹ä¸€å€‹æ¸¬è©¦æª”æ¡ˆï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> vi test.dat<br></code></pre></td></tr></table></figure><p>åŠ ä¸€äº›è³‡æ–™é€²å»ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Welcome to gcloud!<br></code></pre></td></tr></table></figure><p>å­˜å„²æª”æ¡ˆï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">:wq<br></code></pre></td></tr></table></figure><p>ç¾åœ¨ï¼Œä¸Šå‚³ä¸€äº›æª”æ¡ˆåˆ°ä½ å»ºç«‹çš„ bucketï¼Œè«‹å°‡ <code>unique-name</code> å–ä»£æˆä½ çš„ storage bucketï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gsutil cp test.dat gs://unique-name<br></code></pre></td></tr></table></figure><p>å‰›å‰›æˆ‘æ˜¯ä½¿ç”¨ <code>unique-name-titan</code> çš„ bucketï¼Œæ‰€ä»¥ä¸Šå‚³æŒ‡ä»¤å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘å·²æˆåŠŸä¸Šå‚³ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gsutil cp test.dat gs://unique-name-titan<br>Copying file://test.dat [Content-Type=application/octet-stream]...<br>- [1 files][   19.0 B/   19.0 B]<br>Operation completed over 1 objects/19.0 B.<br></code></pre></td></tr></table></figure><p>å¦‚æœæ˜¯ä½¿ç”¨é‡è¤‡çš„ bucket åç¨±ä¸Šå‚³ï¼Œå°±æœƒå‡ºç¾é¡ä¼¼ä¸‹é¢çš„è¨Šæ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gsutil cp test.dat gs://unique-name<br>Copying file://test.dat [Content-Type=application/octet-stream]...<br>BadRequestException: 400 Project does not exist: 666160882299<br></code></pre></td></tr></table></figure><p>è‹¥è¦æŸ¥çœ‹ä½ çš„ bucket å’Œæª”æ¡ˆï¼Œè«‹é–‹å•Ÿå°èˆªé¸å–®ï¼Œç„¶å¾Œé¸æ“‡ã€ŒStorage &gt; Browserã€ï¼š</p><p><img src="../images/getting-started-with-cloud-shell-gcloud-and-gsutil/2019-04-16-01-52-25.png" alt=""></p><p>ç„¶å¾Œé»æ“Šä½ çš„ bucketï¼š</p><p><img src="../images/getting-started-with-cloud-shell-gcloud-and-gsutil/2019-04-16-01-53-17.png" alt=""></p><p>ä½ æ‡‰è©²æœƒçœ‹åˆ° <code>test.dat</code> é€™å€‹æª”æ¡ˆï¼š</p><p><img src="../images/getting-started-with-cloud-shell-gcloud-and-gsutil/2019-04-16-01-53-59.png" alt=""></p><h2 id="åƒè€ƒä¾†æº"><a class="header-anchor" href="#åƒè€ƒä¾†æº"></a>åƒè€ƒä¾†æº</h2><ul><li><a href="https://www.qwiklabs.com/focuses/563?parent=catalog" target="_blank" rel="noopener">Getting Started with Cloud Shell &amp; gcloud | Qwiklabs</a> (æœ¬ç¯‡å¤§å¤šæ•¸çš„åœ–ç‰‡ä¾†æº)</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/gcp.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ&lt;a href=&quot;https://www.qwiklabs.com/focuses/563?parent=catalog&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Getting Started with Cloud Shell &amp;amp; gcloud&lt;/a&gt;ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•ä½¿ç”¨ &lt;code&gt;gcloud&lt;/code&gt; æŒ‡ä»¤ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ &lt;code&gt;gsutil&lt;/code&gt; å·¥å…·ä¾†ç®¡ç† Cloud Storage è³‡æºï¼Œå°‡æª”æ¡ˆä¸Šå‚³è‡³æŒ‡å®šçš„ bucketã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Cloud" scheme="https://titangene.github.io/categories/cloud/"/>
    
    
      <category term="GCP" scheme="https://titangene.github.io/tags/gcp/"/>
    
      <category term="VM" scheme="https://titangene.github.io/tags/vm/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ GCP ä¸Šå»ºç«‹ VM æ¶è¨­ Windows Server</title>
    <link href="https://titangene.github.io/article/gcp-vm-windows-server.html"/>
    <id>https://titangene.github.io/article/gcp-vm-windows-server.html</id>
    <published>2019-04-16T13:17:46.000Z</published>
    <updated>2019-04-30T15:56:57.523Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/gcp.jpg" alt=""></p><p>æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ<a href="https://www.qwiklabs.com/focuses/560?parent=catalog" target="_blank" rel="noopener">Compute Engine: Qwik Start - Windows</a>ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•é€é GCP Console åœ¨ GCP å»ºç«‹ instance æ¶è¨­ Windows Serverï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ <a href="https://chrome.google.com/webstore/detail/chrome-rdp-for-google-clo/mpbbnannobiobpnfblimoapbephgifkm" target="_blank" rel="noopener">Chrome RDP for GCP</a> æ“´å……åŠŸèƒ½ç›´æ¥å¾ç€è¦½å™¨é€²è¡Œ RDP é€£æ¥è‡³ Windows Serverã€‚</p><a id="more"></a><p><img src="../images/gcp-vm-windows-server/2019-04-16-00-21-39.png" alt=""></p><p>Google Compute Engine å¯è®“ä½ åœ¨ Google åŸºç¤æ¶æ§‹ä¸Šå»ºç«‹å’ŒåŸ·è¡Œ VMã€‚ Compute Engine æä¾›æ“´å±•ã€æ•ˆèƒ½å’Œåƒ¹å€¼ï¼Œè®“ä½ å¯ä»¥è¼•é¬†åœ°åœ¨ Google åŸºç¤æ¶æ§‹ä¸Šå•Ÿå‹•å¤§å‹é‹ç®—ç¾¤é›†ã€‚</p><p>ä½ å¯ä»¥åœ¨ Google Compute Engine ä¸ŠåŸ·è¡Œ Windows æ‡‰ç”¨ç¨‹å¼ï¼Œä¸¦åˆ©ç”¨ VM instance å¯ç”¨çš„è¨±å¤šå„ªå‹¢ï¼Œä¾‹å¦‚ï¼šå¯é çš„<a href="https://cloud.google.com/compute/docs/disks/" target="_blank" rel="noopener">å„²å­˜é¸é …</a>ã€<a href="https://cloud.google.com/compute/docs/vpc" target="_blank" rel="noopener">Google ç¶²è·¯</a>çš„é€Ÿåº¦å’Œ<a href="https://cloud.google.com/compute/docs/autoscaler/" target="_blank" rel="noopener">è‡ªå‹•æ“´å±• (Autoscaling)</a>ã€‚</p><p>åœ¨æ­¤ lab ä¸­ï¼Œä½ å°‡å­¸ç¿’å¦‚ä½•åœ¨ Google Compute Engine ä¸­å•Ÿå‹• Windows Server instanceï¼Œä¸¦ä½¿ç”¨é ç«¯æ¡Œé¢å”å®šé€£æ¥åˆ°è©² instanceã€‚</p><blockquote><p>è‹¥æƒ³äº†è§£å¦‚ä½• <a href="./gcp-vm-nignx-web-server.html">åœ¨ GCP ä¸Šå»ºç«‹ VM æ¶è¨­ NIGNX Web server</a> å¯åƒè€ƒæ­¤ç¯‡ã€‚</p></blockquote><p>å¦‚æœä½ æœªåœ¨ local ä¸»æ©Ÿä¸Šä½¿ç”¨ Windowsï¼Œè«‹å®‰è£ç¬¬ä¸‰æ–¹çš„ RDP clientï¼Œä¾‹å¦‚ï¼šFusionLabs çš„ <a href="https://chrome.google.com/webstore/detail/chrome-rdp/cbkkbcmdlboombapidmoeolnmdacpkch" target="_blank" rel="noopener">Chrome RDP</a>ã€‚</p><h2 id="æº–å‚™"><a class="header-anchor" href="#æº–å‚™"></a>æº–å‚™</h2><p>åœ¨é»æ“Šã€ŒStart Labã€ä¹‹å‰ï¼Œæº–å‚™å¥½ç¶²è·¯ç€è¦½å™¨ (æ¨è–¦ç”¨ Google Chrome)ï¼Œä¸¦ä¸”è‡³å°‘ 40 åˆ†é˜å¯ä»¥å°ˆæ³¨çš„æ™‚é–“ï¼Œå› ç‚º lab æ˜¯æœ‰æ™‚é–“é™åˆ¶ï¼Œç•¶ä½ æŒ‰ä¸‹ã€ŒStart Labã€é–‹å§‹å­¸ç¿’æ™‚ï¼Œç„¡æ³•æš«åœå€’æ•¸è¨ˆæ™‚ï¼Œä½ åªèƒ½åœ¨é€™æ®µæ™‚é–“å…§ä½¿ç”¨ lab æä¾›çµ¦ä½ çš„å…¨æ–°æš«æ™‚ GCP Console å¯ç”¨å¸³è™Ÿï¼Œæ™‚é–“åˆ°ä¹‹å¾Œçš„å¹¾åˆ†é˜å°±æœƒè‡ªå‹•ç™»å‡ºã€‚</p><div class="warning"><p>æ³¨æ„ï¼šå¦‚æœä½ æœ‰è‡ªå·±çš„å€‹äºº GCP å¸³è™Ÿæˆ–å°ˆæ¡ˆï¼Œè«‹ä¸è¦åœ¨æ­¤ lab ä½¿ç”¨</p></div><h2 id="é–‹å§‹ä½ çš„-lab-ç„¶å¾Œç™»å…¥-gcp-console"><a class="header-anchor" href="#é–‹å§‹ä½ çš„-lab-ç„¶å¾Œç™»å…¥-gcp-console"></a>é–‹å§‹ä½ çš„ Labï¼Œç„¶å¾Œç™»å…¥ GCP Console</h2><ol><li>å¦‚æœæº–å‚™è¦é–‹å§‹ï¼Œå¯ä»¥é»æ“Šå³ä¸Šè§’çš„ã€ŒStart Labã€é–‹å§‹ï¼š</li></ol><p><img src="../images/gcp-vm-windows-server/2019-04-16-00-56-15.png" alt=""></p><ol start="2"><li>æ¥è‘—æœƒå‡ºç¾é€™å€‹ç•«é¢ï¼Œå› ç‚ºæˆ‘åƒåŠ  <a href="https://www.facebook.com/events/2005848903055499/" target="_blank" rel="noopener">GDG Tainan</a> çš„æ´»å‹•ï¼Œæ´»å‹•æœ‰æä¾› Qwiklabs ä¸€å€‹æœˆçš„å…è²»é¡åº¦ï¼Œæ‰€ä»¥æˆ‘é»é¸ä¸‹åœ–å·¦é‚Šçš„ã€ŒUse Subscriptionã€ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-21-15.png" alt=""></p><ol start="3"><li>Lab æœƒæä¾›çµ¦ä½ å…è²»æš«æ™‚çš„ GCP å¸³è™Ÿï¼Œè¤‡è£½å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œç„¶å¾Œé»æ“Šã€ŒOpen Google Consoleã€é–‹å•Ÿ <a href="https://cloud.google.com/storage/docs/cloud-console" target="_blank" rel="noopener">GCP Console</a>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-15-33-31.png" alt=""></p><p>åœ–ç‰‡ä¾†æºï¼š<a href="https://www.qwiklabs.com/focuses/3563?parent=catalog" target="_blank" rel="noopener">Creating a Virtual Machine | Qwiklabs</a></p><ol start="4"><li>æ¥è‘—å°±æœƒé–‹å•Ÿç™»å…¥é é¢ï¼Œå»ºè­°å¦å¤–é–‹ Chrome ç„¡ç—•æ¨¡å¼ä¾†ç™»å…¥ lab æä¾›çš„å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œå› ç‚º Chrome æœƒç´€éŒ„å¸³å¯†ï¼Œç¾åœ¨ç™»å…¥çš„åªæ˜¯æš«æ™‚å¸³è™Ÿï¼Œæœªä¾†ä¸éœ€è¦ç”¨åˆ°ï¼š</li></ol><div class="warning"><p>æ³¨æ„ï¼šé€™é‚Šæ˜¯ç™»å…¥ lab æä¾›çš„å¸³è™Ÿ (ä¹Ÿå°±æ˜¯ email å¿…é ˆç‚º <code>googlexxxxxx_student@qwiklabs.net</code> )ï¼Œå¦‚æœä½ æœ‰è‡ªå·±çš„ GCP å¸³è™Ÿï¼Œè«‹ä¸è¦ç”¨æ–¼æ­¤ labï¼Œé¿å…ç”¢ç”Ÿè²»ç”¨</p><blockquote><p>é¡ä¼¼æ–¼ <code>googlexxxxxx_student@qwiklabs.net</code> çš„å¸³è™Ÿæ˜¯ä¸€å€‹ Google å¸³è™Ÿï¼Œå°ˆç‚º Qwiklabs å­¸ç”Ÿä½¿ç”¨è€Œå»ºç«‹çš„ã€‚å®ƒå…·æœ‰ç‰¹å®šçš„åŸŸå (ä¹Ÿå°±æ˜¯ <code>qwiklabs.net</code> )ï¼Œä¸¦ä¸”å·²åˆ†é…äº† IAM è§’è‰²ï¼Œå…è¨±ä½ å»å­˜å–è©² GCP å°ˆæ¡ˆã€‚</p></blockquote></div><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-30.png" alt=""></p><ol start="5"><li>æ¥å— terms å’Œ conditionsï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-59.png" alt=""></p><ol start="6"><li>ä¸è¦æ–°å¢ recovery options æˆ– two-factor authentication (å› ç‚ºé€™æ˜¯ä¸€å€‹è‡¨æ™‚å¸³è™Ÿ)</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-23-18.png" alt=""></p><ol start="7"><li>å‹¾é¸åŒæ„æœå‹™æ¢æ¬¾ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-15.png" alt=""></p><p>ä¹‹å¾Œå°±å¯ä»¥é–‹å§‹ä½¿ç”¨ GCP Console å›‰ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-14-14-23-55.png" alt=""></p><h2 id="å»ºç«‹-vm-instance"><a class="header-anchor" href="#å»ºç«‹-vm-instance"></a>å»ºç«‹ VM instance</h2><p>åœ¨ GCP Console çš„å·¦ä¸Šè§’ï¼Œé»é¸ã€ŒNavigation menu &gt; Compute Engine &gt; VM Instancesã€ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-18-16-42.png" alt=""></p><p>æ¥è‘—é»æ“Šã€ŒCreateã€æŒ‰éˆ•å»ºç«‹æ–°çš„ instanceï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-31-03.png" alt=""></p><p>åœ¨ã€ŒBoot diskã€éƒ¨åˆ†ä¸­ï¼Œé»æ“Šã€ŒChangeã€æŒ‰éˆ•ä»¥é–‹å§‹é…ç½® boot diskï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-10-06.png" alt=""></p><p>é¸æ“‡ã€ŒWindows Server 2012 R2 Datacenterã€ï¼Œç„¶å¾Œé»æ“Šã€ŒSelectã€æŒ‰éˆ•ï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-38-30.png" alt=""></p><p>å°‡æ‰€æœ‰å…¶ä»–è¨­å®šéƒ½ä¿ç•™ç‚ºé è¨­å€¼ã€‚è¨­å®šå¥½ä¹‹å¾Œï¼Œé»æ“Šã€ŒCreateã€æŒ‰éˆ•å»ºç«‹ instanceï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-09-42.png" alt=""></p><h2 id="å•Ÿå‹•-google-cloud-shell"><a class="header-anchor" href="#å•Ÿå‹•-google-cloud-shell"></a>å•Ÿå‹• Google Cloud Shell</h2><p>Google Cloud Shell æ˜¯è¼‰å…¥äº†é–‹ç™¼å·¥å…·çš„ VMï¼Œå®ƒæä¾› 5GB çš„ home ç›®éŒ„ï¼Œä¸¦åœ¨ Google Cloud ä¸ŠåŸ·è¡Œã€‚å¯ç”¨ Google Cloud Shell æä¾›çš„ command-line ä¾†å­˜å– GCP çš„è³‡æºã€‚</p><ol><li>åœ¨ GCP console çš„å³ä¸Šæ–¹å·¥å…·åˆ—ä¸­ï¼Œé»æ“Šã€ŒActivate Cloud Shellã€æŒ‰éˆ•ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-42.png" alt=""></p><ol start="2"><li>åœ¨æ‰“é–‹çš„å°è©±æ¡†å…§ï¼Œé»æ“Šã€ŒSTART CLOUD SHELLã€ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-25-23.png" alt=""></p><ol start="3"><li>é€£æ¥å’Œæä¾›ç’°å¢ƒéœ€è¦ä¸€äº›æ™‚é–“ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-26-05.png" alt=""></p><ol start="4"><li>é€£æ¥å¾Œï¼Œå°±ä»£è¡¨ä½ å·²ç¶“éèº«ä»½é©—è­‰ï¼Œå°ˆæ¡ˆå·²è¨­ç½®ç‚º <code>PROJECT_ID</code>ï¼Œä»¥ä¸‹åœ–çš„ç‚ºä¾‹ï¼Œæ­¤å°ˆæ¡ˆçš„ ID ç‚º <code>qwiklabs-gcp-f9d61ede8167e6b0</code>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-26-34.png" alt=""></p><p>ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤å¯åˆ—å‡ºæœ‰æ•ˆå¸³è™Ÿåç¨±ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud auth list<br>          Credentialed Accounts<br>ACTIVE  ACCOUNT<br>*       google3043863_student@qwiklabs.net<br><br>To set the active account, run:<br>    $ gcloud config set account `ACCOUNT`<br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤åˆ—å‡ºå°ˆæ¡ˆ IDï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud config list project<br>[core]<br>project = qwiklabs-gcp-f9d61ede8167e6b0<br><br>Your active configuration is: [cloudshell-9292]<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/sdk/gcloud" target="_blank" rel="noopener">Google Cloud gcloud Overview</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="æ¸¬è©¦-windows-startup-çš„ç‹€æ…‹"><a class="header-anchor" href="#æ¸¬è©¦-windows-startup-çš„ç‹€æ…‹"></a>æ¸¬è©¦ Windows Startup çš„ç‹€æ…‹</h2><p>åœ¨ã€ŒVM Instancesã€é é¢ä¸Šçœ‹åˆ°å¸¶æœ‰ç¶ è‰²ç‹€æ…‹çš„ icon å°±ä»£è¡¨è©² instance å·²å»ºç«‹å®Œæˆï¼Œå¦‚ä¸‹åœ–ï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-40-28.png" alt=""></p><p>ä½†æ˜¯ï¼Œå®ƒå¯èƒ½å°šæœªæº–å‚™å¥½æ¥å— RDP é€£æ¥ï¼Œå› ç‚ºæ‰€æœ‰ OS å…ƒä»¶åˆå§‹åŒ–éƒ½éœ€è¦ä¸€æ®µæ™‚é–“ã€‚</p><p>è¦æŸ¥çœ‹ server æ˜¯å¦å·²æº–å‚™å¥½é€²è¡Œ RDP é€£æ¥ï¼Œè«‹åœ¨ Cloud Shell terminal command-line ä¸­åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼Œå…¶ä¸­çš„ <code>instance-1</code> æ˜¯å‰›å‰›å»ºç«‹çš„ instance åç¨±ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud compute instances get-serial-port-output instance-1 --zone us-central1-a<br></code></pre></td></tr></table></figure><p>é‡è¤‡é€™å€‹æŒ‡ä»¤ï¼Œç›´åˆ°æŒ‡ä»¤è¼¸å‡ºä»¥ä¸‹å…§å®¹ç‚ºæ­¢ã€‚é€™å€‹æŒ‡ä»¤çš„è¼¸å‡ºæœƒå‘Šè¨´ä½  OS å…ƒä»¶å·²åˆå§‹åŒ–ï¼Œä¸¦ä¸” Windows Server å·²æº–å‚™å¥½æ¥å— RDP é€£æ¥ (å˜—è©¦ä¸‹ä¸€æ­¥)ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Finished running startup scripts.<br></code></pre></td></tr></table></figure><p>é€™å€‹æŒ‡ä»¤å®Œæ•´çš„è¼¸å‡ºè¨Šæ¯æœƒé¡ä¼¼ä¸‹é¢é€™æ¨£ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud compute instances get-serial-port-output instance-1 --zone us-central1-a<br>SeaBIOS (version 1.8.2-20190322_093631-google)<br>Total RAM Size = 0x00000000f0000000 = 3840 MiB<br>CPUs found: 1     Max CPUs supported: 1<br>found virtio-scsi at 0:3<br>virtio-scsi vendor='Google' product='PersistentDisk' rev='1' type=0 removable=0<br>virtio-scsi blksize=512 sectors=104857600 = 51200 MiB<br>drive 0x000f29f0: PCHS=0/0/0 translation=lba LCHS=1024/255/63 s=104857600<br>Booting from Hard Disk 0...<br>2019/04/15 15:39:21 GCEWindowsAgent: GCE Agent Started (version 4.6.0@1)<br>2019/04/15 15:39:56 GCEInstanceSetup: Starting sysprep specialize phase.<br>2019/04/15 15:39:57 GCEInstanceSetup: All networks set to DHCP.<br>2019/04/15 15:39:57 GCEInstanceSetup: Running 'netsh' with arguments 'interface ipv4 set interface Ethernet mtu=1460'<br>2019/04/15 15:39:57 GCEInstanceSetup: --&gt; Ok.<br>2019/04/15 15:39:58 GCEInstanceSetup: MTU set to 1460.<br>2019/04/15 15:39:58 GCEInstanceSetup: Running 'route' with arguments '/p add 169.254.169.254 mask 255.255.255.255 0.0.0.0 if 12 metric 1'<br>2019/04/15 15:39:58 GCEInstanceSetup: --&gt; OK!<br>2019/04/15 15:39:58 GCEInstanceSetup: Added persistent route to metadata netblock via first netkvm adapter.<br>2019/04/15 15:39:58 GCEInstanceSetup: Getting hostname from metadata server.<br>2019/04/15 15:39:58 GCEInstanceSetup: Changing hostname from WIN-MQ2QFF14J03 to instance-1.<br>2019/04/15 15:39:58 GCEInstanceSetup: Renamed from WIN-MQ2QFF14J03 to instance-1.<br>2019/04/15 15:39:58 GCEMetadataScripts: Starting specialize scripts (version 4.2.1@1).<br>2019/04/15 15:39:58 GCEMetadataScripts: No specialize scripts to run.<br>2019/04/15 15:39:58 GCEMetadataScripts: Finished running specialize scripts.<br>2019/04/15 15:39:58 GCEInstanceSetup: Finished with sysprep specialize phase, restarting...<br>2019/04/15 15:39:59 GCEWindowsAgent: GCE Agent Stopped<br>SeaBIOS (version 1.8.2-20190322_093631-google)<br>Total RAM Size = 0x00000000f0000000 = 3840 MiB<br>CPUs found: 1     Max CPUs supported: 1<br>found virtio-scsi at 0:3<br>virtio-scsi vendor='Google' product='PersistentDisk' rev='1' type=0 removable=0<br>virtio-scsi blksize=512 sectors=104857600 = 51200 MiB<br>drive 0x000f29f0: PCHS=0/0/0 translation=lba LCHS=1024/255/63 s=104857600<br>Booting from Hard Disk 0...<br>2019/04/15 15:40:36 GCEWindowsAgent: GCE Agent Started (version 4.6.0@1)<br>2019/04/15 15:40:43 GCEInstanceSetup: Disabled Ctrl + Alt + Del.<br>2019/04/15 15:40:43 GCEInstanceSetup: Enable RDP firewall rules.<br>2019/04/15 15:40:43 GCEInstanceSetup: Running 'netsh' with arguments 'advfirewall firewall set rule group=remote desktop new enable=Yes'<br>2019/04/15 15:40:43 GCEInstanceSetup: --&gt; Updated 3 rule(s).<br>2019/04/15 15:40:43 GCEInstanceSetup: --&gt; Ok.<br>2019/04/15 15:40:43 GCEInstanceSetup: Restarting Terminal Service services, to enable RDP.<br>2019/04/15 15:40:44 GCEInstanceSetup: Enabled Remote Desktop.<br>2019/04/15 15:40:44 GCEInstanceSetup: Configuring WinRM...<br>2019/04/15 15:40:47 GCEInstanceSetup: Running 'netsh' with arguments 'advfirewall firewall add rule profile=any name=Windows Remote Management (HTTPS-In) dir=in localport=5986 protocol=TCP action=allow'<br>2019/04/15 15:40:47 GCEInstanceSetup: --&gt; Ok.<br>2019/04/15 15:40:48 GCEInstanceSetup: Setup of WinRM complete.<br>2019/04/15 15:40:48 GCEInstanceSetup: Running startup scripts from metadata server.<br>2019/04/15 15:40:48 GCEInstanceSetup: Running 'schtasks' with arguments '/run /tn GCEStartup'<br>2019/04/15 15:40:48 GCEInstanceSetup: --&gt; SUCCESS: Attempted to run the scheduled task "GCEStartup".<br>2019/04/15 15:40:48 GCEInstanceSetup: ------------------------------------------------------------<br>2019/04/15 15:40:48 GCEInstanceSetup: Instance setup finished. instance-1 is ready to use.<br>2019/04/15 15:40:48 GCEInstanceSetup: ------------------------------------------------------------<br>2019/04/15 15:40:51 GCEInstanceSetup: Checking instance license activation status.<br>2019/04/15 15:40:51 GCEInstanceSetup: instance-1 needs to be activated by a KMS Server.<br>2019/04/15 15:40:51 GCEInstanceSetup: Key Management Service machine name set to kms.windows.googlecloud.com successfully.<br>2019/04/15 15:40:51 GCEInstanceSetup: Installed product key W3GGN-FT8W3-Y4M27-J84CP-Q3VJ9 successfully.<br>2019/04/15 15:40:51 GCEInstanceSetup: Activating instance...<br>2019/04/15 15:40:52 GCEInstanceSetup: Activating Windows(R), ServerDatacenter edition (00091344-1ea4-4f37-b789-01750ba6988c) ...<br>2019/04/15 15:40:52 GCEInstanceSetup: Product activated successfully.<br>2019/04/15 15:40:52 GCEInstanceSetup: Activation successful.<br>2019/04/15 15:40:53 GCEMetadataScripts: Starting startup scripts (version 4.2.1@1).<br>2019/04/15 15:40:53 GCEMetadataScripts: No startup scripts to run.<br>2019/04/15 15:40:53 GCEMetadataScripts: Finished running startup scripts.<br><br><br>Specify --start=4643 in the next get-serial-port-output invocation to get only the new output starting from here.<br></code></pre></td></tr></table></figure><h2 id="é€£æ¥-instance"><a class="header-anchor" href="#é€£æ¥-instance"></a>é€£æ¥ instance</h2><p>é»æ“Š VM çš„åç¨±ï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-09-15.png" alt=""></p><p>åœ¨ã€ŒRemote Accessã€éƒ¨åˆ†é»æ“Šã€ŒSet Windows Passwordã€æŒ‰éˆ•ï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-11-50.png" alt=""></p><p>è¼¸å…¥ username å¾Œï¼Œé»æ“Šã€ŒSetã€æŒ‰éˆ•ä¾†ç”¢ç”Ÿæ­¤ Windows instance çš„å¯†ç¢¼ã€‚å¦‚æœæ²’æœ‰æ­¤ username çš„ Windows å¸³è™Ÿï¼Œå°±æœƒå»ºç«‹è©²å¸³è™Ÿä¸¦ä½¿ç”¨æ–°å¯†ç¢¼ï¼Œå¦‚æœå·²æœ‰æ­¤å¸³è™Ÿï¼Œå¯†ç¢¼å‰‡æœƒè¢«é‡è¨­ï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-50-21.png" alt=""></p><p>è¤‡è£½å¯†ç¢¼ä¸¦å„²å­˜ï¼Œç¨å¾Œç™»å…¥ instance æ™‚æœƒç”¨åˆ°ï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-14-07.png" alt=""></p><h2 id="ä½¿ç”¨é ç«¯æ¡Œé¢-rdp-é€²å…¥-windows-server"><a class="header-anchor" href="#ä½¿ç”¨é ç«¯æ¡Œé¢-rdp-é€²å…¥-windows-server"></a>ä½¿ç”¨é ç«¯æ¡Œé¢ (RDP) é€²å…¥ Windows Server</h2><p>å¯ä»¥ä½¿ç”¨ <a href="https://chrome.google.com/webstore/detail/chrome-rdp-for-google-clo/mpbbnannobiobpnfblimoapbephgifkm" target="_blank" rel="noopener">Chrome RDP for Google Cloud Platform</a> æ“´å……åŠŸèƒ½ç›´æ¥å¾ç€è¦½å™¨é€²è¡Œ RDP é€£æ¥ï¼Œé»æ“Šã€ŒRDPã€æŒ‰éˆ•é€²è¡Œé€£æ¥ï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-16-16.png" alt=""></p><div class="info"><p>å¦‚æœå‰›å‰›æ˜¯ç”¨ Chrome çš„ç„¡ç—•æ¨¡å¼ç™»å…¥å¸³è™Ÿï¼Œå°±æœƒç™¼ç”Ÿé»æ“Šã€ŒRDPã€æŒ‰éˆ•æ²’æœ‰åæ‡‰çš„ç‹€æ³ï¼Œæ›æˆåŸæœ¬çš„æ¨¡å¼å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p></div><p>å®ƒæœƒæç¤ºä½ å®‰è£ RDP æ“´å……åŠŸèƒ½ã€‚å®‰è£å®Œæˆå¾Œï¼ŒGCP æœƒæ‰“é–‹åƒä¸‹åœ–çš„ç™»å…¥ç•«é¢ï¼Œè«‹ä½¿ç”¨ Windows ä½¿ç”¨è€…å’Œå¯†ç¢¼ç™»å…¥ (è²¼ä¸Šä¹‹å‰å„²å­˜çš„å¯†ç¢¼)ï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-17-26.png" alt=""></p><p>é»æ“Šã€ŒContinueã€æŒ‰éˆ•ä»¥ç¢ºèªä½ è¦é€£æ¥ï¼š</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-17-54.png" alt=""></p><p>æ‰“é–‹ Server Manager æ™‚ï¼Œå°±æœƒé€£æ¥åˆ° Windows Server ä¸Šçš„ VM instanceã€‚</p><p><img src="../images/gcp-vm-windows-server/2019-04-15-23-59-49.png" alt=""></p><h2 id="ä½¿ç”¨-rdp-client-è¤‡è£½å’Œè²¼ä¸Š"><a class="header-anchor" href="#ä½¿ç”¨-rdp-client-è¤‡è£½å’Œè²¼ä¸Š"></a>ä½¿ç”¨ RDP client è¤‡è£½å’Œè²¼ä¸Š</h2><p>ç™»å…¥åˆ° instance å¾Œï¼Œå¯ä»¥æŒ‰ <code>Ctrl + V</code> è²¼ä¸Šè³‡æ–™ (å¦‚æœæ˜¯ Mac çš„ä½¿ç”¨è€…ï¼ŒæŒ‰ <code>Cmd + V</code> æœƒç„¡æ³•è²¼ä¸Šï¼‰ã€‚å¦‚æœè¦è²¼è‡³ PuTTY å’Œ Powershellï¼Œè«‹æŒ‰æ»‘é¼ å³éµå°±å¯ä»¥è²¼ä¸Šã€‚å¦‚æœåœ¨ Powershell è¦–çª—ä¸­ï¼Œè«‹ç¢ºä¿å·²é»æ“Šè©²è¦–çª—ï¼Œå¦å‰‡æœƒç„¡æ³•è²¼ä¸Šã€‚</p><h2 id="åƒè€ƒä¾†æº"><a class="header-anchor" href="#åƒè€ƒä¾†æº"></a>åƒè€ƒä¾†æº</h2><ul><li><a href="https://www.qwiklabs.com/focuses/560?parent=catalog" target="_blank" rel="noopener">Compute Engine: Qwik Start - Windows</a> (æœ¬ç¯‡å¤§å¤šæ•¸çš„åœ–ç‰‡ä¾†æº)</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/gcp.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ&lt;a href=&quot;https://www.qwiklabs.com/focuses/560?parent=catalog&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Compute Engine: Qwik Start - Windows&lt;/a&gt;ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•é€é GCP Console åœ¨ GCP å»ºç«‹ instance æ¶è¨­ Windows Serverï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ &lt;a href=&quot;https://chrome.google.com/webstore/detail/chrome-rdp-for-google-clo/mpbbnannobiobpnfblimoapbephgifkm&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Chrome RDP for GCP&lt;/a&gt; æ“´å……åŠŸèƒ½ç›´æ¥å¾ç€è¦½å™¨é€²è¡Œ RDP é€£æ¥è‡³ Windows Serverã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Windows Server" scheme="https://titangene.github.io/categories/windows-server/"/>
    
      <category term="Cloud" scheme="https://titangene.github.io/categories/windows-server/cloud/"/>
    
    
      <category term="GCP" scheme="https://titangene.github.io/tags/gcp/"/>
    
      <category term="VM" scheme="https://titangene.github.io/tags/vm/"/>
    
  </entry>
  
  <entry>
    <title>GCP (Google Cloud Platform) å…¥é–€</title>
    <link href="https://titangene.github.io/article/getting-started-with-gcp.html"/>
    <id>https://titangene.github.io/article/getting-started-with-gcp.html</id>
    <published>2019-04-15T14:20:20.000Z</published>
    <updated>2019-04-16T12:05:50.221Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/gcp.jpg" alt=""></p><p>æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ<a href="https://www.qwiklabs.com/focuses/2794?parent=catalog" target="_blank" rel="noopener">A Tour of Qwiklabs and the Google Cloud Platform</a>ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•ä½¿ç”¨ä»¥åŠèªè­˜ Qwiklab å’Œ GCPã€‚</p><a id="more"></a><p><img src="../images/getting-started-with-gcp/2019-04-15-21-49-27.png" alt=""></p><p><a href="https://cloud.google.com/" target="_blank" rel="noopener">Google Cloud Platform</a> (GCP) æ˜¯è¨—ç®¡åœ¨ Google åŸºç¤æ¶æ§‹ä¸Šçš„ä¸€å¥—é›²ç«¯æœå‹™ï¼Œå¾è¨ˆç®—å’Œå„²å­˜ï¼Œåˆ°è³‡æ–™åˆ†æã€æ©Ÿå™¨å­¸ç¿’ã€ç¶²è·¯ã€GCP æä¾›å„ç¨®æœå‹™å’Œ APIï¼Œå¯ä»¥èˆ‡ä»»ä½•é›²ç«¯è¨ˆç®—æ‡‰ç”¨ç¨‹å¼æˆ–å°ˆæ¡ˆæ•´åˆ - ç„¡è«–æ˜¯å€‹äººé‚„æ˜¯ä¼æ¥­ã€‚</p><p>åœ¨é€™å€‹å…¥é–€ç­‰ç´šçš„ lab ä¸­ï¼Œå¯é€éä½¿ç”¨ <a href="https://cloud.google.com/cloud-console/" target="_blank" rel="noopener">GCP console</a> (ç€è¦½å™¨å…§çš„ UIï¼Œå¯è®“æ‚¨å­˜å–å’Œç®¡ç† Google Cloud æœå‹™) ä¾†ç·´ç¿’ä½¿ç”¨ GCPï¼Œäº†è§£ GCP çš„ä¸»è¦åŠŸèƒ½ï¼Œå¿…äº†è§£ Qwiklabs çš„ç’°å¢ƒã€‚</p><h2 id="ä½ æœƒå­¸åˆ°ä»€éº¼"><a class="header-anchor" href="#ä½ æœƒå­¸åˆ°ä»€éº¼"></a>ä½ æœƒå­¸åˆ°ä»€éº¼</h2><ul><li>äº†è§£å¦‚ä½•ä½¿ç”¨ç‰¹å®šæ†‘è­‰å­˜å– GCP console</li><li>èªè­˜ GCP å°ˆæ¡ˆ</li><li>äº†è§£å¦‚ä½•ä½¿ç”¨ GCP çš„å°èˆªé¸å–®ä¾†è­˜åˆ¥ GCP æœå‹™çš„é¡å‹</li><li>äº†è§£ primitive roles ä¸¦ä½¿ç”¨ Cloud IAM æœå‹™æª¢æŸ¥ç‰¹å®šä½¿ç”¨è€…çš„å¯ç”¨æ“ä½œ</li><li>äº†è§£ Cloud Shell ä¸¦ä½¿ç”¨ <code>gcloud</code> toolkit ä¾†åŸ·è¡ŒæŒ‡ä»¤</li><li>äº†è§£ API library ä¸¦æŸ¥çœ‹å…¶ä¸»è¦åŠŸèƒ½</li></ul><blockquote><p>è‹¥æƒ³äº†è§£å¦‚ä½• <a href="./gcp-vm-nignx-web-server.html">åœ¨ GCP ä¸Šå»ºç«‹ VM æ¶è¨­ NIGNX Web server</a> å¯åƒè€ƒæ­¤ç¯‡ã€‚<br>è‹¥æƒ³äº†è§£å¦‚ä½• <a href="./gcp-vm-windows-server.html">åœ¨ GCP ä¸Šå»ºç«‹ VM æ¶è¨­ Windows Server</a> å¯åƒè€ƒæ­¤ç¯‡ã€‚</p></blockquote><blockquote><p>å…¶ä»–é—œæ–¼ Qwiklab çš„ä»‹ç´¹ï¼Œå¯è‡³åŸæ–‡ <a href="https://www.qwiklabs.com/focuses/2794?parent=catalog" target="_blank" rel="noopener">A Tour of Qwiklabs and the Google Cloud Platform</a> æŸ¥çœ‹ã€‚</p></blockquote><h2 id="å­˜å–-gcp-console"><a class="header-anchor" href="#å­˜å–-gcp-console"></a>å­˜å– GCP Console</h2><p>å¦‚æœå·²ç¶“é»æ“Šå³ä¸Šè§’çš„ã€ŒStart Labã€é–‹å§‹ï¼Œæ‡‰è©²æœƒçœ‹åˆ°å·¦å´çš„ã€ŒOpen Google Consoleã€æŒ‰éˆ•è®Šæˆå¯ä»¥è¢«é»æ“Šï¼Œè€Œä¸”å¯ä»¥çœ‹åˆ°æœ‰å¸³è™Ÿã€å¯†ç¢¼ä»¥åŠ GCP å°ˆæ¡ˆ IDï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-15-33-31.png" alt=""></p><h3 id="gcp-å°ˆæ¡ˆ-id"><a class="header-anchor" href="#gcp-å°ˆæ¡ˆ-id"></a>GCP å°ˆæ¡ˆ ID</h3><p><a href="https://cloud.google.com/docs/overview/#projects" target="_blank" rel="noopener">GCP å°ˆæ¡ˆ</a>æ˜¯ä½ çš„ Google é›²ç«¯è³‡æºçš„çµ„ç¹”å¯¦é«”ï¼ŒåŒ…å«è³‡æºå’Œæœå‹™ï¼Œä¾‹å¦‚ï¼šå¯ä»¥åŒ…å«ä¸€å€‹ VM çš„ poolï¼Œä¸€çµ„è³‡æ–™åº«ä»¥åŠå°‡å®ƒå€‘å½¼æ­¤é€£æ¥çš„ç¶²è·¯ï¼Œå°ˆæ¡ˆé‚„åŒ…å«è¨­å®šå’Œæ¬Šé™ï¼Œé€™äº›è¨­å®šå’Œæ¬Šé™å¯ä»¥æŒ‡å®šå®‰å…¨è¦å‰‡ä»¥åŠè¨­å®šèª°æœ‰æ¬Šå­˜å–å“ªäº›è³‡æºã€‚è€Œ GCP Project ID ä¸æœƒé‡è¤‡ï¼Œç”¨æ–¼å°‡ GCP è³‡æºå’Œ API é€£æ¥åˆ°ä½ çš„ç‰¹å®šå°ˆæ¡ˆã€‚</p><h3 id="å¸³è™Ÿå’Œå¯†ç¢¼"><a class="header-anchor" href="#å¸³è™Ÿå’Œå¯†ç¢¼"></a>å¸³è™Ÿå’Œå¯†ç¢¼</h3><p>å¸³è™Ÿå’Œå¯†ç¢¼æ˜¯è¡¨ç¤ºåœ¨ GCP èº«ä»½å’Œå­˜å–ç®¡ç† (Identity and Access Managementï¼ŒIAM) æœå‹™ä¸­ï¼Œå…·æœ‰å­˜å–æ¬Šé™èº«ä»½ (ä¸€å€‹æˆ–å¤šå€‹è§’è‰²) çš„æ†‘è­‰ï¼Œå…è¨±ä½ åœ¨å·²åˆ†é…çš„å°ˆæ¡ˆä¸­ä½¿ç”¨ GCP è³‡æºã€‚é€™äº›æ†‘è­‰æ˜¯è‡¨æ™‚çš„ï¼Œåªèƒ½åœ¨ lab é™åˆ¶çš„å­˜å–æ™‚é–“å…§ä½¿ç”¨ï¼Œæ‰€ä»¥åªè¦è¨ˆæ™‚å™¨å€’æ•¸åˆ° 0 ä¹‹å¾Œï¼Œä½ å°±ç„¡æ³•å†ä½¿ç”¨é€™äº›æ†‘è­‰å­˜å–é€™å€‹çš„ GCP å°ˆæ¡ˆã€‚</p><h2 id="ç™»å…¥-gcp"><a class="header-anchor" href="#ç™»å…¥-gcp"></a>ç™»å…¥ GCP</h2><ol><li>Lab æœƒæä¾›çµ¦ä½ å…è²»æš«æ™‚çš„ GCP å¸³è™Ÿï¼Œè¤‡è£½å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œç„¶å¾Œé»æ“Šã€ŒOpen Google Consoleã€é–‹å•Ÿ <a href="https://cloud.google.com/storage/docs/cloud-console" target="_blank" rel="noopener">GCP Console</a>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-15-33-31.png" alt=""></p><ol start="2"><li>æ¥è‘—å°±æœƒé–‹å•Ÿç™»å…¥é é¢ï¼Œå»ºè­°å¦å¤–é–‹ Chrome ç„¡ç—•æ¨¡å¼ä¾†ç™»å…¥ lab æä¾›çš„å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œå› ç‚º Chrome æœƒç´€éŒ„å¸³å¯†ï¼Œç¾åœ¨ç™»å…¥çš„åªæ˜¯æš«æ™‚å¸³è™Ÿï¼Œæœªä¾†ä¸éœ€è¦ç”¨åˆ°ï¼š</li></ol><div class="warning"><p>æ³¨æ„ï¼šé€™é‚Šæ˜¯ç™»å…¥ lab æä¾›çš„å¸³è™Ÿ (ä¹Ÿå°±æ˜¯ email å¿…é ˆç‚º <code>googlexxxxxx_student@qwiklabs.net</code> )ï¼Œå¦‚æœä½ æœ‰è‡ªå·±çš„ GCP å¸³è™Ÿï¼Œè«‹ä¸è¦ç”¨æ–¼æ­¤ labï¼Œé¿å…ç”¢ç”Ÿè²»ç”¨</p><blockquote><p>é¡ä¼¼æ–¼ <code>googlexxxxxx_student@qwiklabs.net</code> çš„å¸³è™Ÿæ˜¯ä¸€å€‹ Google å¸³è™Ÿï¼Œå°ˆç‚º Qwiklabs å­¸ç”Ÿä½¿ç”¨è€Œå»ºç«‹çš„ã€‚å®ƒå…·æœ‰ç‰¹å®šçš„åŸŸå (ä¹Ÿå°±æ˜¯ <code>qwiklabs.net</code> )ï¼Œä¸¦ä¸”å·²åˆ†é…äº† IAM è§’è‰²ï¼Œå…è¨±ä½ å»å­˜å–è©² GCP å°ˆæ¡ˆã€‚</p></blockquote></div><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-30.png" alt=""></p><ol start="3"><li>æ¥å— terms å’Œ conditionsï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-59.png" alt=""></p><ol start="4"><li>ä¸è¦æ–°å¢ recovery options æˆ– two-factor authentication (å› ç‚ºé€™æ˜¯ä¸€å€‹è‡¨æ™‚å¸³è™Ÿ)</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-23-18.png" alt=""></p><ol start="5"><li>å‹¾é¸åŒæ„æœå‹™æ¢æ¬¾ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-15.png" alt=""></p><p>ä¹‹å¾Œå°±å¯ä»¥é–‹å§‹ä½¿ç”¨ GCP Console å›‰ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-14-14-23-55.png" alt=""></p><h2 id="gcp-console-ä¸­çš„å°ˆæ¡ˆ"><a class="header-anchor" href="#gcp-console-ä¸­çš„å°ˆæ¡ˆ"></a>GCP Console ä¸­çš„å°ˆæ¡ˆ</h2><p>GCP Console çš„å·¦ä¸Šè§’ï¼Œæœƒçœ‹åˆ°ä¸€å€‹åç‚º Project info çš„é¢æ¿ï¼Œç•«é¢å¦‚ä¸‹ï¼š</p><p><img src="../images/getting-started-with-gcp/2019-04-14-14-23-05.png" alt=""></p><p>ä¸€å€‹å°ˆæ¡ˆæœƒæœ‰åç¨±ã€IDã€ç·¨è™Ÿï¼Œåœ¨ä½¿ç”¨ GCP æœå‹™æ™‚æœƒç¶“å¸¸ä½¿ç”¨é€™äº›æ±è¥¿ã€‚ä¸éä½ å¯ä»¥å­˜å–å¤šå€‹ GCP å°ˆæ¡ˆã€‚åœ¨æŸäº› lab ä¸­ï¼Œå¯èƒ½æœƒä½¿ç”¨å¤šå€‹å°ˆæ¡ˆä¾†å®Œæˆåˆ†é…çš„ä»»å‹™ã€‚å¦‚æœé»æ“Šå¸¶æœ‰å°ˆæ¡ˆåç¨±çš„ä¸‹æ‹‰å¼é¸å–®ä¸¦é¸æ“‡ã€ŒALLã€ï¼Œå°±æœƒçœ‹åˆ°ã€ŒQwiklabs Resourcesã€å°ˆæ¡ˆä¹Ÿå¯è¦‹ï¼š</p><p><img src="../images/getting-started-with-gcp/2019-04-14-14-31-05.gif" alt=""></p><div class="info"><p>ç›®å‰ä¸è¦åˆ‡æ›åˆ° Qwiklabs è³‡æºå°ˆæ¡ˆï¼ä½†æ˜¯ï¼Œä½ å¯ä»¥ç¨å¾Œåœ¨å…¶ä»– lab ä¸­ä½¿ç”¨å®ƒã€‚</p></div><p>GCP çš„å¤§å‹ä¼æ¥­æˆ–æœ‰ç¶“é©—çš„ä½¿ç”¨è€…æ“æœ‰æ•¸ååˆ°æ•¸åƒå€‹ GCP å°ˆæ¡ˆçš„æƒ…æ³é‚„è »å¸¸è¦‹çš„ï¼Œçµ„ç¹”æœƒä»¥ä¸åŒçš„æ–¹å¼ä½¿ç”¨ GCPï¼Œå› æ­¤å°ˆæ¡ˆåˆ†é›¢åœ¨é›²ç«¯é‹ç®—æœå‹™ (ä»¥åœ˜éšŠæˆ–ç”¢å“ç‚ºä¾‹) æ˜¯å€‹å¥½æ–¹æ³•ã€‚</p><p>â€œQwiklabs Resourcesâ€ æ˜¯ä¸€å€‹åŒ…å«æŸäº› lab çš„æª”æ¡ˆï¼Œè³‡æ–™é›†å’Œæ©Ÿå™¨ image çš„å°ˆæ¡ˆï¼Œå¯ä»¥å¾æ¯å€‹ GCP lab ç’°å¢ƒå­˜å–ã€‚è¦æ³¨æ„æ˜¯ â€œQwiklabs Resourcesâ€ èˆ‡æ‰€æœ‰ Qwiklabs ä½¿ç”¨è€…å…±äº«è³‡æº (read only)ï¼Œä¹Ÿå°±ä»£è¡¨ä½ ç„¡æ³•åˆªé™¤æˆ–ä¿®æ”¹å®ƒã€‚</p><p>ä½ æ­£åœ¨ä½¿ç”¨åç‚ºé¡ä¼¼æ–¼ <code>qwiklabs-gcp-xxx</code> çš„ GCP å°ˆæ¡ˆæ˜¯è‡¨æ™‚çš„ï¼Œä¹Ÿå°±ä»£è¡¨å°ˆæ¡ˆåŠå…¶åŒ…å«çš„æ‰€æœ‰å…§å®¹æœƒåœ¨ lab çµæŸå¾Œåˆªé™¤ã€‚æ¯æ¬¡ä½¿ç”¨çš„ lab éƒ½å¯ä»¥å­˜å–ä¸€å€‹æˆ–å¤šå€‹æ–°çš„ GCP å°ˆæ¡ˆï¼Œä¸¦ä¸”åœ¨é‚£è£¡ (ä¸æ˜¯ â€œQwiklabs Resourcesâ€ ) åŸ·è¡Œæ‰€æœ‰ lab çš„æ­¥é©Ÿã€‚</p><h2 id="å°èˆªé¸å–®å’Œæœå‹™"><a class="header-anchor" href="#å°èˆªé¸å–®å’Œæœå‹™"></a>å°èˆªé¸å–®å’Œæœå‹™</h2><p>åœ¨ç•«é¢çš„å·¦ä¸Šè§’æœ‰ä¸€å€‹é¡ä¼¼ã€Œä¸‰ã€çš„ iconï¼š</p><p><img src="../images/getting-started-with-gcp/2019-04-14-15-46-30.png" alt=""></p><p>é»æ“Šæ­¤æŒ‰éˆ•æœƒé¡¯ç¤º (æˆ–éš±è—) GCP æ ¸å¿ƒæœå‹™çš„å°èˆªé¸å–®ï¼Œå¦‚æœé¸å–®æ²’æœ‰æ‰“é–‹ï¼Œè«‹é»æ“Šæ­¤ icon ä¸¦æ²å‹•æŸ¥çœ‹æ‰€æœ‰æä¾›çš„æœå‹™é¡å‹ï¼š</p><p><img src="../images/getting-started-with-gcp/2019-04-14-14-32-42.gif" alt=""></p><p>åœ¨å°èˆªé¸å–®å¯ä»¥å¿«é€Ÿå­˜å–å¹³å°çš„æœå‹™ï¼Œå¯çœ‹åˆ°å…±æœ‰ 7 é¡ GCP çš„æœå‹™ï¼š</p><ul><li>Computeï¼šåŒ…å«æ”¯æ´ä»»ä½•é¡å‹çš„å·¥ä½œè² è¼‰çš„å„ç¨®æ©Ÿå‹ã€‚é€šéä¸åŒçš„é‹ç®—é¸é …ï¼Œå¯ä»¥æ±ºå®šä½ å¸Œæœ›å¦‚ä½•åƒèˆ‡ operational details å’ŒåŸºç¤æ¶æ§‹ç­‰</li><li>Storageï¼šçµæ§‹åŒ–æˆ–éçµæ§‹åŒ–ã€é—œä¿‚è³‡æ–™æˆ–éé—œä¿‚è³‡æ–™çš„è³‡æ–™å„²å­˜å’Œè³‡æ–™åº«é¸é …</li><li>Networkingï¼šå¹³è¡¡æ‡‰ç”¨ç¨‹å¼æµé‡å’Œæä¾›å®‰å…¨è¦å‰‡çš„æœå‹™</li><li>Stackdriverï¼šä¸€å¥—è·¨é›²ç«¯æ—¥èªŒè¨˜éŒ„ (cross-cloud logging)ã€ç›£æ§ã€è¿½è¹¤å’Œå…¶ä»–æœå‹™çš„å¯é æ€§å·¥å…·</li><li>Toolsï¼šç®¡ç†éƒ¨ç½²å’Œæ‡‰ç”¨ç¨‹å¼å»ºç½® pipeline çš„é–‹ç™¼äººå“¡çš„æœå‹™</li><li>Big Dataï¼šç”¨æ–¼è™•ç†å’Œåˆ†æå¤§é‡è³‡æ–™é›†çš„æœå‹™</li><li>Artificial Intelligence (AI)ï¼šå¯åœ¨ GCP ä¸ŠåŸ·è¡Œç‰¹å®šçš„ AI å’Œæ©Ÿå™¨å­¸ç¿’ (MLï¼Œmachine learning) ä»»å‹™çš„ä¸€å¥— API</li></ul><blockquote><p>è©³æƒ…å¯æŸ¥çœ‹å®˜æ–¹çš„ <a href="https://cloud.google.com/docs/overview/cloud-platform-services" target="_blank" rel="noopener">About the GCP Services |Â Google Cloud</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="è§’è‰²å’Œæ¬Šé™"><a class="header-anchor" href="#è§’è‰²å’Œæ¬Šé™"></a>è§’è‰²å’Œæ¬Šé™</h2><p>é™¤äº†é›²ç«¯é‹ç®—æœå‹™ä¹‹å¤–ï¼ŒGCP é‚„åŒ…å«ä¸€çµ„æ¬Šé™å’Œè§’è‰²ï¼Œç”¨æ–¼å®šç¾©èª°å¯ä»¥å­˜å–å“ªäº›è³‡æºï¼Œæˆ‘å€‘å°±å¯ä»¥ä½¿ç”¨é›²ç«¯èº«ä»½å’Œå­˜å–ç®¡ç† (<a href="https://cloud.google.com/iam/" target="_blank" rel="noopener">Cloud Identity and Access Managementï¼ŒIAM</a>) æœå‹™ä¾†æª¢æŸ¥å’Œä¿®æ”¹è§’è‰²å’Œæ¬Šé™ã€‚</p><p>è«‹æ‰“é–‹å°èˆªé¸å–®ï¼Œç„¶å¾Œé»æ“Šã€ŒIAM &amp; adminã€ï¼Œç•«é¢æœƒè·³è‡³åŒ…å«ä½¿ç”¨è€…åˆ—è¡¨çš„é é¢ï¼Œè©²é é¢æŒ‡å®šçµ¦äºˆç‰¹å®šå¸³è™Ÿçš„æ¬Šé™å’Œè§’è‰²ã€‚å˜—è©¦ç¯©é¸é€™äº›ä¸¦æ‰¾åˆ°ä½ ç™»å…¥çš„ â€œ@qwiklabsâ€ æ­¤ä½¿ç”¨è€…åç¨±ï¼š</p><p><img src="../images/getting-started-with-gcp/2019-04-14-15-48-30.gif" alt=""></p><p>é¡ä¼¼ä¸‹åœ–ï¼š</p><p><img src="../images/getting-started-with-gcp/2019-04-14-16-27-50.png" alt=""></p><p>member æ¬„ä½è¢«è¨­ç‚º <code>google23396_student@qwiklabs.net</code>ï¼ˆèˆ‡ä½ ç™»å…¥çš„å¸³è™Ÿä¸€æ¨£ï¼‰ï¼Œname æ¬„ä½è¢«è¨­ç‚º <code>google23396_student@qwiklabs.net student</code>ã€‚æœƒçœ‹åˆ° Role æ¬„ä½è¢«è¨­ç‚º <code>Editor</code>ï¼Œé€™æ˜¯ GCP æä¾›çš„ä¸‰ç¨® primitive roles çš„å…¶ä¸­ä¹‹ä¸€ã€‚é™¤éå¦æœ‰æŒ‡å®šï¼Œå¦å‰‡ primitive roles æ˜¯è¨­å®šå°ˆæ¡ˆç­‰ç´šçš„æ¬Šé™ï¼Œå®ƒå€‘æ§åˆ¶å°æ‰€æœ‰ GCP æœå‹™çš„å­˜å–å’Œç®¡ç†ã€‚</p><p>ä¸‹è¡¨æ˜¯å¾<a href="https://cloud.google.com/iam/docs/understanding-roles#primitive_roles" target="_blank" rel="noopener">è§’è‰²æ–‡ä»¶</a>ä¸­æå–çš„å®šç¾©ï¼Œå…¶ä¸­æä¾›äº† viewerã€editor å’Œ owner è§’è‰²æ¬Šé™çš„ overviewï¼š</p><table><thead><tr><th>è§’è‰²åç¨±</th><th>æ¬Šé™</th></tr></thead><tbody><tr><td>roles/viewer</td><td>ä¸å½±éŸ¿ç‹€æ…‹çš„ read-only æ“ä½œçš„æ¬Šé™ï¼Œä¾‹å¦‚ï¼šæŸ¥çœ‹ (ä½†ä¸èƒ½ä¿®æ”¹) ç¾æœ‰çš„è³‡æºæˆ–è³‡æ–™</td></tr><tr><td>roles/editor</td><td>æ‰€æœ‰ viewer çš„æ¬Šé™ï¼Œä»¥åŠä¿®æ”¹ç‹€æ…‹çš„æ“ä½œçš„æ¬Šé™ï¼Œä¾‹å¦‚ï¼šä¿®æ”¹ç¾æœ‰è³‡æº</td></tr><tr><td>roles/owner</td><td>æ‰€æœ‰ editor æ¬Šé™å’Œä»¥ä¸‹æ“ä½œçš„æ¬Šé™ï¼š<br>- ç®¡ç†å°ˆæ¡ˆçš„è§’è‰²å’Œæ¬Šé™ä»¥åŠå°ˆæ¡ˆä¸­çš„æ‰€æœ‰è³‡æº<br>- è¨­å®šå°ˆæ¡ˆçš„è¨ˆè²»æ–¹å¼</td></tr></tbody></table><p>å› æ­¤ editor èƒ½å¤ å»ºç«‹ã€ä¿®æ”¹å’Œåˆªé™¤ GCP è³‡æºã€‚ä½†æ˜¯ç„¡æ³•åœ¨ GCP å°ˆæ¡ˆä¸­æ–°å¢æˆ–åˆªé™¤ memberã€‚</p><h2 id="api-å’Œæœå‹™"><a class="header-anchor" href="#api-å’Œæœå‹™"></a>API å’Œæœå‹™</h2><p>Google Cloud API æ˜¯ GCP ä¸­é‡è¦çš„éƒ¨åˆ†ã€‚èˆ‡æœå‹™é¡ä¼¼ï¼Œå¾ä¼æ¥­ç®¡ç†åˆ°æ©Ÿå™¨å­¸ç¿’ç­‰é ˜åŸŸçš„ 200 å¤šå€‹ API éƒ½å¯ä»¥è¼•é¬†åœ°èˆ‡ GCP å°ˆæ¡ˆå’Œæ‡‰ç”¨ç¨‹å¼æ•´åˆã€‚</p><p>API æ˜¯ â€œApplication Programming Interfacesâ€ï¼Œå¯ä»¥ç›´æ¥æˆ–é€šé Google Cloud client library å‘¼å« (call) å®ƒå€‘ã€‚ Cloud API ä½¿ç”¨å®˜æ–¹çš„ <a href="https://cloud.google.com/apis/design/" target="_blank" rel="noopener">Google API Design Guide</a> ä¸­æè¿°çš„è³‡æºå°å‘çš„è¨­è¨ˆåŸå‰‡ã€‚</p><p>ç•¶ Qwiklabs ç‚º lab instance æä¾›æ–°çš„ GCP å°ˆæ¡ˆæ™‚ï¼Œå®ƒå¯ä»¥åœ¨èƒŒå¾Œå•Ÿç”¨å¤§å¤šæ•¸çš„ APIï¼Œä»¥ä¾¿ä½ å¯ä»¥ç«‹å³è™•ç† lab çš„ä»»å‹™ã€‚ä½†è¦æ³¨æ„çš„äº‹ï¼Œç•¶ä½ åœ¨ Qwiklabs ä¹‹å¤–å»ºç«‹è‡ªå·±çš„ GCP å°ˆæ¡ˆæ™‚ï¼Œå¿…é ˆè‡ªå·±å•Ÿç”¨æŸäº› APIã€‚</p><p>å¤§å¤šæ•¸é›²ç«¯ API æœƒç‚ºä½ æä¾›æœ‰é—œå°ˆæ¡ˆä½¿ç”¨è©² API çš„è©³ç´°è³‡è¨Š (åŒ…æ‹¬æµé‡ã€éŒ¯èª¤ç‡ã€å»¶é²æ™‚é–“)ï¼Œå¹«åŠ©ä½ å¿«é€Ÿæ‰¾åˆ°ä½¿ç”¨ Googleæœå‹™çš„æ‡‰ç”¨ç¨‹åºå•é¡Œã€‚ä½ å¯ä»¥é€šéæ‰“é–‹å°èˆªé¸å–®ä¸¦é»æ“Šã€ŒAPIs &amp; Services &gt; Libraryã€ä¾†æŸ¥çœ‹æ­¤è³‡è¨Šï¼š</p><p><img src="../images/getting-started-with-gcp/2019-04-14-17-53-30.gif" alt=""></p><p>åœ¨ API æœå°‹æ¬„ä¸­ï¼Œè¼¸å…¥ â€œDialogflowâ€ ä¸¦é¸æ“‡ Dialogflow API å¾Œï¼Œå°±æœƒçœ‹åˆ°ä¸‹åœ–çš„é é¢ï¼š</p><p><img src="../images/getting-started-with-gcp/2019-04-15-17-55-00.png" alt=""></p><p>Dialogflow API å¯è®“ä½ å»ºç½®å°è©±å¼ (conversational) æ‡‰ç”¨ç¨‹å¼ (ä¾‹å¦‚ï¼Œfor Google Assistant)ï¼Œè€Œç„¡éœ€æ“”å¿ƒåº•å±¤æ©Ÿå™¨å­¸ç¿’å’Œè‡ªç„¶èªè¨€ç†è§£ (Natural Language Understanding) schemaã€‚</p><p>é»æ“Šã€ŒENABLEã€æŒ‰éˆ•å¾Œæœƒè·³è‡³æ–°é é¢ï¼Œæ¥è‘—é»æ“Šç€è¦½å™¨çš„è¿”å›æŒ‰éˆ•å°±å¯çœ‹åˆ°ã€ŒAPI enabledã€ï¼š</p><p><img src="../images/getting-started-with-gcp/2019-04-15-18-08-40.png" alt=""></p><p>é»æ“Šã€ŒTry this APIã€æŒ‰éˆ•æœƒä»¥æ–°åˆ†é çš„æ–¹å¼é–‹å•Ÿ Dialogflow API çš„æ–‡ä»¶ï¼Œä¸¦ä¸”å¯ä»¥æŒ‡å®šå¯ç”¨çš„ API æ–¹æ³•ã€‚</p><p><img src="../images/getting-started-with-gcp/2019-04-15-22-01-55.png" alt=""></p><blockquote><p>è©³æƒ…å¯æŸ¥çœ‹ Google Cloud ä¸­åç‚º <a href="https://developers.google.com/apis-explorer/#p/" target="_blank" rel="noopener">APIs Explorer</a> çš„ hands-on å·¥å…·ã€‚</p></blockquote><h2 id="cloud-shell"><a class="header-anchor" href="#cloud-shell"></a>Cloud Shell</h2><p><a href="https://cloud.google.com/shell/docs/features" target="_blank" rel="noopener">Cloud Shell</a> æ˜¯åœ¨ç€è¦½å™¨å…§çš„æŒ‡ä»¤æç¤º (command prompt) åŸ·è¡Œç’°å¢ƒï¼Œå…è¨±ä½ åœ¨çµ‚ç«¯æç¤º (terminal prompt) ä¸‹è¼¸å…¥æŒ‡ä»¤ä¾†ç®¡ç† GCP å°ˆæ¡ˆä¸­çš„è³‡æºå’Œæœå‹™ã€‚Cloud Shell èƒ½è®“ä½ åœ¨ä¸é›¢é–‹ console çš„æƒ…æ³ä¸‹åŸ·è¡Œæ‰€æœ‰ shell æŒ‡ä»¤ï¼Œä¸¦æœ‰é è£çš„ command-line å·¥å…·ã€‚</p><p>åœ¨ console çš„å³ä¸Šè§’é»æ“Šã€ŒActivate Cloud Shellã€æŒ‰éˆ•ï¼Œç„¶å¾Œåœ¨å‡ºç¾æç¤ºæ™‚é»æ“Šã€ŒSTART CLOUD SHELLã€æŒ‰éˆ•ï¼š</p><p><img src="../images/getting-started-with-gcp/2019-04-15-19-08-40.gif" alt=""></p><p>æ¥è‘—æœƒåœ¨ console åº•éƒ¨å‡ºç¾ä¸€å€‹æ–°çš„é»‘è‰²è¦–çª—ï¼Œè¦–çª—å…§æœƒå‡ºç¾é¡ä¼¼ä»¥ä¸‹å…§å®¹çš„è¨Šæ¯å’Œæç¤ºï¼Œé€™ä»£è¡¨ä½ å·²å•Ÿå‹•ä¸¦åŸ·è¡Œ Cloud Shell sessionï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">Welcome to Cloud Shell! Type "help" to get started.<br>Your Cloud Platform project in this session is set to qwiklabs-gcp-76ad0f1342e20013.<br>Use "gcloud config set project [PROJECT_ID]" to change to a different project.<br>gcpstaging23396_student@cloudshell:~ (qwiklabs-gcp-76ad0f1342e20013)$<br></code></pre></td></tr></table></figure><p>æ¥è‘—å°‡ä¸‹é¢æŒ‡ä»¤è¤‡è£½ä¸¦è²¼ (æˆ–è¼¸å…¥) è‡³ Cloud Shell ä¸Šï¼Œç„¶å¾ŒæŒ‰ Enter éµåŸ·è¡Œï¼Œæ‡‰è©²æœƒçœ‹åˆ°é¡ä¼¼ä¸‹é¢çš„è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> gcloud auth list<br>Credentialed Accounts<br>ACTIVE  ACCOUNT<br>*       gcpstaging23396_student@qwiklabs.net<br>To set the active account, run:<br>    $ gcloud config set account `ACCOUNT`<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ <code>ACTIVE ACCOUNT</code> æ˜¯è¨­ç‚ºä½ çš„ GCP IAM èº«ä»½ (ä¹Ÿå°±æ˜¯ <code>googlexxxxxx_student@qwiklabs.net</code> )ï¼Œ<a href="https://cloud.google.com/sdk/gcloud/reference/auth/list" target="_blank" rel="noopener"><code>gcloudauth list</code></a> æŒ‡ä»¤æœƒåˆ—å‡º GCP å°ˆæ¡ˆä¸­æœ‰æ†‘è­‰çš„å¸³è™Ÿã€‚æ­¤å¸³è™Ÿåç¨±èˆ‡ä¹‹å‰ç™»å…¥åˆ° console çš„ Qwiklabs å¸³è™Ÿç›¸åŒã€‚ï¼š</p><p>å¦‚ä¹‹å‰æ‰€èªªçš„ï¼ŒCloud Shell é è£äº†ç‰¹å®šçš„ command-line å·¥å…·ï¼Œä¸»è¦çš„ GCP toolkit æ˜¯ <a href="https://cloud.google.com/sdk/gcloud/" target="_blank" rel="noopener"><code>gcloud</code></a>ï¼Œæ˜¯ç”¨æ–¼å¹³å°ä¸Šçš„è¨±å¤šä»»å‹™ï¼Œä¾‹å¦‚ï¼šè³‡æºç®¡ç†å’Œä½¿ç”¨è€…èº«ä»½é©—è­‰ã€‚é™¤äº†é è£çš„ toolkitï¼ŒCloud Shell é‚„é™„å¸¶æ¨™æº–çš„ unix CLI å·¥å…·å’Œ <a href="https://www.nano-editor.org/" target="_blank" rel="noopener">nano</a> ç­‰æ–‡å­—ç·¨è¼¯å™¨ï¼Œåœ¨ Cloud Shell ä¸­å¯ä»¥åˆ©ç”¨å®ƒå€‘ä¾†å»ºç«‹å’Œç·¨è¼¯æª”æ¡ˆã€‚</p><h2 id="åƒè€ƒä¾†æº"><a class="header-anchor" href="#åƒè€ƒä¾†æº"></a>åƒè€ƒä¾†æº</h2><ul><li><a href="https://www.qwiklabs.com/focuses/2794?parent=catalog" target="_blank" rel="noopener">A Tour of Qwiklabs and the Google Cloud Platform</a> (æœ¬ç¯‡å¤§å¤šæ•¸çš„åœ–ç‰‡ä¾†æº)</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/gcp.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ&lt;a href=&quot;https://www.qwiklabs.com/focuses/2794?parent=catalog&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;A Tour of Qwiklabs and the Google Cloud Platform&lt;/a&gt;ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•ä½¿ç”¨ä»¥åŠèªè­˜ Qwiklab å’Œ GCPã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Cloud" scheme="https://titangene.github.io/categories/cloud/"/>
    
    
      <category term="GCP" scheme="https://titangene.github.io/tags/gcp/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ GCP ä¸Šå»ºç«‹ VM æ¶è¨­ NIGNX Web server</title>
    <link href="https://titangene.github.io/article/gcp-vm-nignx-web-server.html"/>
    <id>https://titangene.github.io/article/gcp-vm-nignx-web-server.html</id>
    <published>2019-04-14T02:17:46.000Z</published>
    <updated>2019-04-30T15:57:08.765Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/gcp.jpg" alt=""></p><p>æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ<a href="https://www.qwiklabs.com/focuses/3563?parent=catalog" target="_blank" rel="noopener">Creating a Virtual Machine</a>ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•é€é GCP Console å’Œ command-line å·¥å…· <code>gcloud</code> åœ¨ GCP å»ºç«‹ instanceï¼Œå¦‚ä½•ä½¿ç”¨ <code>gcloud</code> é€é SSH é€£æ¥åˆ°ä½ çš„ instanceï¼Œä»¥åŠå¦‚ä½•åœ¨ VM ä¸Šéƒ¨ç½² NIGNX web serverã€‚</p><a id="more"></a><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-13-47-05.png" alt=""></p><p>é€é Google Compute Engineï¼Œå¯åœ¨ Google åŸºç¤æ¶æ§‹ä¸Šï¼Œå»ºç«‹åŸ·è¡Œä¸åŒä½œæ¥­ç³»çµ±çš„ VM (virtual machineï¼Œè™›æ“¬æ©Ÿ)ï¼ŒåŒ…æ‹¬å¤šç¨® Linux (Debianã€Ubuntuã€Suseã€Red Hatã€CoreOS) å’Œ Windows Serverã€‚</p><p>å¯ä»¥å­¸åˆ°å¦‚ä½•ä½¿ç”¨ Google Cloud Platform (GCP) Console å’Œ <code>gcloud</code> command-line å»ºç«‹å„ç¨®æ©Ÿå™¨é¡å‹çš„è™›æ“¬æ©Ÿ instance (å¯¦ä¾‹)ï¼Œé‚„èƒ½å­¸ç¿’å¦‚ä½•å°‡ NGINX web server é€£æ¥åˆ° VMã€‚</p><blockquote><p>è‹¥æƒ³äº†è§£å¦‚ä½• <a href="./gcp-vm-windows-server.html">åœ¨ GCP ä¸Šå»ºç«‹ VM æ¶è¨­ Windows Server</a> å¯åƒè€ƒæ­¤ç¯‡ã€‚</p></blockquote><h2 id="æœ¬ç¯‡å°‡æœƒåšä»€éº¼ï¼Ÿ"><a class="header-anchor" href="#æœ¬ç¯‡å°‡æœƒåšä»€éº¼ï¼Ÿ"></a>æœ¬ç¯‡å°‡æœƒåšä»€éº¼ï¼Ÿ</h2><ul><li>ä½¿ç”¨ GCP Console å»ºç«‹ VM</li><li>ä½¿ç”¨ <code>gcloud</code> command-line å»ºç«‹ VM</li><li>åœ¨ VM ä¸Šéƒ¨ç½² web server</li></ul><h2 id="æº–å‚™"><a class="header-anchor" href="#æº–å‚™"></a>æº–å‚™</h2><p>åœ¨é»æ“Šã€ŒStart Labã€ä¹‹å‰ï¼Œæº–å‚™å¥½ç¶²è·¯ç€è¦½å™¨ (æ¨è–¦ç”¨ Google Chrome)ï¼Œä¸¦ä¸”è‡³å°‘ 40 åˆ†é˜å¯ä»¥å°ˆæ³¨çš„æ™‚é–“ï¼Œå› ç‚º lab æ˜¯æœ‰æ™‚é–“é™åˆ¶ï¼Œç•¶ä½ æŒ‰ä¸‹ã€ŒStart Labã€é–‹å§‹å­¸ç¿’æ™‚ï¼Œç„¡æ³•æš«åœå€’æ•¸è¨ˆæ™‚ï¼Œä½ åªèƒ½åœ¨é€™æ®µæ™‚é–“å…§ä½¿ç”¨ lab æä¾›çµ¦ä½ çš„å…¨æ–°æš«æ™‚ GCP Console å¯ç”¨å¸³è™Ÿï¼Œæ™‚é–“åˆ°ä¹‹å¾Œçš„å¹¾åˆ†é˜å°±æœƒè‡ªå‹•ç™»å‡ºã€‚</p><div class="warning"><p>æ³¨æ„ï¼šå¦‚æœä½ æœ‰è‡ªå·±çš„å€‹äºº GCP å¸³è™Ÿæˆ–å°ˆæ¡ˆï¼Œè«‹ä¸è¦åœ¨æ­¤ lab ä½¿ç”¨</p></div><h2 id="é–‹å§‹ä½ çš„-lab-ç„¶å¾Œç™»å…¥-gcp-console"><a class="header-anchor" href="#é–‹å§‹ä½ çš„-lab-ç„¶å¾Œç™»å…¥-gcp-console"></a>é–‹å§‹ä½ çš„ Labï¼Œç„¶å¾Œç™»å…¥ GCP Console</h2><ol><li>å¦‚æœæº–å‚™è¦é–‹å§‹ï¼Œå¯ä»¥é»æ“Šå³ä¸Šè§’çš„ã€ŒStart Labã€é–‹å§‹ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-13-47-32.png" alt=""></p><ol start="2"><li>æ¥è‘—æœƒå‡ºç¾é€™å€‹ç•«é¢ï¼Œå› ç‚ºæˆ‘åƒåŠ  <a href="https://www.facebook.com/events/2005848903055499/" target="_blank" rel="noopener">GDG Tainan</a> çš„æ´»å‹•ï¼Œæ´»å‹•æœ‰æä¾› Qwiklabs ä¸€å€‹æœˆçš„å…è²»é¡åº¦ï¼Œæ‰€ä»¥æˆ‘é»é¸ä¸‹åœ–å·¦é‚Šçš„ã€ŒUse Subscriptionã€ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-21-15.png" alt=""></p><ol start="3"><li>Lab æœƒæä¾›çµ¦ä½ å…è²»æš«æ™‚çš„ GCP å¸³è™Ÿï¼Œè¤‡è£½å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œç„¶å¾Œé»æ“Šã€ŒOpen Google Consoleã€é–‹å•Ÿ <a href="https://cloud.google.com/storage/docs/cloud-console" target="_blank" rel="noopener">GCP Console</a>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-15-33-31.png" alt=""></p><p>åœ–ç‰‡ä¾†æºï¼š<a href="https://www.qwiklabs.com/focuses/3563?parent=catalog" target="_blank" rel="noopener">Creating a Virtual Machine | Qwiklabs</a></p><ol start="4"><li>æ¥è‘—å°±æœƒé–‹å•Ÿç™»å…¥é é¢ï¼Œå»ºè­°å¦å¤–é–‹ Chrome ç„¡ç—•æ¨¡å¼ä¾†ç™»å…¥ lab æä¾›çš„å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œå› ç‚º Chrome æœƒç´€éŒ„å¸³å¯†ï¼Œç¾åœ¨ç™»å…¥çš„åªæ˜¯æš«æ™‚å¸³è™Ÿï¼Œæœªä¾†ä¸éœ€è¦ç”¨åˆ°ï¼š</li></ol><div class="warning"><p>æ³¨æ„ï¼šé€™é‚Šæ˜¯ç™»å…¥ lab æä¾›çš„å¸³è™Ÿ (ä¹Ÿå°±æ˜¯ email å¿…é ˆç‚º <code>googlexxxxxx_student@qwiklabs.net</code> )ï¼Œå¦‚æœä½ æœ‰è‡ªå·±çš„ GCP å¸³è™Ÿï¼Œè«‹ä¸è¦ç”¨æ–¼æ­¤ labï¼Œé¿å…ç”¢ç”Ÿè²»ç”¨</p><blockquote><p>é¡ä¼¼æ–¼ <code>googlexxxxxx_student@qwiklabs.net</code> çš„å¸³è™Ÿæ˜¯ä¸€å€‹ Google å¸³è™Ÿï¼Œå°ˆç‚º Qwiklabs å­¸ç”Ÿä½¿ç”¨è€Œå»ºç«‹çš„ã€‚å®ƒå…·æœ‰ç‰¹å®šçš„åŸŸå (ä¹Ÿå°±æ˜¯ <code>qwiklabs.net</code> )ï¼Œä¸¦ä¸”å·²åˆ†é…äº† IAM è§’è‰²ï¼Œå…è¨±ä½ å»å­˜å–è©² GCP å°ˆæ¡ˆã€‚</p></blockquote></div><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-30.png" alt=""></p><ol start="5"><li>æ¥å— terms å’Œ conditionsï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-22-59.png" alt=""></p><ol start="6"><li>ä¸è¦æ–°å¢ recovery options æˆ– two-factor authentication (å› ç‚ºé€™æ˜¯ä¸€å€‹è‡¨æ™‚å¸³è™Ÿ)</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-23-18.png" alt=""></p><ol start="7"><li>å‹¾é¸åŒæ„æœå‹™æ¢æ¬¾ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-15.png" alt=""></p><p>ä¹‹å¾Œå°±å¯ä»¥é–‹å§‹ä½¿ç”¨ GCP Console å›‰ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-14-14-23-55.png" alt=""></p><h2 id="å•Ÿå‹•-google-cloud-shell"><a class="header-anchor" href="#å•Ÿå‹•-google-cloud-shell"></a>å•Ÿå‹• Google Cloud Shell</h2><p>Google Cloud Shell æ˜¯è¼‰å…¥äº†é–‹ç™¼å·¥å…·çš„ VMï¼Œå®ƒæä¾› 5GB çš„ home ç›®éŒ„ï¼Œä¸¦åœ¨ Google Cloud ä¸ŠåŸ·è¡Œã€‚å¯ç”¨ Google Cloud Shell æä¾›çš„ command-line ä¾†å­˜å– GCP çš„è³‡æºã€‚</p><ol><li>åœ¨ GCP console çš„å³ä¸Šæ–¹å·¥å…·åˆ—ä¸­ï¼Œé»æ“Šã€ŒActivate Cloud Shellã€æŒ‰éˆ•ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-24-42.png" alt=""></p><ol start="2"><li>åœ¨æ‰“é–‹çš„å°è©±æ¡†å…§ï¼Œé»æ“Šã€ŒSTART CLOUD SHELLã€ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-25-23.png" alt=""></p><ol start="3"><li>é€£æ¥å’Œæä¾›ç’°å¢ƒéœ€è¦ä¸€äº›æ™‚é–“ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-26-05.png" alt=""></p><ol start="4"><li>é€£æ¥å¾Œï¼Œå°±ä»£è¡¨ä½ å·²ç¶“éèº«ä»½é©—è­‰ï¼Œå°ˆæ¡ˆå·²è¨­ç½®ç‚º <code>PROJECT_ID</code>ï¼Œä»¥ä¸‹åœ–çš„ç‚ºä¾‹ï¼Œæ­¤å°ˆæ¡ˆçš„ ID ç‚º <code>qwiklabs-gcp-f9d61ede8167e6b0</code>ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-26-34.png" alt=""></p><p><code>gcloud</code> æ˜¯ GCP çš„ command-line å·¥å…·ï¼Œä»–å·²é å…ˆå®‰è£åœ¨ Cloud Shell ä¸Šï¼Œä¸¦ä¸”æ”¯æ´ tab è‡ªå‹•è£œé½Š (tab-completion)ã€‚</p><p>æœªä¾†å¯ä½¿ç”¨ <code>gcloud</code> çš„ä¸‹é¢æŒ‡ä»¤ä¸¦é€é <code>PROJECT_ID</code> ä¾†æ›´æ›æˆå…¶ä»–å°ˆæ¡ˆï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud config <span class="hljs-built_in">set</span> project [PROJECT_ID]</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤å¯åˆ—å‡ºæœ‰æ•ˆå¸³è™Ÿåç¨±ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud auth list</span><br>          Credentialed Accounts<br>ACTIVE  ACCOUNT<br>*       google3043863_student@qwiklabs.net<br><br>To set the active account, run:<br>    $ gcloud config set account `ACCOUNT`<br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤åˆ—å‡ºå°ˆæ¡ˆ IDï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud config list project</span><br>[core]<br>project = qwiklabs-gcp-f9d61ede8167e6b0<br><br>Your active configuration is: [cloudshell-9292]<br></code></pre></td></tr></table></figure><h2 id="ç†è§£-regions-å’Œ-zones"><a class="header-anchor" href="#ç†è§£-regions-å’Œ-zones"></a>ç†è§£ Regions å’Œ Zones</h2><p>Compute Engine è³‡æºä½æ–¼ä¸åŒçš„ regions (åœ°å€) æˆ– zones (å€åŸŸ)ã€‚region æ˜¯ä½ å¯ä»¥åŸ·è¡Œè³‡æºçš„æ‰€åœ¨ç‰¹å®šåœ°ç†ä½ç½®ã€‚æ¯å€‹ region éƒ½æœ‰ä¸€å€‹æˆ–å¤šå€‹ zonesã€‚ä¾‹å¦‚ï¼Œ<code>us-central1</code> region ä»£è¡¨ç¾åœ‹ä¸­éƒ¨åœ°å€ï¼Œå…¶ä¸­åŒ…å«çš„ Zones æœ‰ <code>us-central1-a</code>ã€<code>us-central1-b</code>ã€<code>us-central1-c</code> èˆ‡ <code>us-central1-f</code>ã€‚</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-17-58-23.png" alt=""></p><p>åœ–ç‰‡ä¾†æºï¼š<a href="https://www.qwiklabs.com/focuses/3563?parent=catalog" target="_blank" rel="noopener">Creating a Virtual Machine | Qwiklabs</a></p><p>ä½æ–¼ zone ä¸­çš„è³‡æºéƒ½ç¨±ç‚º zonel (å€åŸŸ) è³‡æºï¼ŒVM instance (å¯¦ä¾‹) å’Œ persistent disk (æ°¸ä¹…ç£ç¢Ÿ) éƒ½ä½æ–¼ zone ä¸­ï¼Œå¦‚æœè¦å°‡ persistent disk é™„åŠ åˆ° VM instanceï¼Œé€™å…©å€‹è³‡æºéƒ½å¿…é ˆä½æ–¼åŒä¸€å€‹ zone ä¸­ã€‚åŒæ¨£ï¼Œå¦‚æœè¦å°‡éœæ…‹ IP ä½å€åˆ†é…åˆ° instanceï¼Œæ­¤ instance å°±å¿…é ˆèˆ‡éœæ…‹ IP ä½æ–¼åŒä¸€å€‹ region ä¸­ã€‚</p><blockquote><p>è©³æƒ…å¯åƒè€ƒ GCP å®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/regions-zones/" target="_blank" rel="noopener">Regions &amp; Zones</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="å¾-cloud-console-å»ºç«‹æ–°çš„-instance"><a class="header-anchor" href="#å¾-cloud-console-å»ºç«‹æ–°çš„-instance"></a>å¾ Cloud Console å»ºç«‹æ–°çš„ instance</h2><p>åœ¨ GCP Console çš„å³ä¸Šè§’ï¼Œé»é¸ã€ŒNavigation menu &gt; Compute Engine &gt; VM Instancesã€ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-18-16-42.png" alt=""></p><p>æ¥è‘—é»æ“Šã€ŒCreateã€å»ºç«‹æ–°çš„ instanceï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-31-03.png" alt=""></p><p>å»ºç«‹æ–°çš„ instance æ™‚å¯ä»¥è¨­å®šå¾ˆå¤šåƒæ•¸ã€‚åœ¨æ­¤ lab ä¸­æœƒä½¿ç”¨ä»¥ä¸‹è¨­å®šï¼š</p><table><thead><tr><th>æ¬„ä½</th><th>å€¼</th><th>é¡å¤–è³‡è¨Š</th></tr></thead><tbody><tr><td>name</td><td><code>gcelab</code></td><td></td></tr><tr><td>region</td><td><code>us-central1 (Iowa)</code><br>æˆ–<br><code>asia-south1 (Mumbai)</code></td><td><a href="https://cloud.google.com/compute/docs/regions-zones/" target="_blank" rel="noopener">æ›´å¤šé—œæ–¼ regions çš„è³‡è¨Š</a></td></tr><tr><td>zone</td><td><code>us-central1-c</code><br>æˆ–<br><code>asia-south1-c</code><br>æ³¨æ„ï¼šè¨˜ä½ä½ é¸æ“‡çš„ zoneï¼Œä¹‹å¾Œæœƒç”¨åˆ°</td><td><a href="https://cloud.google.com/compute/docs/regions-zones/" target="_blank" rel="noopener">æ›´å¤šé—œæ–¼ zones çš„è³‡è¨Š</a></td></tr><tr><td>Machine Type</td><td><code>2 vCPU</code><br>é€™æ˜¯ä¸€å€‹ ( <code>n1-standard-2</code> )<br>2-CPU, 7.5 GB RAM instance<br><br>æœ‰å¾ˆå¤šæ©Ÿå‹å¯ä»¥é¸æ“‡ï¼Œå¾ micro instance é¡å‹çš„åˆ° 32-core/208 GB RAM çš„éƒ½æœ‰ï¼Œè©³æƒ…å¯åƒè€ƒ<a href="https://cloud.google.com/compute/docs/machine-types" target="_blank" rel="noopener">æ©Ÿå‹ç¨®é¡</a>æ–‡ä»¶</td><td>æ³¨æ„ï¼šæ–°å°ˆæ¡ˆå…·æœ‰é è¨­çš„<a href="https://cloud.google.com/compute/quotas" target="_blank" rel="noopener">è³‡æºé…é¡</a>ï¼Œå¯èƒ½æœƒé™åˆ¶ CPU æ ¸å¿ƒæ•¸ã€‚å¯åœ¨æ­¤ lab ä¹‹å¤–çš„å°ˆæ¡ˆä¸Šç”³è«‹åˆ°æ›´é«˜çš„è¦æ ¼</td></tr><tr><td>Boot Disk</td><td><code>New 10 GB standard persistent disk</code><br><code>OS Image: Debian GNU/Linux 9 (Stretch)</code></td><td>æœ‰å¾ˆå¤š images å¯ä»¥é¸æ“‡ï¼ŒåŒ…æ‹¬ï¼šDebianã€Ubuntuã€CoreOSï¼Œä»¥åŠ premium imagesï¼Œåƒæ˜¯ RedHat Enterprise Linux å’Œ Windows Serverï¼Œè©³æƒ…å¯åƒè€ƒ <a href="https://cloud.google.com/compute/docs/images" target="_blank" rel="noopener">OS</a> æ–‡ä»¶</td></tr><tr><td>Firewall</td><td>å‹¾é¸ <code>Allow HTTP traffic</code>ï¼Œå‹¾é¸æ­¤é¸é …æ‰èƒ½å­˜å–ä¹‹å¾Œå®‰è£çš„ web server</td><td>æ³¨æ„ï¼šé€™æœƒè‡ªå‹•å»ºç«‹é˜²ç«ç‰†è¦å‰‡ï¼Œå…è¨± 80 port çš„ HTTP æµé‡</td></tr></tbody></table><p>è¨­å®šå¥½ä¹‹å¾Œï¼Œé»æ“Šã€ŒCreateã€ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-32-27.png" alt=""></p><p>ç­‰å¾… instance å»ºç«‹ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-34-20.png" alt=""></p><p>çœ‹åˆ°ä¸‹é¢ç•«é¢å°±ä»£è¡¨ instance å·²å»ºç«‹å®Œæˆï¼Œæ¥è‘—é»æ“Šå³é‚Šçš„ã€ŒSSHã€æŒ‰éˆ•ï¼Œæœƒé–‹å•Ÿæ–°çš„ç€è¦½å™¨é é¢ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-18-44-40.png" alt=""></p><p>æ­¤é é¢æ˜¯ç›´æ¥å¾ç€è¦½å™¨å•Ÿå‹• SSH client é€£æ¥åˆ° VMï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-35-45.png" alt=""></p><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/instances/connecting-to-instance" target="_blank" rel="noopener">Connect to an instance using ssh</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="å®‰è£-nginx-web-server"><a class="header-anchor" href="#å®‰è£-nginx-web-server"></a>å®‰è£ NGINX web server</h2><ol><li>é€é SSH é€£æ¥ VM ä¹‹å¾Œï¼Œè«‹ä½¿ç”¨ <code>sudo</code> å–å¾— <code>root</code> çš„å­˜å–æ¬Šé™ï¼š</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> sudo su -</span><br></code></pre></td></tr></table></figure><ol start="2"><li>æ›´æ–° OSï¼š</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> apt-get update</span><br>Get:1 http://security.debian.org stretch/updates InRelease [94.3 kB]<br>Ign:2 http://deb.debian.org/debian stretch InRelease      <br>Get:3 http://deb.debian.org/debian stretch-updates InRelease [91.0 kB]     <br>...<br></code></pre></td></tr></table></figure><ol start="3"><li>å®‰è£ NGINXï¼š</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> apt-get install nginx -y</span><br></code></pre></td></tr></table></figure><ol start="4"><li>æª¢æŸ¥ NGINX æ˜¯å¦æ­£åœ¨åŸ·è¡Œï¼š</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> ps auwx | grep nginx</span><br>root      2339  0.0  0.0 159532  1628 ?        Ss   06:37   0:00 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;<br>www-data  2340  0.0  0.0 159864  3200 ?        S    06:37   0:00 nginx: worker process<br>www-data  2341  0.0  0.0 159864  3200 ?        S    06:37   0:00 nginx: worker process<br>root      2350  0.0  0.0  12780   952 pts/0    S+   06:37   0:00 grep nginx<br></code></pre></td></tr></table></figure><div class="info"><p>è¨»ï¼šå¦‚æœé—œæ‰ NGINX å°±ä¸æœƒå‡ºç¾é—œæ–¼ NGINX çš„ processï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs undefined">$ service nginx stop<br><br>$ ps auwx | grep nginx<br>root      2359  0.0  0.0  12780  1012 pts/0    S+   14:23   0:00 grep nginx<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤å¯ä»¥å•Ÿå‹• NGINXï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> service nginx start</span><br></code></pre></td></tr></table></figure></div><ol start="5"><li>å›åˆ° Cloud Consoleï¼Œä¸¦é»æ“Š VM instance çš„ External IP é€£çµï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-38-31.png" alt=""></p><ol start="6"><li>å°±æœƒé–‹å•Ÿæ–°åˆ†é ï¼Œå¯ä»¥çœ‹åˆ° NGINX web server çš„é è¨­ç¶²é ï¼š</li></ol><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-41-35.png" alt=""></p><h2 id="ä½¿ç”¨-gcloud-å»ºç«‹æ–°çš„-instance"><a class="header-anchor" href="#ä½¿ç”¨-gcloud-å»ºç«‹æ–°çš„-instance"></a>ä½¿ç”¨ gcloud å»ºç«‹æ–°çš„ instance</h2><p>å‰é¢ä»‹ç´¹çš„æ˜¯åˆ©ç”¨ GCP Console ä¾†å»ºç«‹ VM instanceï¼Œé€™é‚Šè¦ä»‹ç´¹çš„æ˜¯å¯ä»¥ä½¿ç”¨é è£åœ¨ <a href="https://cloud.google.com/shell/#how_do_i_get_started" target="_blank" rel="noopener">Google Cloud Shell</a> ä¸­çš„ command-line å·¥å…· <code>gcloud</code> ä¾†å®Œæˆä¸€æ¨£çš„äº‹ã€‚Cloud Shell æ˜¯åŸºæ–¼ Debian çš„ VMï¼Œé è¼‰ä½ æ‰€éœ€çš„æ‰€æœ‰é–‹ç™¼å·¥å…· (<code>gcloud</code>ã€<code>git</code> â€¦ ç­‰å…¶ä»–)ï¼Œä¸¦æä¾› 5 GB persistent disk çš„ home ç›®éŒ„ã€‚</p><blockquote><p>è©³æƒ…å¯åƒè€ƒ <a href="https://cloud.google.com/sdk/gcloud/" target="_blank" rel="noopener">gcloud command line tool guide</a>ã€‚</p></blockquote><p>åœ¨ Cloud Shell ä½¿ç”¨ command-line å·¥å…· <code>gcloud</code> å»ºç«‹ä¸€å°æ–°çš„ VM instanceï¼Œå°‡ <code>[YOUR_ZONE]</code> æ›¿æ›æˆå‰é¢ä½¿ç”¨çš„ zoneï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute instances create gcelab2 --machine-type n1-standard-2 --zone [your_zone]</span><br></code></pre></td></tr></table></figure><p>åƒæˆ‘å‰é¢çš„ zone æ˜¯ç”¨ <code>asia-south1-c</code>ï¼Œæ‰€ä»¥æŒ‡ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute instances create gcelab2 --machine-type n1-standard-2 --zone asia-south1-c</span><br>Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-f9d61ede8167e6b0/zones/asia-south1-c/instances/gcelab2].<br>NAME     ZONE           MACHINE_TYPE   PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP   STATUS<br>gcelab2  asia-south1-c  n1-standard-2               10.160.0.3   35.244.6.170  RUNNING<br></code></pre></td></tr></table></figure><p>å»ºç«‹çš„ instance å…·æœ‰ä»¥ä¸‹é è¨­å€¼ï¼š</p><ul><li>æœ€æ–°çš„ <a href="https://cloud.google.com/compute/docs/images#debian" target="_blank" rel="noopener">Debian 9 (stretch)</a> image</li><li>é è¨­æ©Ÿå‹ (machine type) ç‚º <code>n1-standard-2</code>ï¼Œåœ¨æ­¤ lab ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>n1-highmem-4</code> æˆ– <code>n1-highcpu-4</code> å…¶ä»–<a href="https://cloud.google.com/compute/docs/machine-types" target="_blank" rel="noopener">æ©Ÿå‹</a>ã€‚åœ¨ lab ä¹‹å¤–çš„å°ˆæ¡ˆå¯ä»¥æŒ‡å®š<a href="https://cloud.google.com/compute/docs/instances/creating-instance-with-custom-machine-type" target="_blank" rel="noopener">è‡ªè¨‚çš„æ©Ÿå‹</a></li><li>root persistent disk é è¨­èˆ‡ instance çš„åç¨±ä¸€æ¨£ï¼Œdisk æœƒè‡ªå‹•é™„åŠ åˆ° instance</li></ul><p>åŸ·è¡Œä¸‹é¢æŒ‡ä»¤å¯ä»¥æŸ¥çœ‹æ‰€æœ‰é è¨­å€¼ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute instances create --<span class="hljs-built_in">help</span></span><br></code></pre></td></tr></table></figure><div class="info"><p>Noteï¼šå¦‚æœä½ ç¸½æ˜¯ä½¿ç”¨åŒä¸€å€‹ region/zoneï¼Œä¸¦ä¸”ä¸å¸Œæœ›æ¯æ¬¡éƒ½ä½¿ç”¨ <code>--zone</code> åƒæ•¸ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ï¼Œå°‡æŒ‡å®šçš„ region å’Œ zones è¨­ç‚ºé è¨­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud config <span class="hljs-built_in">set</span> compute/zone ...</span><br><span class="hljs-meta">$</span><span class="bash"> gcloud config <span class="hljs-built_in">set</span> compute/region ...</span><br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://cloud.google.com/compute/docs/gcloud-compute/#default-properties" target="_blank" rel="noopener">gcloud compute | Compute Engine Documentation</a> æ–‡ä»¶ã€‚</p></blockquote></div><p>è‹¥è¦æŸ¥çœ‹å‰›å‰›å»ºç«‹çš„ instance æ˜¯å¦æˆåŠŸå»ºç«‹ï¼Œå°±è¦å›åˆ°ã€ŒNavigation menu &gt; Compute Engine &gt; VM Instancesã€é é¢ï¼Œå¦‚æœé‚„æ˜¯æ²’æœ‰çœ‹åˆ°ï¼Œå°±å¯ä»¥é»æ“Šã€ŒREFRESHã€æŒ‰éˆ•é‡æ–°æ•´ç†æ­¤é é¢ï¼Œæ‡‰è©²å°±æœƒçœ‹åˆ°å‰›å‰›å»ºç«‹åç‚º <code>gcelab2</code> çš„ instanceï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-45-59.png" alt=""></p><p>æ¥è‘—ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>gcloud</code> é€é SSH é€£æ¥åˆ°ä½ çš„ instanceï¼Œé€£ç·šæ™‚ï¼Œè«‹ç¢ºèªæŒ‡ä»¤å¾Œé¢ <code>--zone</code> åƒæ•¸çš„ <code>[YOUR_ZONE]</code> æ˜¯å¦å’Œç•¶åˆå»ºç«‹çš„ä¸€æ¨£ï¼Œæˆ–æ˜¯å¦‚æœä½ å·²åœ¨å…¨åŸŸè¨­å®šé è¨­ (ä¸Šé¢ Note æåˆ°çš„éƒ¨åˆ†)ï¼Œå°±å¯ä»¥çœç•¥ <code>--zone</code> åƒæ•¸ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute ssh gcelab2 --zone [YOUR_ZONE]</span><br></code></pre></td></tr></table></figure><p>åƒæˆ‘æ²’æœ‰åœ¨å…¨åŸŸè¨­å®šé è¨­ï¼Œæ‰€ä»¥éœ€è¦åœ¨æŒ‡ä»¤å¾Œé¢åŠ ä¸Š <code>--zone</code> åƒæ•¸ï¼Œ<code>[YOUR_ZONE]</code> å‰‡æ˜¯ç•¶åˆå»ºç«‹çš„ <code>asia-south1-c</code>ï¼ŒæŒ‡ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute ssh gcelab2 --zone asia-south1-c</span><br>WARNING: The public SSH key file for gcloud does not exist.<br>WARNING: The private SSH key file for gcloud does not exist.<br>WARNING: You do not have an SSH key for gcloud.<br>WARNING: SSH keygen will be executed to generate a key.<br>This tool needs to create the directory<br>[/home/google3043863_student/.ssh] before being able to generate SSH<br>keys.<br><br>Do you want to continue (Y/n)?<br></code></pre></td></tr></table></figure><p>æ¥è‘—æœƒå‡ºç¾ä¸‹é¢ç•«é¢ï¼Œè«‹è¼¸å…¥ <code>Y</code> ç¹¼çºŒï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Do you want to continue (Y/n)?  y<br></code></pre></td></tr></table></figure><p>æ­¤æ™‚æœƒç”¢ç”Ÿä¸€å°å…¬é‘° (public key) å’Œç§é‘° (private key)ï¼Œæ¥è‘—æŒ‰ <code>Enter</code> éµï¼Œä¸è¼¸å…¥ä¹Ÿä¸è¨­å®š passphrase (å¦‚æœæ˜¯åœ¨çœŸæ­£çš„å°ˆæ¡ˆå°±å»ºè­°è¼¸å…¥ passphraseï¼Œå› ç‚ºç•¶åˆ¥äººæ‹¿èµ°ä½ çš„ç§é‘°æ™‚ï¼Œå°±ç„¡æ³•ç›´æ¥ç™»å…¥ä¸»æ©Ÿï¼Œé‚„è¦è¼¸å…¥ passphraseï¼Œå®‰å…¨æ€§æœƒæ¯”è¼ƒé«˜)ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs undefined">Generating public/private rsa key pair.<br>Enter passphrase (empty for no passphrase):<br>Enter same passphrase again:<br>Your identification has been saved in /home/google3043863_student/.ssh/google_compute_engine.<br>Your public key has been saved in /home/google3043863_student/.ssh/google_compute_engine.pub.<br>The key fingerprint is:<br>SHA256:LJMylIaZY1aNf2v0uP/a83TSVw506GazmtvrTyPCxqU google3043863_student@cs-6000-devshell-vm-8e6e4e18-0f7e-4771-ac48-22ab57ceb161<br>The key&apos;s randomart image is:<br>+---[RSA 2048]----+<br>|    .o           |<br>|   =...        . |<br>|  B +.        o .|<br>| o +  .oo    o . |<br>|    o +oS+   .* .|<br>|     o o+ + oo *.|<br>|       . . E .+.*|<br>|        . ..o=.+o|<br>|         .oo*==o.|<br>+----[SHA256]-----+<br>Warning: Permanently added &apos;compute.3226821850929314737&apos; (ECDSA) to the list of known hosts.<br>Linux gcelab2 4.9.0-8-amd64 #1 SMP Debian 4.9.144-3.1 (2019-02-19) x86_64<br><br>The programs included with the Debian GNU/Linux system are free software;<br>the exact distribution terms for each program are described in the<br>individual files in /usr/share/doc/*/copyright.<br><br>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>permitted by applicable law.<br>Creating directory &apos;/home/google3043863_student&apos;.<br></code></pre></td></tr></table></figure><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-48-46.png" alt=""></p><h2 id="ä½¿ç”¨-gcloud-è¨­å®šé˜²ç«ç‰†"><a class="header-anchor" href="#ä½¿ç”¨-gcloud-è¨­å®šé˜²ç«ç‰†"></a>ä½¿ç”¨ gcloud è¨­å®šé˜²ç«ç‰†</h2><p>å¦‚æœæˆ‘å·²ç¶“è·Ÿè‘—ä¹‹å‰çš„æ­¥é©Ÿå®‰è£å®Œ NGINX äº†ï¼Œå°±æœƒç™¼ç¾å‰›å‰›å»ºç«‹çš„ instance æ²’æœ‰åšé˜²ç«ç‰†è¨­å®šï¼Œä¹Ÿå°±æ˜¯ä¸å…è¨± 80 port çš„ HTTP æµé‡ï¼Œæ‰€ä»¥å°±å¯ä»¥æ˜¯ç”¨ä¸‹é¢æŒ‡ä»¤ä¾†è¨­å®šï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud compute firewall-rules create nginx --allow tcp:80</span><br></code></pre></td></tr></table></figure><p>åŸ·è¡ŒæŒ‡ä»¤å¾Œæœƒçœ‹åˆ°ä¸‹é¢è¨Šæ¯ï¼Œè¨Šæ¯å…§å®¹æ˜¯ç„¡æ³•å»ºç«‹é˜²ç«ç‰†ï¼Œé€™æ˜¯å› ç‚ºè«‹æ±‚çš„èº«åˆ†æ¬Šé™ä¸è¶³ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Creating firewall...failed.<br>ERROR: (gcloud.compute.firewall-rules.create) Could not fetch resource:<br> - Insufficient Permission: Request had insufficient authentication scopes.<br></code></pre></td></tr></table></figure><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-55-44.png" alt=""></p><p>é‚£å¦‚ä½•çŸ¥é“ç›®å‰çš„æœ‰æ•ˆå¸³è™Ÿåç¨±ï¼Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ä¾†æŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°ç›®å‰çš„å¸³è™Ÿä¸æ˜¯ä¹‹å‰ lab æš«æ™‚çµ¦æˆ‘å€‘ç”¨çš„å¸³è™Ÿï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud auth list</span><br>                  Credentialed Accounts<br>ACTIVE  ACCOUNT<br>*       721269751803-compute@developer.gserviceaccount.com<br><br>To set the active account, run:<br>    $ gcloud config set account `ACCOUNT`<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å¿…é ˆç™»å…¥ä¹‹å‰çš„å¸³è™Ÿï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud auth login</span><br>You are running on a Google Compute Engine virtual machine.<br>It is recommended that you use service accounts for authentication.<br><br>You can run:<br><span class="hljs-meta"><br>  $</span><span class="bash"> gcloud config <span class="hljs-built_in">set</span> account `ACCOUNT`</span><br><br>to switch accounts if necessary.<br><br>Your credentials may be visible to others with access to this<br>virtual machine. Are you sure you want to authenticate with<br>your personal account?<br><br>Do you want to continue (Y/n)?<br></code></pre></td></tr></table></figure><p>æ¥è‘—æœƒå‡ºç¾ä¸‹é¢ç•«é¢ï¼Œè«‹è¼¸å…¥ <code>Y</code> ç¹¼çºŒï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Do you want to continue (Y/n)?<br></code></pre></td></tr></table></figure><p>æ¥è‘—æœƒå‡ºç¾ä¸€é•·ä¸²çš„é€£çµï¼Œé»æ“Šé€™å€‹é€£çµï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">Do you want to continue (Y/n)?  y<br><br>Go to the following link in your browser:<br><br>    https://accounts.google.com/o/oauth2/auth?redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob&amp;prompt=select_account&amp;response_type=code&amp;client_id=32555940559.apps.googleusercontent.com&amp;scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcloud-platform+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fappengine.admin+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcompute+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Faccounts.reauth&amp;access_type=offline<br><br><br>Enter verification code:<br></code></pre></td></tr></table></figure><p>è©²é€£çµå°±æ˜¯è¦ä½ ç”¨ lab æä¾›çš„å¸³è™Ÿç™»å…¥ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-56-52.png" alt=""></p><p>æ¥è‘—è¦åŒæ„ Google Cloud SDK å­˜å–æ­¤å¸³è™Ÿï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-14-57-02.png" alt=""></p><p>æ¥è‘—è¤‡è£½æ­¤æˆæ¬Šç¢¼ï¼Œå°‡æˆæ¬Šç¢¼è²¼è‡³å‰›å‰›çš„ shellï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-20-16-05.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs undefined">Enter verification code: 4/KwEnGIyzJ0P_ZvFeKt5264lP_3CdzZhUb-ZXoEJ0TbVFQVUQyYSBF58<br>WARNING: `gcloud auth login` no longer writes application default credentials.<br>If you need to use ADC, see:<br>  gcloud auth application-default --help<br><br>You are now logged in as [google3043863_student@qwiklabs.net].<br>Your current project is [qwiklabs-gcp-f9d61ede8167e6b0].  You can change this setting by running:<br>  $ gcloud config set project PROJECT_ID<br></code></pre></td></tr></table></figure><p>ç™»å…¥æˆåŠŸå¾Œï¼Œå¯ä»¥å†æ¬¡åŸ·è¡Œä¸‹é¢æŒ‡ä»¤çœ‹ä¸€ä¸‹ç›®å‰æœ‰æ•ˆå¸³è™Ÿçš„åç¨±ï¼Œè®Šæˆ lab æš«æ™‚çµ¦æˆ‘å€‘ç”¨çš„å¸³è™Ÿå›‰ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gcloud auth list</span><br>                  Credentialed Accounts<br>ACTIVE  ACCOUNT<br>        721269751803-compute@developer.gserviceaccount.com<br>*       google3043863_student@qwiklabs.net<br><br>To set the active account, run:<br>    $ gcloud config set account `ACCOUNT`<br></code></pre></td></tr></table></figure><p>æ¥è‘—å†æ¬¡åŸ·è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œå°±å¯ä»¥æˆåŠŸè¨­å®šé˜²ç«ç‰†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs undefined">$ gcloud compute firewall-rules create nginx --allow tcp:80<br>Creating firewall...â ¶Created [https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-f9d61ede8167e6b0/global/firewalls/nginx].<br>Creating firewall...done.<br>NAME   NETWORK  DIRECTION  PRIORITY  ALLOW   DENY  DISABLED<br>nginx  default  INGRESS    1000      tcp:80        False<br></code></pre></td></tr></table></figure><p>é›–ç„¶ GCP Console ä»‹é¢ä¸Š VM instance çš„ External IP æ²’æœ‰è®Šæˆå¯ä»¥é»æ“Šçš„é€£çµï¼Œä½†å¯ä»¥å°‡ External IP è¤‡è£½åˆ°æ–°çš„ç€è¦½å™¨åˆ†é ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-15-00-02.png" alt=""></p><p>å°±èƒ½æˆåŠŸçœ‹åˆ° NGINX web server çš„é è¨­ç¶²é ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-21-04-14.png" alt=""></p><p>ä¸‹åœ–å°±æ˜¯æˆ‘æˆåŠŸå®Œæˆæ­¤ quest çš„ç•«é¢ï¼š</p><p><img src="../images/gcp-vm-nignx-web-server/2019-04-13-15-01-08.png" alt=""></p><h2 id="åƒè€ƒä¾†æº"><a class="header-anchor" href="#åƒè€ƒä¾†æº"></a>åƒè€ƒä¾†æº</h2><ul><li><a href="https://www.qwiklabs.com/focuses/3563?parent=catalog" target="_blank" rel="noopener">Creating a Virtual Machine | Qwiklabs</a></li><li><a href="https://google.qwiklabs.com/focuses/2794?parent=catalog" target="_blank" rel="noopener">A Tour of Qwiklabs and the Google Cloud Platform | Qwiklabs</a></li><li><a href="https://tn710617.github.io/zh-tw/createAVirtualMachineInGCP/" target="_blank" rel="noopener">åœ¨ GCP ä¸Šé–‹ç«‹ä¸€å°è™›æ“¬æ©Ÿ | Rayâ€™s Coding Journey</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/gcp.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;æœ¬ç¯‡æ˜¯ç´€éŒ„åœ¨ Google çš„ Qwiklab å¹³å°å…§ï¼Œå®Œæˆã€Œ&lt;a href=&quot;https://www.qwiklabs.com/focuses/3563?parent=catalog&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Creating a Virtual Machine&lt;/a&gt;ã€é€™å€‹ quest æ‰€å­¸åˆ°çš„å…§å®¹ï¼ŒåŒ…æ‹¬å¦‚ä½•é€é GCP Console å’Œ command-line å·¥å…· &lt;code&gt;gcloud&lt;/code&gt; åœ¨ GCP å»ºç«‹ instanceï¼Œå¦‚ä½•ä½¿ç”¨ &lt;code&gt;gcloud&lt;/code&gt; é€é SSH é€£æ¥åˆ°ä½ çš„ instanceï¼Œä»¥åŠå¦‚ä½•åœ¨ VM ä¸Šéƒ¨ç½² NIGNX web serverã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Cloud" scheme="https://titangene.github.io/categories/cloud/"/>
    
    
      <category term="GCP" scheme="https://titangene.github.io/tags/gcp/"/>
    
      <category term="VM" scheme="https://titangene.github.io/tags/vm/"/>
    
      <category term="NIGNX" scheme="https://titangene.github.io/tags/nignx/"/>
    
      <category term="Web Server" scheme="https://titangene.github.io/tags/web-server/"/>
    
  </entry>
  
  <entry>
    <title>Python çˆ¬èŸ²å¸¸ç”¨æŠ€å·§ (æŒçºŒæ›´æ–°)</title>
    <link href="https://titangene.github.io/article/python-crawler-note.html"/>
    <id>https://titangene.github.io/article/python-crawler-note.html</id>
    <published>2019-02-28T09:33:51.000Z</published>
    <updated>2019-04-30T15:55:09.896Z</updated>
    
    <content type="html"><![CDATA[<p>ç´€éŒ„å€‹äººå¸¸ç”¨çš„ Python çˆ¬èŸ²æŠ€å·§ï¼Œæœªä¾†é‚„æœƒæŒçºŒæ›´æ–°å…¶ä»–æŠ€å·§ã€‚</p><a id="more"></a><h2 id="è¼‰å…¥å¸¸ç”¨å¥—ä»¶"><a class="header-anchor" href="#è¼‰å…¥å¸¸ç”¨å¥—ä»¶"></a>è¼‰å…¥å¸¸ç”¨å¥—ä»¶</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> shutil<br><span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> ET<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlparse, parse_qs, urlunparse<br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">from</span> user_agent <span class="hljs-keyword">import</span> generate_user_agent<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br></code></pre></td></tr></table></figure><h2 id="è§£æ-html"><a class="header-anchor" href="#è§£æ-html"></a>è§£æ HTML</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><br>response = requests.get(url)<br>soup = BeautifulSoup(response.text, <span class="hljs-string">'lxml'</span>)<br>html = soup.find(id=<span class="hljs-string">'some_id'</span>)<br></code></pre></td></tr></table></figure><h2 id="è§£æç¶²å€"><a class="header-anchor" href="#è§£æç¶²å€"></a>è§£æç¶²å€</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlparse, parse_qs, urlunparse<br><br>url = <span class="hljs-string">'http://xxx.com/api/data?id=123&amp;sub_code=06A1297'</span><br>link_parse = urlparse(url)<br>print(link_parse)<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">ParseResult(scheme=&apos;http&apos;, netloc=&apos;xxx.com&apos;, path=&apos;/api/data&apos;, params=&apos;&apos;, query=&apos;id=123&amp;sub_code=06A1297&apos;, fragment=&apos;&apos;)<br></code></pre></td></tr></table></figure><h3 id="å°‡-parseresult-ç‰©ä»¶è½‰æˆç¶²å€å­—ä¸²"><a class="header-anchor" href="#å°‡-parseresult-ç‰©ä»¶è½‰æˆç¶²å€å­—ä¸²"></a>å°‡ <code>ParseResult</code> ç‰©ä»¶è½‰æˆç¶²å€å­—ä¸²</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">url = urlunparse(link_parse)<br>print(url)<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">&apos;http://xxx.com/api/data?id=123&amp;sub_code=06A1297&apos;<br></code></pre></td></tr></table></figure><h3 id="è§£æç¶²å€-query"><a class="header-anchor" href="#è§£æç¶²å€-query"></a>è§£æç¶²å€ query</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">link_query = parse_qs(link_parse.query)<br>print(link_query)<br><br>id = link_query[<span class="hljs-string">'id'</span>][<span class="hljs-number">0</span>]<br>sub_code = link_query[<span class="hljs-string">'sub_code'</span>][<span class="hljs-number">0</span>]<br>print(id, sub_code)<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs undefined">&#123;&apos;id&apos;: [&apos;123&apos;], &apos;sub_code&apos;: [&apos;06A1297&apos;]&#125;<br>123 06A1297<br></code></pre></td></tr></table></figure><h2 id="éš¨æ©Ÿç”Ÿæˆ-user-agent"><a class="header-anchor" href="#éš¨æ©Ÿç”Ÿæˆ-user-agent"></a>éš¨æ©Ÿç”Ÿæˆ user-agent</h2><h3 id="fake-useragent-å¥—ä»¶"><a class="header-anchor" href="#fake-useragent-å¥—ä»¶"></a>fake_useragent å¥—ä»¶</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> fake_useragent <span class="hljs-keyword">import</span> UserAgent<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_header_user_agent</span><span class="hljs-params">()</span>:</span><br>    user_agent = UserAgent()<br>    <span class="hljs-keyword">return</span> user_agent.random<br><br>user_agent = set_header_user_agent()<br>response = requests.get(url, headers=&#123; <span class="hljs-string">'user-agent'</span>: user_agent &#125;)<br></code></pre></td></tr></table></figure><h3 id="user-agent-å¥—ä»¶"><a class="header-anchor" href="#user-agent-å¥—ä»¶"></a>user_agent å¥—ä»¶</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> user_agent <span class="hljs-keyword">import</span> generate_user_agent<br><br>user_agent = generate_user_agent()<br>response = requests.get(url, headers=&#123; <span class="hljs-string">'user-agent'</span>: user_agent &#125;)<br></code></pre></td></tr></table></figure><h2 id="è®€å–è¡¨æ ¼è³‡æ–™"><a class="header-anchor" href="#è®€å–è¡¨æ ¼è³‡æ–™"></a>è®€å–è¡¨æ ¼è³‡æ–™</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>response = requests.get(url)<br>soup = BeautifulSoup(response.text, <span class="hljs-string">'lxml'</span>)<br>html = soup.find(id=<span class="hljs-string">'table_id'</span>)<br>df = pd.read_html(str(html), header=<span class="hljs-number">0</span>)[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><h2 id="è®€å–-è§£æ-json"><a class="header-anchor" href="#è®€å–-è§£æ-json"></a>è®€å–/è§£æ JSON</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><br><span class="hljs-comment"># è®€å–</span><br><span class="hljs-keyword">with</span> open(<span class="hljs-string">'data.json'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> file:<br>    datas = json.load(file)<br><br><span class="hljs-comment"># è§£æ</span><br><span class="hljs-keyword">with</span> open(<span class="hljs-string">'data.json'</span>, <span class="hljs-string">'w'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> file:<br>    json.dump(datas, file, ensure_ascii=<span class="hljs-keyword">False</span>)<br></code></pre></td></tr></table></figure><h2 id="è®€å–-è§£æ-xml"><a class="header-anchor" href="#è®€å–-è§£æ-xml"></a>è®€å–/è§£æ XML</h2><h3 id="è®€å–-xml-æª”"><a class="header-anchor" href="#è®€å–-xml-æª”"></a>è®€å– XML æª”</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> ET<br><br>tree = ET.parse(<span class="hljs-string">'data.xml'</span>)<br>root = tree.getroot()<br></code></pre></td></tr></table></figure><h3 id="è®€å–-xml-å­—ä¸²"><a class="header-anchor" href="#è®€å–-xml-å­—ä¸²"></a>è®€å– XML å­—ä¸²</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> ET<br><br>root = ET.fromstring(some_xml_strings)<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹é¢çš„ XML ç‚ºç¯„ä¾‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bookstore</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">book</span> <span class="hljs-attr">ISBN</span>=<span class="hljs-string">"10-000000-001"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Book 1<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">price</span>&gt;</span>300<span class="hljs-tag">&lt;/<span class="hljs-name">price</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">comments</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">userComment</span> <span class="hljs-attr">rating</span>=<span class="hljs-string">"4"</span>&gt;</span>xxx...<span class="hljs-tag">&lt;/<span class="hljs-name">userComment</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">userComment</span> <span class="hljs-attr">rating</span>=<span class="hljs-string">"2"</span>&gt;</span>yyy...<span class="hljs-tag">&lt;/<span class="hljs-name">userComment</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">comments</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">book</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">book</span> <span class="hljs-attr">ISBN</span>=<span class="hljs-string">"10-000000-999"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Book 2<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">price</span>&gt;</span>500<span class="hljs-tag">&lt;/<span class="hljs-name">price</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">comments</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">userComment</span> <span class="hljs-attr">rating</span>=<span class="hljs-string">"3"</span>&gt;</span>zzz...<span class="hljs-tag">&lt;/<span class="hljs-name">userComment</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">comments</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">book</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bookstore</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="è¿´åœˆå–å¾—å­å…ƒç´ "><a class="header-anchor" href="#è¿´åœˆå–å¾—å­å…ƒç´ "></a>è¿´åœˆå–å¾—å­å…ƒç´ </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> child <span class="hljs-keyword">in</span> root:<br>    print(child.tag, child.attrib)<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs undefined">book &#123;&apos;ISBN&apos;: &apos;10-000000-001&apos;&#125;<br>book &#123;&apos;ISBN&apos;: &apos;10-000000-999&apos;&#125;<br></code></pre></td></tr></table></figure><h3 id="ç”¨-index-å–å¾—æŸå…ƒç´ "><a class="header-anchor" href="#ç”¨-index-å–å¾—æŸå…ƒç´ "></a>ç”¨ index å–å¾—æŸå…ƒç´ </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">root[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>].tag<br>root[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>].text<br>root[<span class="hljs-number">0</span>].attrib<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs undefined">&apos;price&apos;<br>&apos;300&apos;<br>&#123;&apos;ISBN&apos;: &apos;10-000000-001&apos;&#125;<br></code></pre></td></tr></table></figure><h3 id="æœå°‹æŒ‡å®šå…ƒç´ "><a class="header-anchor" href="#æœå°‹æŒ‡å®šå…ƒç´ "></a>æœå°‹æŒ‡å®šå…ƒç´ </h3><p>ä½¿ç”¨ <code>root.iter()</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> comment <span class="hljs-keyword">in</span> root.iter(<span class="hljs-string">'userComment'</span>):<br>    print(comment.attrib)<br>    print(<span class="hljs-string">'comment: &#123;&#125;'</span>.format(comment.text))<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs undefined">&#123;&apos;rating&apos;: &apos;4&apos;&#125;<br>comment: xxx...<br>&#123;&apos;rating&apos;: &apos;2&apos;&#125;<br>comment: yyy...<br>&#123;&apos;rating&apos;: &apos;3&apos;&#125;<br>comment: zzz...<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>root.findall()</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> book <span class="hljs-keyword">in</span> root.findall(<span class="hljs-string">'book'</span>):<br>    ISBN = book.get(<span class="hljs-string">'ISBN'</span>)<br>    title = book.find(<span class="hljs-string">'title'</span>).text<br>    print(ISBN, title)<br></code></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs undefined">10-000000-001 Book 1<br>10-000000-999 Book 2<br></code></pre></td></tr></table></figure><h2 id="ä¸‹è¼‰åœ–ç‰‡"><a class="header-anchor" href="#ä¸‹è¼‰åœ–ç‰‡"></a>ä¸‹è¼‰åœ–ç‰‡</h2><p><code>response.raw</code> æ˜¯ file-like ç‰©ä»¶ï¼Œé è¨­ä¸æœƒè§£å£“ç¸® response (ä½¿ç”¨ gzip æˆ– deflateï¼Œåƒè€ƒè‡³ <a href="https://github.com/kennethreitz/requests/blob/master/requests/utils.py#L808" target="_blank" rel="noopener">Requests åŸå§‹ç¢¼</a>)ï¼Œå¯ä»¥é€éåœ¨ <code>requests.get()</code> æ–¹æ³•ä¸­ï¼Œæ–°å¢åƒæ•¸ <code>stream=True</code> ä¾†å¼·åˆ¶è§£å£“ç¸®ï¼Œä¸¦ä¸”å¯ä»¥é¿å…ç«‹å³å°‡å¤§çš„ response å…§å®¹è®€å…¥è¨˜æ†¶é«”å…§ï¼Œæ¥è‘—ä½¿ç”¨ <code>shutil.copyfileobj()</code> è®“ Python å°‡ ä¸²æµè³‡æ–™è½‰æˆæª”æ¡ˆç‰©ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> shutil<br><br>url = <span class="hljs-string">"http://www.xxx.com/xxx.png"</span><br>response = requests.get(url, stream=<span class="hljs-keyword">True</span>)<br>file_name = url.split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">-1</span>]<br><span class="hljs-keyword">with</span> open(file_name, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> file:<br>    shutil.copyfileobj(response.raw, file)<br></code></pre></td></tr></table></figure><p>å¦‚æœè¦ä¸‹è¼‰æª”æ¡ˆå¤§çš„åœ–ç‰‡ï¼Œå¯åƒè€ƒä¸‹å€‹æ®µè½ã€Œ<a href="#%E4%B8%8B%E8%BC%89%E5%A4%A7%E6%AA%94%E6%A1%88">ä¸‹è¼‰å¤§æª”æ¡ˆ</a>ã€ã€‚</p><div class="info"><p><code>shutil.copyfileobj(fsrc, fdst[, length])</code>ï¼šå°‡ file-like ç‰©ä»¶ <code>fsrc</code> çš„å…§å®¹è¤‡è£½åˆ° file-like ç‰©ä»¶ <code>fdst</code>ã€‚<code>length</code> åƒæ•¸ (int) æ˜¯ buffer çš„å¤§å°ã€‚å¦‚æœ <code>length</code> ç‚ºè² æ•¸å‰‡ä»£è¡¨æ˜¯è¤‡è£½è³‡æ–™ï¼Œè€Œä¸ä»¥ chunk çš„å½¢å¼å¾ªç’°åŸå§‹è³‡æ–™ï¼›é è¨­æ˜¯è³‡æ–™ä»¥ chunk çš„å½¢å¼è®€å–ï¼Œä»¥é¿å…ä¸å—æ§åˆ¶çš„è¨˜æ†¶é«”æ¶ˆè€—ã€‚è«‹æ³¨æ„ï¼Œå¦‚æœ <code>fsrc</code> ç‰©ä»¶çš„ç•¶å‰æª”æ¡ˆä½ç½®ä¸ç‚º 0ï¼Œå‰‡åªè¤‡è£½å¾ç•¶å‰æª”æ¡ˆä½ç½®åˆ°æª”æ¡ˆæœ«ç«¯çš„å…§å®¹ã€‚</p><blockquote><p>åƒè€ƒè‡³ <a href="https://docs.python.org/3/library/shutil.html#shutil.copyfileobj" target="_blank" rel="noopener">shutil - High-level file operations - Python 3.7.3 documentation</a> å®˜æ–¹æ–‡ä»¶ã€‚<br>:::</p></blockquote><blockquote><p>åƒè€ƒä¾†æºï¼š<a href="https://stackoverflow.com/questions/13137817/how-to-download-image-using-requests" target="_blank" rel="noopener">python - How to download image using requests - Stack Overflow</a></p></blockquote><h2 id="ä¸‹è¼‰å¤§æª”æ¡ˆ"><a class="header-anchor" href="#ä¸‹è¼‰å¤§æª”æ¡ˆ"></a>ä¸‹è¼‰å¤§æª”æ¡ˆ</h2><p>ä»¥è¿­ä»£çš„æ–¹å¼å–å¾—ï¼Œé è¨­æœƒä»¥æ¯ 128 byte ç‚ºä¸€å€‹ chunk ä¾†è®€å–è³‡æ–™ (åƒè€ƒè‡³ <a href="https://github.com/kennethreitz/requests/blob/master/requests/models.py#L688" target="_blank" rel="noopener">Requests åŸå§‹ç¢¼</a>)ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>response = requests.get(url, stream=<span class="hljs-keyword">True</span>)<br>file_name = url.split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">-1</span>]<br><span class="hljs-keyword">with</span> open(file_name, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> file:<br>    <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> response:<br>        file.write(chunk)<br></code></pre></td></tr></table></figure><p>è‹¥è¦è‡ªè¨‚ chunk å¤§å°ï¼Œå¯ä½¿ç”¨ <a href="https://github.com/kennethreitz/requests/blob/master/requests/models.py#L729" target="_blank" rel="noopener"><code>Response.iter_content()</code></a> æ–¹æ³•è‡ªè¨‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>file_name = url.split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">-1</span>]<br><span class="hljs-keyword">with</span> requests.get(url, stream=<span class="hljs-keyword">True</span>) <span class="hljs-keyword">as</span> response:<br>    response.raise_for_status()<br>    <span class="hljs-keyword">with</span> open(file_name, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> file:<br>        <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> response.iter_content(chunk_size=<span class="hljs-number">8192</span>):<br>            <span class="hljs-keyword">if</span> chunk: <span class="hljs-comment"># filter out keep-alive new chunks</span><br>                file.write(chunk)<br>                <span class="hljs-comment"># file.flush()</span><br></code></pre></td></tr></table></figure><blockquote><p>åƒè€ƒä¾†æºï¼š<a href="https://stackoverflow.com/questions/16694907/download-large-file-in-python-with-requests" target="_blank" rel="noopener">Download large file in python with requests - Stack Overflow</a></p></blockquote><p>è‹¥æƒ³è¦ä»¥ä¸€æ¬¡ä¸€è¡Œçš„æ–¹å¼è¿­ä»£ response è³‡æ–™ï¼Œå¯ä½¿ç”¨ <a href="https://github.com/kennethreitz/requests/blob/master/requests/models.py#L784" target="_blank" rel="noopener"><code>Response.iter_lines()</code></a> æ–¹æ³•ï¼Œæ­¤æ–¹æ³•é è¨­ä¸€å€‹ chunk çš„å¤§å°ç‚º 512 byteï¼Œè‹¥è¦è¨­å®šåˆ†éš”ç¬¦è™Ÿï¼Œå¯åŠ ä¸Š <code>delimiter</code> åƒæ•¸ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> requests<br><br>r = requests.get(url, stream=<span class="hljs-keyword">True</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> r.iter_lines():<br>    <span class="hljs-comment"># filter out keep-alive new lines</span><br>    <span class="hljs-keyword">if</span> line:<br>        print(json.loads(line))<br></code></pre></td></tr></table></figure><blockquote><p>åƒè€ƒä¾†æºï¼š<a href="https://www.cnblogs.com/linxiyue/p/3980003.html" target="_blank" rel="noopener">Python Requests åº«ï¼šHTTP for Humans - å†è¦‹ç´«ç¾…è˜­ - åšå®¢åœ’</a></p></blockquote></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç´€éŒ„å€‹äººå¸¸ç”¨çš„ Python çˆ¬èŸ²æŠ€å·§ï¼Œæœªä¾†é‚„æœƒæŒçºŒæ›´æ–°å…¶ä»–æŠ€å·§ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="https://titangene.github.io/categories/python/"/>
    
      <category term="Crawler" scheme="https://titangene.github.io/categories/python/crawler/"/>
    
    
      <category term="Python Requests" scheme="https://titangene.github.io/tags/python-requests/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ Hexo ä¸»é¡Œå…§æ–°å¢ç¨‹å¼ç¢¼ç‰‡æ®µè¤‡è£½åŠŸèƒ½</title>
    <link href="https://titangene.github.io/article/hexo-copy-code-snippet-to-clipboard.html"/>
    <id>https://titangene.github.io/article/hexo-copy-code-snippet-to-clipboard.html</id>
    <published>2019-02-09T02:40:00.000Z</published>
    <updated>2019-04-30T15:38:34.184Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/hexo-copy-code-snippet-to-clipboard.jpg" alt=""></p><p>ç‚ºäº†æé«˜ blog çš„ä½¿ç”¨é«”é©—ï¼Œæœ¬æ–‡å°‡èªªæ˜å¦‚ä½•åœ¨ Hexo ä¸»é¡Œå…§ï¼Œæä¾›ç¨‹å¼ç¢¼ç‰‡æ®µè¤‡è£½è‡³å‰ªè²¼ç°¿çš„åŠŸèƒ½ã€‚</p><a id="more"></a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// copy to clipboard</span><br><span class="hljs-keyword">var</span> clipboard = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'pre'</span>);<br></code></pre></td></tr></table></figure><h2 id="è¼‰å…¥-clipboard-js"><a class="header-anchor" href="#è¼‰å…¥-clipboard-js"></a>è¼‰å…¥ clipboard.js</h2><p>åœ¨ <code>themes\material-flow\layout\_partial\scripts.ejs</code> æª”æ¡ˆå…§çš„è¼‰å…¥ clipboard.jsï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="æ–°å¢ç¨‹å¼ç¢¼ç‰‡æ®µè¤‡è£½åŠŸèƒ½"><a class="header-anchor" href="#æ–°å¢ç¨‹å¼ç¢¼ç‰‡æ®µè¤‡è£½åŠŸèƒ½"></a>æ–°å¢ç¨‹å¼ç¢¼ç‰‡æ®µè¤‡è£½åŠŸèƒ½</h2><p>æ¯å€‹ç¨‹å¼ç¢¼ç‰‡æ®µå…§éƒ½è¦æ–°å¢è¤‡è£½åŠŸèƒ½æŒ‰éˆ•ï¼Œä¸‹é¢èªªæ˜æ–°å¢è¤‡è£½æŒ‰éˆ•çš„è™•ç†é‚è¼¯ï¼š</p><ol><li>é¦–å…ˆè¦æ‰¾åˆ°æ‰€æœ‰ç¨‹å¼ç¢¼å€å¡Šï¼š</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> snippets = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'figure.highlight'</span>);<br></code></pre></td></tr></table></figure><ol start="2"><li>æº–å‚™è¦æ–°å¢çš„æŒ‰éˆ•çµæ§‹ï¼š</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> htmlCopyButton = <span class="hljs-string">`<br>  &lt;button class="codecopy-btn tooltipped tooltipped-sw" aria-label="Copy to clipboard"&gt;<br>    &lt;i class="far fa-copy" aria-hidden="true"&gt;&lt;/i&gt;<br>  &lt;/button&gt;`</span>;<br></code></pre></td></tr></table></figure><ol start="3"><li>åœ¨åŸæœ¬çš„ç¨‹å¼ç¢¼å€å¡Šçš„ <code>&lt;figure&gt;</code> æ¨™ç±¤å¤–å¤šåŒ…äº†ä¸€å±¤ <code>&lt;div&gt;</code> æ¨™ç±¤</li><li>åœ¨ <code>&lt;div&gt;</code> æ¨™ç±¤ä¸Šæ–°å¢ <code>.code-highlight</code> class æ¨£å¼</li><li>åœ¨ <code>&lt;div&gt;</code> æ¨™ç±¤ä¸Šæ–°å¢ <code>data-lang</code> å±¬æ€§ç”¨æ–¼è¨˜éŒ„æ­¤ç¨‹å¼ç¢¼å€å¡Šå…§çš„ç¨‹å¼ç¢¼æ˜¯å“ªç¨®ç¨‹å¼èªè¨€</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript">snippets.forEach(<span class="hljs-function"><span class="hljs-params">snippet</span> =&gt;</span> &#123;<br>  <span class="hljs-keyword">var</span> parent = snippet.parentNode;<br>  <span class="hljs-keyword">var</span> wrapper = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);<br><br>  parent.replaceChild(wrapper, snippet);<br>  wrapper.appendChild(snippet);<br><br>  wrapper.classList.add(<span class="hljs-string">'code-highlight'</span>);<br>  wrapper.firstChild.insertAdjacentHTML(<span class="hljs-string">'beforebegin'</span>, htmlCopyButton);<br><br>  <span class="hljs-keyword">var</span> lang = (snippet.classList[<span class="hljs-number">1</span>] || <span class="hljs-string">'code'</span>).toUpperCase();<br>  wrapper.setAttribute(<span class="hljs-string">'data-lang'</span>, lang);<br>&#125;);<br></code></pre></td></tr></table></figure><ol start="6"><li>æ¥è‘—å°‡åç‚º <code>.codecopy-btn</code> çš„ element ä¸Šæ–°å¢è¤‡è£½åŠŸèƒ½ï¼Œè¤‡è£½çš„å…§å®¹æ˜¯ <code>&lt;figure&gt;</code> æ¨™ç±¤å…§çš„ç¨‹å¼ç¢¼ï¼š</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> clipboard = <span class="hljs-keyword">new</span> ClipboardJS(<span class="hljs-string">'.codecopy-btn'</span>, &#123;<br>  <span class="hljs-attr">target</span>: <span class="hljs-function"><span class="hljs-params">trigger</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> trigger.nextSibling;<br>  &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><ol start="7"><li>åªè¦æŒ‰è¤‡è£½æŒ‰éˆ•ä¸”è¤‡è£½æˆåŠŸï¼Œå°±æœƒé¡¯ç¤º <code>Copied!</code> æç¤ºå·²æˆåŠŸè¤‡è£½ç¨‹å¼ç¢¼ç‰‡æ®µï¼š</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">clipboard.on(<span class="hljs-string">'success'</span>, e =&gt; &#123;<br>  e.trigger.setAttribute(<span class="hljs-string">'aria-label'</span>, <span class="hljs-string">'Copied!'</span>);<br>  e.clearSelection();<br>&#125;);<br></code></pre></td></tr></table></figure><ol start="8"><li>å°‡æ¯å€‹è¤‡è£½æŒ‰éˆ•æ–°å¢å…©å€‹ç›£è½äº‹ä»¶ï¼Œåˆ†åˆ¥æ˜¯ <code>mouseleave</code> å’Œ <code>click</code>ï¼š<ul><li><code>mouseleave</code>ï¼šæ»‘é¼ é›¢é–‹æŒ‰éˆ•å°±å°‡æç¤ºæ–‡å­—è®Šæˆ <code>Copy to clipboard</code></li><li><code>click</code>ï¼šå–æ¶ˆäº‹ä»¶çš„é è¨­è¡Œç‚º</li></ul></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> btns = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'.codecopy-btn'</span>);<br><br>btns.forEach(<span class="hljs-function"><span class="hljs-params">btn</span> =&gt;</span> &#123;<br>  btn.addEventListener(<span class="hljs-string">'mouseleave'</span>, e =&gt; &#123;<br>    e.target.setAttribute(<span class="hljs-string">'aria-label'</span>, <span class="hljs-string">'Copy to clipboard'</span>);<br>    e.target.blur();<br>  &#125;);<br><br>  btn.addEventListener(<span class="hljs-string">'click'</span>, e =&gt; &#123;<br>    e.preventDefault();<br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="å®Œæ•´ç¨‹å¼ç¢¼"><a class="header-anchor" href="#å®Œæ•´ç¨‹å¼ç¢¼"></a>å®Œæ•´ç¨‹å¼ç¢¼</h3><p>åœ¨ <code>themes\material-flow\source\js</code> ç›®éŒ„å…§å»ºç«‹ <code>clipboard-use.js</code>ï¼Œæª”æ¡ˆå…§å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs javascript">$(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-comment">// ref: https://github.com/zenorocha/codecopy/blob/master/src/scripts/main.js</span><br>  <span class="hljs-keyword">var</span> snippets = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'figure.highlight'</span>);<br>  <span class="hljs-keyword">var</span> htmlCopyButton = <span class="hljs-string">`<br>    &lt;button class="codecopy-btn tooltipped tooltipped-sw" aria-label="Copy to clipboard"&gt;<br>      &lt;i class="far fa-copy" aria-hidden="true"&gt;&lt;/i&gt;<br>    &lt;/button&gt;`</span>;<br><br>  snippets.forEach(<span class="hljs-function"><span class="hljs-params">snippet</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">var</span> parent = snippet.parentNode;<br>    <span class="hljs-keyword">var</span> wrapper = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);<br><br>    parent.replaceChild(wrapper, snippet);<br>    wrapper.appendChild(snippet);<br><br>    wrapper.classList.add(<span class="hljs-string">'code-highlight'</span>);<br>    wrapper.firstChild.insertAdjacentHTML(<span class="hljs-string">'beforebegin'</span>, htmlCopyButton);<br><br>    <span class="hljs-keyword">var</span> lang = (snippet.classList[<span class="hljs-number">1</span>] || <span class="hljs-string">'code'</span>).toUpperCase();<br>    wrapper.setAttribute(<span class="hljs-string">'data-lang'</span>, lang);<br>  &#125;);<br><br>  <span class="hljs-comment">// Add copy to clipboard functionality and user feedback</span><br>  <span class="hljs-keyword">var</span> clipboard = <span class="hljs-keyword">new</span> ClipboardJS(<span class="hljs-string">'.codecopy-btn'</span>, &#123;<br>    <span class="hljs-attr">target</span>: <span class="hljs-function"><span class="hljs-params">trigger</span> =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> trigger.nextSibling;<br>    &#125;,<br>  &#125;);<br><br>  clipboard.on(<span class="hljs-string">'success'</span>, e =&gt; &#123;<br>    e.trigger.setAttribute(<span class="hljs-string">'aria-label'</span>, <span class="hljs-string">'Copied!'</span>);<br>    e.clearSelection();<br>  &#125;);<br><br>  <span class="hljs-comment">// Replace tooltip message when mouse leaves button</span><br>  <span class="hljs-comment">// and prevent page refresh after click button</span><br>  <span class="hljs-keyword">var</span> btns = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'.codecopy-btn'</span>);<br><br>  btns.forEach(<span class="hljs-function"><span class="hljs-params">btn</span> =&gt;</span> &#123;<br>    btn.addEventListener(<span class="hljs-string">'mouseleave'</span>, e =&gt; &#123;<br>      e.target.setAttribute(<span class="hljs-string">'aria-label'</span>, <span class="hljs-string">'Copy to clipboard'</span>);<br>      e.target.blur();<br>    &#125;);<br><br>    btn.addEventListener(<span class="hljs-string">'click'</span>, e =&gt; &#123;<br>      e.preventDefault();<br>    &#125;);<br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><p>æ¥è‘—åœ¨ <code>themes\material-flow\layout\_partial\scripts.ejs</code> æª”æ¡ˆå…§çš„è¼‰å…¥ <code>clipboard-use.js</code>ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">%-</span> <span class="hljs-attr">js</span>('<span class="hljs-attr">js</span>/<span class="hljs-attr">clipboard-use.js</span>') %&gt;</span><br></code></pre></td></tr></table></figure><h2 id="css-æ¨£å¼"><a class="header-anchor" href="#css-æ¨£å¼"></a>CSS æ¨£å¼</h2><h3 id="æç¤ºæ–‡å­—æ¨£å¼"><a class="header-anchor" href="#æç¤ºæ–‡å­—æ¨£å¼"></a>æç¤ºæ–‡å­—æ¨£å¼</h3><p>åœ¨ <code>themes\material-flow\source\less</code> ç›®éŒ„å…§å»ºç«‹ <code>_tooltipped.less</code>ï¼Œæª”æ¡ˆå…§å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-comment">// ref: https://github.com/primer/primer/blob/master/modules/primer-tooltips/lib/tooltips.scss</span><br><span class="hljs-selector-class">.tooltipped</span> &#123;<br>  <span class="hljs-attribute">position</span>: relative;<br>&#125;<br><br><span class="hljs-comment">// This is the tooltip bubble</span><br><span class="hljs-selector-class">.tooltipped</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>  <span class="hljs-attribute">position</span>: absolute;<br>  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1000000</span>;<br>  <span class="hljs-attribute">display</span>: none;<br>  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0.5em</span> <span class="hljs-number">0.75em</span>;<br>  <span class="hljs-attribute">-webkit-font-smoothing</span>: subpixel-antialiased;<br>  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;<br>  <span class="hljs-attribute">text-align</span>: center;<br>  <span class="hljs-attribute">text-decoration</span>: none;<br>  <span class="hljs-attribute">text-shadow</span>: none;<br>  <span class="hljs-attribute">text-transform</span>: none;<br>  <span class="hljs-attribute">letter-spacing</span>: normal;<br>  <span class="hljs-attribute">word-wrap</span>: break-word;<br>  <span class="hljs-attribute">white-space</span>: pre;<br>  <span class="hljs-attribute">pointer-events</span>: none;<br>  <span class="hljs-attribute">content</span>: attr(aria-label);<br>  <span class="hljs-attribute">background</span>: <span class="hljs-number">#616161</span>;<br>  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">3px</span>;<br>  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// This is the tooltip arrow</span><br><span class="hljs-selector-class">.tooltipped</span><span class="hljs-selector-pseudo">::before</span> &#123;<br>  <span class="hljs-attribute">position</span>: absolute;<br>  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1000001</span>;<br>  <span class="hljs-attribute">display</span>: none;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;<br>  <span class="hljs-attribute">color</span>: <span class="hljs-number">#616161</span>;<br>  <span class="hljs-attribute">pointer-events</span>: none;<br>  <span class="hljs-attribute">content</span>: <span class="hljs-string">''</span>;<br>  <span class="hljs-attribute">border</span>: <span class="hljs-number">6px</span> solid transparent;<br>  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// delay animation for tooltip</span><br><span class="hljs-keyword">@keyframes</span> tooltip-appear &#123;<br>  <span class="hljs-selector-tag">from</span> &#123;<br>    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;<br>  &#125;<br><br>  <span class="hljs-selector-tag">to</span> &#123;<br>    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// This will indicate when we'll activate the tooltip</span><br><span class="hljs-selector-class">.tooltipped</span><span class="hljs-selector-pseudo">:hover</span>,<br><span class="hljs-selector-class">.tooltipped</span><span class="hljs-selector-pseudo">:active</span>,<br><span class="hljs-selector-class">.tooltipped</span><span class="hljs-selector-pseudo">:focus</span> &#123;<br>  <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-pseudo">::before</span>,<br>  <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>    <span class="hljs-attribute">display</span>: inline-block;<br>    <span class="hljs-attribute">text-decoration</span>: none;<br>    <span class="hljs-attribute">animation-name</span>: tooltip-appear;<br>    <span class="hljs-attribute">animation-duration</span>: <span class="hljs-number">0.1s</span>;<br>    <span class="hljs-attribute">animation-fill-mode</span>: forwards;<br>    <span class="hljs-attribute">animation-timing-function</span>: ease-in;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// Tooltipped south</span><br><span class="hljs-selector-class">.tooltipped-s</span>,<br><span class="hljs-selector-class">.tooltipped-sw</span> &#123;<br>  <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>    <span class="hljs-attribute">top</span>: <span class="hljs-number">100%</span>;<br>    <span class="hljs-attribute">right</span>: <span class="hljs-number">50%</span>;<br>    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">6px</span>;<br>  &#125;<br><br>  <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-pseudo">::before</span> &#123;<br>    <span class="hljs-attribute">top</span>: auto;<br>    <span class="hljs-attribute">right</span>: <span class="hljs-number">50%</span>;<br>    <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">7px</span>;<br>    <span class="hljs-attribute">margin-right</span>: -<span class="hljs-number">6px</span>;<br>    <span class="hljs-attribute">border-bottom-color</span>: <span class="hljs-number">#616161</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-selector-class">.tooltipped-sw</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>  <span class="hljs-attribute">margin-right</span>: -<span class="hljs-number">16px</span>;<br>&#125;<br><br><span class="hljs-comment">// Move the tooltip body to the center of the object.</span><br><span class="hljs-selector-class">.tooltipped-s</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>  <span class="hljs-attribute">transform</span>: translateX(<span class="hljs-number">50%</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥è‘—åœ¨ <code>themes\material-flow\source\style.less</code> æª”æ¡ˆå…§çš„è¼‰å…¥ <code>_tooltipped.less</code>ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-keyword">@import</span> <span class="hljs-string">'less/_tooltipped.less'</span>;<br></code></pre></td></tr></table></figure><h3 id="å…¶ä»–æ¨£å¼"><a class="header-anchor" href="#å…¶ä»–æ¨£å¼"></a>å…¶ä»–æ¨£å¼</h3><p>å¯åƒè€ƒæœ¬ç«™çš„å®Œæ•´æ¨£å¼ï¼š<a href="https://github.com/titangene/hexo-blog/blob/master/themes/material-flow/source/less/_article.less" target="_blank" rel="noopener">åŸå§‹ç¢¼</a></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">figure</span> &#123;<br>  <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-class">.highlight</span> &#123;<br>    <span class="hljs-attribute">position</span>: relative;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">1rem</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">padding-top</span>: <span class="hljs-number">22px</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-selector-class">.code-highlight</span> &#123;<br>  <span class="hljs-attribute">position</span>: relative;<br><br>  <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-pseudo">::before</span> &#123;<br>    <span class="hljs-attribute">content</span>: attr(data-lang);<br>    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Roboto Mono'</span>, Consolas, monospace, sans-serif;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.6em</span>;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#b1b1b1</span>;<br>    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">18px</span>;<br>    <span class="hljs-attribute">position</span>: absolute;<br>    <span class="hljs-attribute">top</span>: <span class="hljs-number">4px</span>;<br>    <span class="hljs-attribute">right</span>: <span class="hljs-number">7px</span>;<br>    <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-selector-class">.codecopy-btn</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">24px</span>;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">26px</span>;<br>  <span class="hljs-attribute">position</span>: absolute;<br>  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;<br>  <span class="hljs-attribute">right</span>: -<span class="hljs-number">24px</span>;<br>  <span class="hljs-attribute">border</span>: none;<br>  <span class="hljs-attribute">box-shadow</span>: none;<br>  <span class="hljs-attribute">background</span>: none;<br>  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1</span>;<br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;<br>  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;<br>  <span class="hljs-attribute">transition</span>: color <span class="hljs-number">0.2s</span>;<br><br>  <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-pseudo">:hover</span> &#123;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#7bf</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="demo"><a class="header-anchor" href="#demo"></a>Demo</h2><p>ä¸‹é¢æ˜¯åŸæœ¬çš„ HTMLï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">figure</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"highlight javascript"</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"gutter"</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"line"</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"code"</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"hljs javascript"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">figure</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨å¾Œçš„ HTMLï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"code-highlight"</span> <span class="hljs-attr">data-lang</span>=<span class="hljs-string">"JAVASCRIPT"</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"codecopy-btn tooltipped tooltipped-sw"</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">"Copy to clipboard"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"far fa-copy"</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">figure</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"highlight javascript"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"gutter"</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"line"</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"code"</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"hljs javascript"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">figure</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç•«é¢ï¼š</p><p><img src="../images/hexo-copy-code-snippet-to-clipboard/copy-to-clipboard.gif" alt=""></p><h2 id="åƒè€ƒé€£çµ"><a class="header-anchor" href="#åƒè€ƒé€£çµ"></a>åƒè€ƒé€£çµ</h2><ul><li><a href="https://clipboardjs.com/" target="_blank" rel="noopener">clipboard.js â€” Copy to clipboard without Flash</a></li><li><a href="https://github.com/primer/primer/tree/master/modules/primer-tooltips" target="_blank" rel="noopener">GitHubâ€™s Primer Tooltips</a></li><li><a href="https://github.com/zenorocha/codecopy" target="_blank" rel="noopener">zenorocha/codecopy: A browser extension that adds copy to clipboard buttons on every code block</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/hexo-copy-code-snippet-to-clipboard.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;ç‚ºäº†æé«˜ blog çš„ä½¿ç”¨é«”é©—ï¼Œæœ¬æ–‡å°‡èªªæ˜å¦‚ä½•åœ¨ Hexo ä¸»é¡Œå…§ï¼Œæä¾›ç¨‹å¼ç¢¼ç‰‡æ®µè¤‡è£½è‡³å‰ªè²¼ç°¿çš„åŠŸèƒ½ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Blog" scheme="https://titangene.github.io/categories/blog/"/>
    
    
      <category term="Hexo" scheme="https://titangene.github.io/tags/hexo/"/>
    
      <category term="Code Snippet" scheme="https://titangene.github.io/tags/code-snippet/"/>
    
      <category term="Clipboard" scheme="https://titangene.github.io/tags/clipboard/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ Docker ä¸‹å»ºç«‹ä¸¦ä½¿ç”¨ MSSQL Server for Linux</title>
    <link href="https://titangene.github.io/article/docker-mssql-server-for-linux.html"/>
    <id>https://titangene.github.io/article/docker-mssql-server-for-linux.html</id>
    <published>2019-01-30T15:30:00.000Z</published>
    <updated>2019-04-30T15:57:59.868Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/docker-mssql-server-for-linux.jpg" alt=""></p><p>åœ¨ SQL Server 2017 æ™‚ï¼Œå¾®è»Ÿæ¨å‡ºäº† Linux ç‰ˆï¼ŒåŒæ™‚ä¹Ÿåœ¨ Docker Hub ä¸Šæä¾›äº† <a href="https://hub.docker.com/r/microsoft/mssql-server-linux/" target="_blank" rel="noopener">microsoft/mssql-server-linux</a> çš„ Docker imageã€‚æœ¬ç¯‡æœƒä»‹ç´¹å¦‚ä½•åœ¨ Docker ä¸‹ï¼Œé€éæ­¤ image ä¾†å»ºç«‹ä¸¦ä½¿ç”¨ MSSQL Server for Linuxã€‚</p><a id="more"></a><h2 id="mssql-server-for-linux-è¦æ±‚"><a class="header-anchor" href="#mssql-server-for-linux-è¦æ±‚"></a>MSSQL Server for Linux è¦æ±‚</h2><ul><li>å¿…é ˆ Docker Engine 1.8+ï¼Œæ”¯æ´ä»»ä½•å¹³å° (Windows/Mac/Linux)</li><li>ç¡¬ç¢Ÿç©ºé–“è‡³å°‘ 2 GB</li><li>RAM è‡³å°‘ 2 GB</li><li>image å¿…è¦çš„ç’°å¢ƒè®Šæ•¸ï¼š<ul><li><code>ACCEPT_EULA=Y</code>ï¼šç¢ºèªåŒæ„æˆæ¬Šåˆç´„</li><li><code>MSSQL_SA_PASSWORD=&lt;YourStrong!Passw0rd&gt;</code>ï¼šè¨­å®š SA å¯†ç¢¼</li></ul></li><li>A strong system administrator (SA) å¯†ç¢¼å¿…é ˆç¬¦åˆä»¥ä¸‹è¦å‰‡ï¼š<ul><li>è‡³å°‘ 8 å€‹å­—å…ƒ</li><li>å¿…éœ€åŒ…å«è‹±æ–‡å¤§å¯«ã€è‹±æ–‡å°å¯«ã€æ•¸å­—ã€éå­—æ¯æ•¸å­—ç¬¦è™Ÿå››è€…ä¸­çš„å…¶ä¸­ä¸‰ç¨®å³å¯</li></ul></li></ul><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://docs.microsoft.com/zh-tw/sql/linux/sql-server-linux-setup?view=sql-server-2017#system" target="_blank" rel="noopener">SQL Server on Liunx çš„ç³»çµ±éœ€æ±‚</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="å»ºç«‹-container"><a class="header-anchor" href="#å»ºç«‹-container"></a>å»ºç«‹ Container</h2><p>Docker Hubï¼š<a href="https://hub.docker.com/r/microsoft/mssql-server-linux/" target="_blank" rel="noopener">microsoft/mssql-server-linux</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> å¾ Docker Hub æå– SQL Server 2017 Linux container image<br><span class="hljs-meta">$</span> docker pull microsoft/mssql-server-linux:2017-latest<br><span class="hljs-meta"><br>#</span> å»ºç«‹ä¸¦åŸ·è¡Œ Docker container<br><span class="hljs-meta">$</span> docker run -e 'ACCEPT_EULA=Y' -e 'MSSQL_SA_PASSWORD=&lt;YourStrong!Passw0rd&gt;' \<br>  -p 1401:1433 --name sql1 \<br>  -d microsoft/mssql-server-linux:2017-latest<br></code></pre></td></tr></table></figure><ul><li><code>-e 'ACCEPT_EULA=Y'</code>ï¼šç¢ºèªåŒæ„æˆæ¬Šåˆç´„</li><li><code>-e 'MSSQL_SA_PASSWORD=&lt;YourStrong!Passw0rd&gt;'</code>ï¼šå¿…éœ€æ˜¯å¼·å¯†ç¢¼ä¸¦è‡³å°‘ 8 å€‹å­—å…ƒã€‚å¼·å¯†ç¢¼è‹±æ–‡å¤§å¯«ã€è‹±æ–‡å°å¯«ã€æ•¸å­—ã€éå­—æ¯æ•¸å­—ç¬¦è™Ÿå››è€…ä¸­çš„å…¶ä¸­ä¸‰ç¨®å³å¯ã€‚</li><li><code>-p hostPort:containerPort</code>ï¼šhost å°å¤–é–‹ 1401 portï¼Œcontainer å…§é–‹ 1433 port</li><li><code>--name</code>ï¼šæŒ‡å®š container åç¨±</li><li><code>-d</code>ï¼šèƒŒæ™¯åŸ·è¡Œ</li><li><code>microsoft/mssql-server-linux:2017-latest</code>ï¼šä½¿ç”¨ SQL Server 2017 Linux image å»ºç«‹ container</li></ul><p>å¦‚æœåˆ—è¡¨ <code>NAMES</code> é¡¯ç¤º sql1 ä¸¦ä¸” <code>STATUS</code> é¡¯ç¤º UP å°±ä»£è¡¨ SQL Server å·²åœ¨èƒŒæ™¯åŸ·è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> æŸ¥çœ‹ container çš„ç‹€æ…‹<br><span class="hljs-meta">$</span> docker ps<br>CONTAINER ID   IMAGE                                      COMMAND                  CREATED          STATUS          PORTS                    NAMES<br>08e2f151d579   microsoft/mssql-server-linux:2017-latest   "/bin/sh -c /opt/mssâ€¦"   31 minutes ago   Up 31 minutes   0.0.0.0:1401-&gt;1433/tcp   sql1<br></code></pre></td></tr></table></figure><h2 id="é€£æ¥è‡³-sql-server"><a class="header-anchor" href="#é€£æ¥è‡³-sql-server"></a>é€£æ¥è‡³ SQL Server</h2><p>ä½¿ç”¨ SQL Server å‘½ä»¤åˆ—å·¥å…· <code>sqlcmd</code>ï¼Œé€£æ¥åˆ° SQL Server containerï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> åœ¨å¤–éƒ¨å‘åŸ·è¡Œä¸­çš„ container å…§éƒ¨ä¸‹æŒ‡ä»¤ï¼Œå•Ÿå‹• Container å…§éƒ¨çš„äº’å‹•å¼ bash shellï¼Œä¾†åŸ·è¡Œä½ ä¸‹çš„æŒ‡ä»¤<br><span class="hljs-meta">$</span> docker exec -it sql1 bash<br><span class="hljs-meta"><br>#</span> ä½¿ç”¨ SQL Server å‘½ä»¤åˆ—å·¥å…· `sqlcmd`ï¼Œä¸¦ç™»å…¥å¸³è™Ÿå¯†ç¢¼é€£æ¥åˆ° SQL Server<br><span class="hljs-meta">$</span> /opt/mssql-tools/bin/sqlcmd -S localhost -U SA<br>Password:<br><span class="hljs-meta"><br>#</span> å‡ºç¾ "1&gt;" å°±ä»£è¡¨å·²æˆåŠŸç™»å…¥ä¸¦å·²é€²å…¥ sqlcmd<br><span class="hljs-meta">1&gt;</span><br></code></pre></td></tr></table></figure><h2 id="è®Šæ›´-sa-çš„å¯†ç¢¼"><a class="header-anchor" href="#è®Šæ›´-sa-çš„å¯†ç¢¼"></a>è®Šæ›´ SA çš„å¯†ç¢¼</h2><p>SA å¸³è™Ÿæ˜¯åœ¨å®‰è£æœŸé–“å»ºç«‹çš„ SQL Server å¯¦ä¾‹ä¸Šçš„ç³»çµ±ç®¡ç†å“¡ã€‚å»ºç«‹ SQL Server container ä¹‹å¾Œï¼Œåœ¨ container ä¸­åŸ·è¡Œ <code>echo $MSSQL_SA_PASSWORD</code>ï¼Œå³å¯æŸ¥çœ‹ SA çš„å¯†ç¢¼ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> docker exec -it sql1 bash<br>root@xxx:/# echo $MSSQL_SA_PASSWORD<br>YourStrong!Passw0rd<br></code></pre></td></tr></table></figure><p>åŸ·è¡Œä¸‹é¢æŒ‡ä»¤å¯ä»¥è®Šæ›´ SA çš„å¯†ç¢¼ï¼Œè€Œ <code>opt/mssql-tools/bin/sqlcmd</code> æ˜¯ <code>sqlcmd</code> æ‰€åœ¨çš„è·¯å¾‘ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> docker exec -it sql1 /opt/mssql-tools/bin/sqlcmd \<br>  -S localhost -U SA -P '&lt;YourStrong!Passw0rd&gt;' \<br>  -Q 'ALTER LOGIN SA WITH PASSWORD="&lt;YourNewStrong!Passw0rd&gt;"'<br></code></pre></td></tr></table></figure><p>åƒæ•¸èªªæ˜ï¼š</p><ul><li><code>-S</code>ï¼šserver</li><li><code>-U</code>ï¼šuser name</li><li><code>-P</code>ï¼špassword</li><li><code>-Q</code>ï¼šqueryï¼ŒåŸ·è¡Œ SQL æŒ‡ä»¤å¾ŒçµæŸ <code>sqlcmd</code></li></ul><h2 id="å»ºç«‹è³‡æ–™åº«åŠæŸ¥è©¢è³‡æ–™"><a class="header-anchor" href="#å»ºç«‹è³‡æ–™åº«åŠæŸ¥è©¢è³‡æ–™"></a>å»ºç«‹è³‡æ–™åº«åŠæŸ¥è©¢è³‡æ–™</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> æŸ¥è©¢ server ä¸Šæ‰€æœ‰ DB åç¨±<br><span class="hljs-meta">1&gt;</span> SELECT Name from sys.Databases<br><span class="hljs-meta">#</span> åœ¨ sqlcmd æŒ‡ä»¤æ¨¡å¼ä¸‹ï¼Œè¦è¼¸å…¥ GO æŒ‡ä»¤æ‰æœƒåŸ·è¡Œ<br><span class="hljs-meta">2&gt;</span> GO<br>Name<br>------------<br>master<br>tempdb<br>model<br>msdb<br><br>(4 rows affected)<br><span class="hljs-meta"><br>#</span> å»ºç«‹è³‡æ–™åº«<br><span class="hljs-meta">1&gt;</span> CREATE DATABASE TestDB<br><span class="hljs-meta">2&gt;</span> GO<br><span class="hljs-meta">#</span> å‡ºç¾ä¸‹é¢ç•«é¢ "1&gt;" å°±ä»£è¡¨å·²æˆåŠŸå»ºç«‹è³‡æ–™åº«<br><span class="hljs-meta">1&gt;</span><br><span class="hljs-meta"><br>#</span> é›¢é–‹ sqlcmd<br><span class="hljs-meta">1&gt;</span> quit<br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-azure-data-studio-é€£æ¥-sql-server"><a class="header-anchor" href="#ä½¿ç”¨-azure-data-studio-é€£æ¥-sql-server"></a>ä½¿ç”¨ Azure Data Studio é€£æ¥ SQL Server</h2><p><a href="https://github.com/Microsoft/azuredatastudio" target="_blank" rel="noopener">Azure Data Studio</a> (ä»¥å‰ç¨±ç‚º SQL Operations Studio) æ˜¯ä¸€å€‹è¼•é‡ä¸”å…è²»çš„è·¨å¹³å° SQL Server é–‹æºç®¡ç†å·¥å…·ï¼Œæ”¯æ´ Windowsã€macOSã€Linuxã€‚</p><p><img src="../images/docker-mssql-server-for-linux/2019-01-30_21-20-32.png" alt=""></p><h3 id="å®‰è£-azure-data-studio"><a class="header-anchor" href="#å®‰è£-azure-data-studio"></a>å®‰è£ Azure Data Studio</h3><h4 id="for-windows"><a class="header-anchor" href="#for-windows"></a>for Windows</h4><p>ä¸‹è¼‰ä¸¦è§£å£“ç¸®ï¼Œæ¥è‘—åŸ·è¡Œ <code>\azuredatastudio-windows\sqlops.exe</code> å³å¯é–‹å§‹ä½¿ç”¨ã€‚</p><h4 id="for-linux"><a class="header-anchor" href="#for-linux"></a>for Linux</h4><p>ä¸‹è¼‰ä¸¦è§£å£“ç¸®ï¼Œæ¥è‘—å°‡ Azure Data Studio åŸ·è¡Œæª”åŠ å…¥ <code>PATH</code> ç’°å¢ƒè®Šæ•¸ï¼Œä»¥å¾Œå³å¯åœ¨çµ‚ç«¯æ©Ÿè¼¸å…¥ <code>azuredatastudio</code> é–‹å•Ÿ Azure Data Studioï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> cd ~<br><span class="hljs-meta">$</span> cp ~/Downloads/azuredatastudio-linux-&lt;version string&gt;.tar.gz ~<br><span class="hljs-meta">$</span> tar -xvf ~/azuredatastudio-linux-&lt;version string&gt;.tar.gz<br><span class="hljs-meta">$</span> echo 'export PATH="$PATH:~/azuredatastudio-linux-x64"' &gt;&gt; ~/.bashrc<br><span class="hljs-meta">$</span> source ~/.bashrc<br><span class="hljs-meta">$</span> azuredatastudio<br></code></pre></td></tr></table></figure><h4 id="for-macos"><a class="header-anchor" href="#for-macos"></a>for macOS</h4><p>ä¸‹è¼‰ä¸¦è§£å£“ç¸®ï¼Œç„¶å¾Œå°‡ Azure Data Studio åŠ å…¥ Launchpadï¼Œå°‡ <code>Studio.app</code> æ‹–æ›³åˆ°æ‡‰ç”¨ç¨‹å¼ç›®éŒ„ (Applications folder) å³å¯ã€‚</p><blockquote><p>å®‰è£è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://docs.microsoft.com/zh-tw/sql/azure-data-studio/download?view=sql-server-2017" target="_blank" rel="noopener">ä¸‹è¼‰ä¸¦å®‰è£ - Azure Data Studio | Microsoft Docs</a> æ–‡ä»¶ã€‚</p></blockquote><h3 id="ç™»å…¥-sql-server"><a class="header-anchor" href="#ç™»å…¥-sql-server"></a>ç™»å…¥ SQL Server</h3><p>Server name çš„æ ¼å¼ï¼š <code>IP, Port</code></p><ul><li>IPï¼š<ul><li>Linuxï¼šä½¿ç”¨ <code>ifconfig</code> æŒ‡ä»¤æŸ¥è©¢ IP</li><li>Windowsï¼šä½¿ç”¨ <code>ipconfig</code> æŒ‡ä»¤æŸ¥è©¢ IP</li></ul></li><li>Portï¼šè¦çœ‹å‰é¢å»ºç«‹çš„ container æ˜¯è¨­å®šå¤šå°‘ Port</li></ul><p>æ­¤ç¯„ä¾‹ (ä¹Ÿå°±æ˜¯ä¸‹é¢çš„æŒ‡ä»¤) æ˜¯è¨­å®šä½¿ç”¨ 1401 portï¼Œæ‰€ä»¥åªè¦è¼¸å…¥ <code>YourIP, 1401</code> å°±èƒ½èˆ‡ SQL Server é€£æ¥ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> docker run -e 'ACCEPT_EULA=Y' -e 'MSSQL_SA_PASSWORD=&lt;YourStrong!Passw0rd&gt;' \<br>  -p 1401:1433 --name sql1 \<br>  -d microsoft/mssql-server-linux:2017-latest<br></code></pre></td></tr></table></figure><p><img src="../images/docker-mssql-server-for-linux/2019-01-30_23-02-20.png" alt=""></p><h2 id="å»ºç«‹è³‡æ–™è¡¨å’Œè³‡æ–™-ä¸¦æŸ¥è©¢è³‡æ–™"><a class="header-anchor" href="#å»ºç«‹è³‡æ–™è¡¨å’Œè³‡æ–™-ä¸¦æŸ¥è©¢è³‡æ–™"></a>å»ºç«‹è³‡æ–™è¡¨å’Œè³‡æ–™ï¼Œä¸¦æŸ¥è©¢è³‡æ–™</h2><p>åŸ·è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œå»ºç«‹è³‡æ–™è¡¨å’Œè³‡æ–™ï¼Œä¸¦æŸ¥è©¢è³‡æ–™ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- åˆ‡æ›è‡³ TestDB è³‡æ–™åº«</span><br><span class="hljs-keyword">use</span> TestDB;<br><span class="hljs-comment">-- å»ºç«‹è³‡æ–™è¡¨</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> People(<span class="hljs-keyword">Name</span> <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">50</span>), Age <span class="hljs-built_in">int</span>);<br><span class="hljs-comment">-- æ–°å¢è³‡æ–™</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> People <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Titan'</span>, <span class="hljs-number">18</span>), (<span class="hljs-string">'John'</span>, <span class="hljs-number">6</span>), (<span class="hljs-string">'Alex'</span>, <span class="hljs-number">40</span>);<br><span class="hljs-comment">-- æŸ¥è©¢å¹´é½¡å°æ–¼ 20 æ­²çš„äºº</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> People <span class="hljs-keyword">WHERE</span> Age &lt; <span class="hljs-number">20</span>;<br></code></pre></td></tr></table></figure><p>åŸ·è¡Œå®Œçš„çµæœå¦‚ä¸‹åœ–ï¼Œçœ‹åˆ°æ­¤æŸ¥è©¢çµæœå°±ä»£è¡¨å·²æˆåŠŸæ–°å¢è³‡æ–™ï¼š</p><p><img src="../images/docker-mssql-server-for-linux/2019-01-30_21-20-32.png" alt=""></p><h2 id="åˆªé™¤-container"><a class="header-anchor" href="#åˆªé™¤-container"></a>åˆªé™¤ Container</h2><p>æŒ‡å®šåˆªé™¤åç‚º <code>sql1</code> çš„ containerï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> æŸ¥è©¢ç›®å‰çš„æ­£åœ¨åŸ·è¡Œçš„ container<br><span class="hljs-meta">$</span> docker ps<br><span class="hljs-meta"><br>#</span> container åœæ­¢åŸ·è¡Œ<br><span class="hljs-meta">$</span> docker stop sql<br><span class="hljs-meta"><br>#</span> åˆªé™¤ container<br><span class="hljs-meta">$</span> docker rm sql1<br></code></pre></td></tr></table></figure><p>æˆ–æ˜¯å¯ä»¥åœ¨æœªåœæ­¢åŸ·è¡Œ container çš„æƒ…æ³ä¸‹ï¼Œç›´æ¥å¼·åˆ¶åˆªé™¤ containerï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> å¼·åˆ¶åˆªé™¤ container<br><span class="hljs-meta">$</span> docker rm -f sql1<br></code></pre></td></tr></table></figure><h2 id="é€é-volume-å°‡è³‡æ–™åº«çš„è³‡æ–™å„²å­˜è‡³ä¸»æ©Ÿ"><a class="header-anchor" href="#é€é-volume-å°‡è³‡æ–™åº«çš„è³‡æ–™å„²å­˜è‡³ä¸»æ©Ÿ"></a>é€é Volume å°‡è³‡æ–™åº«çš„è³‡æ–™å„²å­˜è‡³ä¸»æ©Ÿ</h2><p>åœ¨ <code>docker run</code> æŒ‡ä»¤ä¸ŠåŠ  <code>-v</code> åƒæ•¸å¯ä»¥å»ºç«‹å¯¦é«”è³‡æ–™å¤¾èˆ‡ container è³‡æ–™å¤¾çš„å°æ‡‰é—œä¿‚ï¼Œå°‡ä¸»æ©Ÿä¸Šçš„æŒ‡å®šç›®éŒ„ç¶å®šåˆ° container çš„æŒ‡å®šç›®éŒ„ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å­˜è³‡æ–™åº«çš„è³‡æ–™è‡³ä¸»æ©Ÿï¼Œåƒæ•¸èªæ³•ç‚º <code>-v &lt;host directory&gt;:/var/opt/mssql</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> åŸ·è¡Œ Docker container image<br><span class="hljs-meta">$</span> docker run -e 'ACCEPT_EULA=Y' -e 'MSSQL_SA_PASSWORD=&lt;YourStrong!Passw0rd&gt;' \<br>  -p 1402:1433 --name sql2 \<br>  -v `pwd`/mssql:/var/opt/mssql \<br>  -d microsoft/mssql-server-linux:2017-latest<br></code></pre></td></tr></table></figure><h2 id="å‚™ä»½èˆ‡é‚„åŸè³‡æ–™åº«"><a class="header-anchor" href="#å‚™ä»½èˆ‡é‚„åŸè³‡æ–™åº«"></a>å‚™ä»½èˆ‡é‚„åŸè³‡æ–™åº«</h2><h3 id="ç¯„ä¾‹å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™åº«-è³‡æ–™è¡¨å’Œè³‡æ–™"><a class="header-anchor" href="#ç¯„ä¾‹å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™åº«-è³‡æ–™è¡¨å’Œè³‡æ–™"></a>ç¯„ä¾‹å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™åº«ã€è³‡æ–™è¡¨å’Œè³‡æ–™</h3><p>ä¸‹é¢çš„ SQL æŒ‡ä»¤æ˜¯ç”¨ä¾†ç«‹è³‡æ–™åº«ã€è³‡æ–™è¡¨å’Œè³‡æ–™ï¼Œå› ç‚ºæ­¤ container æ˜¯å‰›å‰›å¦å¤–æ–°å»ºçš„ï¼Œä¹‹å‰çš„ container å·²ç¶“åˆªé™¤äº† (å› ç‚ºæ²’æœ‰åˆ©ç”¨ Volume å„²å­˜è³‡æ–™åº«çš„è³‡æ–™)ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°å»ºç«‹è³‡æ–™ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- å»ºç«‹ è³‡æ–™åº«</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> TestDB;<br>GO<br><span class="hljs-comment">-- åˆ‡æ›è‡³ TestDB è³‡æ–™åº«</span><br><span class="hljs-keyword">use</span> TestDB;<br><span class="hljs-comment">-- å»ºç«‹è³‡æ–™è¡¨</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> People(<span class="hljs-keyword">Name</span> <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">50</span>), Age <span class="hljs-built_in">int</span>);<br><span class="hljs-comment">-- æ–°å¢è³‡æ–™</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> People <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Titan'</span>, <span class="hljs-number">18</span>), (<span class="hljs-string">'John'</span>, <span class="hljs-number">6</span>), (<span class="hljs-string">'Alex'</span>, <span class="hljs-number">40</span>);<br></code></pre></td></tr></table></figure><h3 id="å‚™ä»½è³‡æ–™åº«"><a class="header-anchor" href="#å‚™ä»½è³‡æ–™åº«"></a>å‚™ä»½è³‡æ–™åº«</h3><p>ä½¿ç”¨ sqlcmd é€£æ¥åˆ° SQL Serverï¼Œä¸¦å®Œæ•´å‚™ä»½ TestDB è³‡æ–™åº«ï¼Œå‚™ä»½æª”å­˜è‡³ <code>./data/testdb.bak</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> docker exec -it sql2 /opt/mssql-tools/bin/sqlcmd -S localhost -U SA \<br>  -Q "BACKUP DATABASE TestDB TO DISK = N'/var/opt/mssql/data/testdb.bak' WITH NOFORMAT, NOINIT, NAME = 'demodb-full', SKIP, NOREWIND, NOUNLOAD, STATS = 10"<br></code></pre></td></tr></table></figure><p>ç•¶åŸ·è¡Œæ­¤æŒ‡ä»¤æ™‚ï¼ŒSQL Server å°‡æœƒæç¤ºéœ€è¼¸å…¥å¯†ç¢¼ã€‚è¼¸å…¥å¯†ç¢¼å¾Œï¼Œå¾ˆå¿«å°±æœƒå‚™ä»½å®Œæˆï¼Œå¦‚æœå‚™ä»½æˆåŠŸç•«é¢å°±æœƒé¡¯ç¤ºã€ŒBACKUP DATABASE successfully â€¦ã€ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">Password: <br>10 percent processed.<br>20 percent processed.<br>30 percent processed.<br>40 percent processed.<br>50 percent processed.<br>60 percent processed.<br>70 percent processed.<br>80 percent processed.<br>90 percent processed.<br>Processed 312 pages for database 'TestDB', file 'TestDB' on file 1.<br>100 percent processed.<br>Processed 6 pages for database 'TestDB', file 'TestDB_log' on file 1.<br>BACKUP DATABASE successfully processed 318 pages in 0.348 seconds (7.139 MB/sec).<br></code></pre></td></tr></table></figure><h3 id="ç¯„ä¾‹å‰ç½®è™•ç†ï¼šåˆªé™¤-container-å’Œè³‡æ–™åº«è³‡æ–™"><a class="header-anchor" href="#ç¯„ä¾‹å‰ç½®è™•ç†ï¼šåˆªé™¤-container-å’Œè³‡æ–™åº«è³‡æ–™"></a>ç¯„ä¾‹å‰ç½®è™•ç†ï¼šåˆªé™¤ container å’Œè³‡æ–™åº«è³‡æ–™</h3><p>ä¸‹é¢æ˜¯è¦æ¨¡æ“¬æŠŠ container åˆªé™¤å¾Œï¼Œè¦å¦‚ä½•å°‡å‰›å‰›å‚™ä»½çš„è³‡æ–™åº«è³‡æ–™ (ä¹Ÿå°±æ˜¯ <code>./data/testdb.bak</code> ) é‚„åŸï¼Œå› æ­¤ä¹Ÿè¦åˆªé™¤é€é Volume å„²å­˜çš„è³‡æ–™åº«è³‡æ–™ï¼Œå¦‚ä»¥ä¸‹æ­¥é©Ÿï¼š</p><ol><li>åˆªé™¤ container</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> æŸ¥è©¢ç›®å‰çš„æ­£åœ¨åŸ·è¡Œçš„ container<br><span class="hljs-meta">$</span> docker ps<br><span class="hljs-meta">#</span> å¼·åˆ¶åˆªé™¤ container<br><span class="hljs-meta">$</span> docker rm -f sql2<br></code></pre></td></tr></table></figure><ol start="2"><li>åˆªé™¤é€é Volume å„²å­˜çš„è³‡æ–™åº«è³‡æ–™</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> æŸ¥çœ‹å‰›å‰›åˆªé™¤çš„ container ä¿å­˜ä¸‹ä¾†çš„ DB è³‡æ–™æª” (TestDB_log.ldf å’Œ TestDB.mdf)<br><span class="hljs-meta">$</span> cd mssql/data<br><span class="hljs-meta">$</span> pwd<br>/home/titan/project/mssql/data<br><span class="hljs-meta">$</span> tree<br>â”œâ”€â”€ master.mdf<br>â”œâ”€â”€ mastlog.ldf<br>â”œâ”€â”€ modellog.ldf<br>â”œâ”€â”€ model.mdf<br>â”œâ”€â”€ msdbdata.mdf<br>â”œâ”€â”€ msdblog.ldf<br>â”œâ”€â”€ tempdb.mdf<br>â”œâ”€â”€ templog.ldf<br>â”œâ”€â”€ testdb.bak<br>â”œâ”€â”€ TestDB_log.ldf   &lt;---<br>â””â”€â”€ TestDB.mdf       &lt;---<br><span class="hljs-meta"><br>#</span> åˆªé™¤ TestDB.mdf å’Œ TestDB_log.ldf<br><span class="hljs-meta">$</span> sudo rm TestDB*<br><span class="hljs-meta">$</span> tree<br>â”œâ”€â”€ master.mdf<br>â”œâ”€â”€ mastlog.ldf<br>â”œâ”€â”€ modellog.ldf<br>â”œâ”€â”€ model.mdf<br>â”œâ”€â”€ msdbdata.mdf<br>â”œâ”€â”€ msdblog.ldf<br>â”œâ”€â”€ tempdb.mdf<br>â”œâ”€â”€ templog.ldf<br>â””â”€â”€ testdb.bak<br></code></pre></td></tr></table></figure><ol start="3"><li>åœ¨å»ºç«‹ä¸€å€‹æ–°çš„ container (ç”¨ä¾†åšé‚„åŸè³‡æ–™åº«ç”¨çš„)</li></ol><p>å…ˆå›åˆ°å°ˆæ¡ˆçš„æ ¹ç›®éŒ„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> pwd<br>/home/titan/project/mssql/data<br><span class="hljs-meta">$</span> cd ../..<br><span class="hljs-meta">$</span> pwd<br>/home/titan/project<br></code></pre></td></tr></table></figure><p>æ¥è‘—å»ºç«‹ä¸€å€‹æ–°çš„ containerï¼Œåç¨±å«åš sql3ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> docker run -e 'ACCEPT_EULA=Y' -e 'MSSQL_SA_PASSWORD=&lt;YourStrong!Passw0rd&gt;' \<br>  -p 1403:1433 --name sql3 \<br>  -v `pwd`/mssql:/var/opt/mssql \<br>  -d microsoft/mssql-server-linux:2017-latest<br></code></pre></td></tr></table></figure><h3 id="é‚„åŸè³‡æ–™åº«"><a class="header-anchor" href="#é‚„åŸè³‡æ–™åº«"></a>é‚„åŸè³‡æ–™åº«</h3><p>ä½¿ç”¨ sqlcmd é€£æ¥åˆ° SQL Serverï¼Œä¸¦é‚„åŸ TestDB è³‡æ–™åº« (è¦é‚„åŸçš„å‚™ä»½æª”å­˜è‡³ <code>./data/testdb.bak</code> )ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> docker exec -it sql3 /opt/mssql-tools/bin/sqlcmd -S localhost -U SA \<br>  -Q "RESTORE DATABASE TestDB FROM DISK = N'/var/opt/mssql/data/testdb.bak' WITH  FILE = 1, NOUNLOAD, REPLACE, STATS = 5"<br></code></pre></td></tr></table></figure><p>ç•¶åŸ·è¡Œæ­¤æŒ‡ä»¤æ™‚ï¼ŒSQL Server å°‡æœƒæç¤ºéœ€è¼¸å…¥å¯†ç¢¼ã€‚è¼¸å…¥å¯†ç¢¼å¾Œï¼Œå¾ˆå¿«å°±æœƒé‚„åŸå®Œæˆï¼Œå¦‚æœé‚„åŸæˆåŠŸç•«é¢å°±æœƒé¡¯ç¤ºã€ŒRESTORE DATABASE successfully â€¦ã€ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs shell">Password: <br>6 percent processed.<br>11 percent processed.<br>15 percent processed.<br>20 percent processed.<br>25 percent processed.<br>31 percent processed.<br>36 percent processed.<br>41 percent processed.<br>45 percent processed.<br>50 percent processed.<br>57 percent processed.<br>61 percent processed.<br>66 percent processed.<br>70 percent processed.<br>75 percent processed.<br>82 percent processed.<br>86 percent processed.<br>91 percent processed.<br>95 percent processed.<br>100 percent processed.<br>Processed 344 pages for database 'TestDB', file 'TestDB' on file 1.<br>Processed 7 pages for database 'TestDB', file 'TestDB_log' on file 1.<br>RESTORE DATABASE successfully processed 351 pages in 0.321 seconds (8.530 MB/sec).<br></code></pre></td></tr></table></figure><p>æª¢æŸ¥ä¸€ä¸‹å‰›å‰›åˆªé™¤çš„ <code>TestDB.mdf</code> å’Œ <code>TestDB_log.ldf</code> éƒ½æ­£ç¢ºçš„é‚„åŸäº†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> cd mssql/data<br><span class="hljs-meta">$</span> tree<br>â”œâ”€â”€ master.mdf<br>â”œâ”€â”€ mastlog.ldf<br>â”œâ”€â”€ modellog.ldf<br>â”œâ”€â”€ model.mdf<br>â”œâ”€â”€ msdbdata.mdf<br>â”œâ”€â”€ msdblog.ldf<br>â”œâ”€â”€ tempdb.mdf<br>â”œâ”€â”€ templog.ldf<br>â”œâ”€â”€ testdb.bak<br>â”œâ”€â”€ TestDB_log.ldf   &lt;---<br>â””â”€â”€ TestDB.mdf       &lt;---<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>select</code> SQL æŒ‡ä»¤å¯ä»¥çœ‹åˆ°è³‡æ–™ç¢ºå¯¦å·²é‚„åŸï¼š</p><p><img src="../images/docker-mssql-server-for-linux/2019-01-30_22-04-08.png" alt=""></p><h2 id="ä½¿ç”¨-azure-data-studio-å‚™ä»½æˆ–é‚„åŸè³‡æ–™åº«"><a class="header-anchor" href="#ä½¿ç”¨-azure-data-studio-å‚™ä»½æˆ–é‚„åŸè³‡æ–™åº«"></a>ä½¿ç”¨ Azure Data Studio å‚™ä»½æˆ–é‚„åŸè³‡æ–™åº«</h2><p>å¦‚æœè¦ºå¾—æ‰“æŒ‡ä»¤å¾ˆéº»ç…©ï¼Œå…¶å¯¦ Azure Data Studioã€<a href="https://docs.microsoft.com/zh-tw/sql/linux/sql-server-linux-manage-ssms?view=sql-server-2017" target="_blank" rel="noopener">SQL Server Management Studio (SSMS)</a>ã€<a href="https://docs.microsoft.com/zh-tw/sql/linux/sql-server-linux-develop-use-ssdt?view=sql-server-2017" target="_blank" rel="noopener">SQL Server Data Tools (SSDT)</a> æˆ– <a href="https://docs.microsoft.com/zh-tw/sql/linux/sql-server-linux-develop-use-vscode?view=sql-server-2017" target="_blank" rel="noopener">Visual Studio Code (VS Code) çš„ mssql æ“´å……åŠŸèƒ½</a> éƒ½æœ‰æä¾› GUI çš„ä»‹é¢ï¼Œå¯ä»¥ç›´æ¥å‚™ä»½æˆ–é‚„åŸè³‡æ–™åº«ã€‚</p><p>ä¸‹åœ–æ˜¯ Azure Data Studio å‚™ä»½æˆ–é‚„åŸè³‡æ–™åº«çš„ç•«é¢ï¼š</p><p><img src="https://i.imgur.com/wexszt5.png" alt=""></p><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹çš„ <a href="https://docs.microsoft.com/zh-tw/sql/azure-data-studio/tutorial-backup-restore-sql-server?view=sql-server-2017" target="_blank" rel="noopener">å‚™ä»½èˆ‡é‚„åŸçš„è³‡æ–™åº« - Azure Data Studio | Microsoft Docs</a> æ–‡ä»¶ã€‚</p></blockquote><h2 id="åƒè€ƒé€£çµ"><a class="header-anchor" href="#åƒè€ƒé€£çµ"></a>åƒè€ƒé€£çµ</h2><ul><li><a href="https://docs.microsoft.com/zh-tw/sql/linux/quickstart-install-connect-docker?view=sql-server-2017" target="_blank" rel="noopener">é–‹å§‹ä½¿ç”¨ Docker ï¼ˆLinux ä¸ŠåŸ·è¡Œ SQL Serverï¼‰ ä¸Šçš„ SQL Server å®¹å™¨ - SQL Server | Microsoft Docs</a></li><li><a href="https://docs.microsoft.com/zh-tw/sql/linux/sql-server-linux-configure-docker?view=sql-server-2017" target="_blank" rel="noopener">åœ¨ Docker ä¸Šçš„ SQL Server çµ„æ…‹é¸é … - SQL Server | Microsoft Docs</a></li><li><a href="https://docs.microsoft.com/zh-tw/sql/linux/tutorial-restore-backup-in-sql-server-container?view=sql-server-2017" target="_blank" rel="noopener">åœ¨ Docker ä¸­çš„ SQL Server è³‡æ–™åº«é‚„åŸ - SQL Server | Microsoft Docs</a></li><li><a href="https://github.com/Microsoft/mssql-docker/tree/master/linux/preview" target="_blank" rel="noopener">Github repo: Microsoft/mssql-docker</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/docker-mssql-server-for-linux.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;åœ¨ SQL Server 2017 æ™‚ï¼Œå¾®è»Ÿæ¨å‡ºäº† Linux ç‰ˆï¼ŒåŒæ™‚ä¹Ÿåœ¨ Docker Hub ä¸Šæä¾›äº† &lt;a href=&quot;https://hub.docker.com/r/microsoft/mssql-server-linux/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;microsoft/mssql-server-linux&lt;/a&gt; çš„ Docker imageã€‚æœ¬ç¯‡æœƒä»‹ç´¹å¦‚ä½•åœ¨ Docker ä¸‹ï¼Œé€éæ­¤ image ä¾†å»ºç«‹ä¸¦ä½¿ç”¨ MSSQL Server for Linuxã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="SQL Server" scheme="https://titangene.github.io/categories/sql-server/"/>
    
      <category term="Linux" scheme="https://titangene.github.io/categories/sql-server/linux/"/>
    
      <category term="Database" scheme="https://titangene.github.io/categories/sql-server/linux/database/"/>
    
      <category term="DevOps" scheme="https://titangene.github.io/categories/sql-server/linux/database/devops/"/>
    
    
      <category term="Docker" scheme="https://titangene.github.io/tags/docker/"/>
    
      <category term="Container" scheme="https://titangene.github.io/tags/container/"/>
    
  </entry>
  
  <entry>
    <title>å°‡ Hexo çš„ Markdown æ¸²æŸ“å¼•æ“æ›æˆ markdown-it</title>
    <link href="https://titangene.github.io/article/hexo-markdown-it.html"/>
    <id>https://titangene.github.io/article/hexo-markdown-it.html</id>
    <published>2019-01-29T14:51:00.000Z</published>
    <updated>2019-09-08T16:34:17.393Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/hexo.jpg" alt=""></p><p>å€‹äººå¾ˆå¸¸ç”¨ HackMD ç´€éŒ„ç­†è¨˜ï¼Œå¸Œæœ› blog ä¹Ÿå¯ä»¥æ”¯æ´ HackMD çš„ Markdown æ ¼å¼ï¼Œå› æ­¤æœ¬ç¯‡çš„ç›®æ¨™å°±æ˜¯è¦å°‡ Hexo åŸæœ¬çš„ Markdown æ¸²æŸ“å¼•æ“ <code>marked</code>ï¼Œæ›æˆ HackMD çš„ Markdown æ¸²æŸ“å¼•æ“ï¼š<code>markdown-it</code>ã€‚</p><a id="more"></a><h2 id="æ›´æ›æ¸²æŸ“å¼•æ“"><a class="header-anchor" href="#æ›´æ›æ¸²æŸ“å¼•æ“"></a>æ›´æ›æ¸²æŸ“å¼•æ“</h2><p>Hexo é è¨­çš„ markdown æ¸²æŸ“å¼•æ“æ˜¯ <a href="https://github.com/markedjs/marked" target="_blank" rel="noopener"><code>marked</code></a>ï¼Œä¸¦ä½¿ç”¨ <a href="https://github.com/hexojs/hexo-renderer-marked" target="_blank" rel="noopener"><code>hexo-renderer-marked</code></a> æ­¤ Hexo å¤–æ›ä¾†å°‡ Markdown è½‰æ›æˆéœæ…‹æª”æ¡ˆ HTMLï¼Œä½†å› å‰é¢æåˆ°çš„éœ€æ±‚ï¼Œæ‰€ä»¥è¦åˆªé™¤åŸæœ¬çš„æ¸²æŸ“å¼•æ“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> npm uninstall hexo-renderer-marked --save<br></code></pre></td></tr></table></figure><p>å®‰è£æˆ‘å€‘è¦æ”¹ç”¨çš„ Markdown æ¸²æŸ“å¼•æ“ï¼š<code>markdown-it</code>ï¼Œè€Œä½¿ç”¨æ­¤æ¸²æŸ“å¼•æ“çš„ Hexo å¤–æ›å°±æ˜¯ <a href="https://github.com/hexojs/hexo-renderer-markdown-it" target="_blank" rel="noopener"><code>hexo-renderer-markdown-it</code></a>ï¼Œæ‰€ä»¥è¦åœ¨ hexo çš„å°ˆæ¡ˆä¸­å®‰è£æ­¤å¤–æ›ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> npm install git+https://github.com/hexojs/hexo-renderer-markdown-it.git --save<br></code></pre></td></tr></table></figure><p>ç‚ºä½•å®‰è£ NPM å¥—ä»¶æ™‚è¦æŒ‡å®š github çš„ repo å‘¢ï¼Ÿå› ç‚º <code>hexo-renderer-markdown-it</code> æ­¤ NPM å¥—ä»¶çš„ç¨‹å¼æ²’æœ‰æ›´æ–°æˆ Github ä¸Šé¢çš„ç¨‹å¼ç‰ˆæœ¬ï¼Œè«‹ç¢ºå®šå‰›å‰›å®‰è£å¥—ä»¶ä¸­ï¼Œ<code>node_modules\hexo-renderer-markdown-it\lib\renderer.js</code> é€™å€‹æª”æ¡ˆå…§çš„ä¸‹é¢é€™æ®µç¨‹å¼ç¢¼æ˜¯å¦ç›¸åŒï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span> (opt.plugins) &#123;<br>  parser = opt.plugins.reduce(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parser, pugs</span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (pugs <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Object</span> &amp;&amp; pugs.name) &#123;<br>      <span class="hljs-keyword">return</span> parser.use(<span class="hljs-built_in">require</span>(pugs.name), pugs.options);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">return</span> parser.use(<span class="hljs-built_in">require</span>(pugs));<br>    &#125;<br>  &#125;, parser);<br>&#125;<br></code></pre></td></tr></table></figure><p>è‹¥æ˜¯å¾ NPM ä¸‹è¼‰çš„å¥—ä»¶ç‰ˆæœ¬ (ä¹Ÿå°±æ˜¯ç›´æ¥ä½¿ç”¨ <code>npm install hexo-renderer-markdown-it --save</code> æ­¤æŒ‡ä»¤)ï¼Œæœƒå°‘å¹¾å¥ç¨‹å¼ï¼Œå°‘äº†å¯åœ¨è¼‰å…¥ <code>markdown-it</code> çš„å¤–æ›æ™‚ç‚ºè©²å¤–æ›è¨­å®šæ‰€éœ€çš„ optionsï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span> (opt.plugins) &#123;<br>  parser = opt.plugins.reduce(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">parser, pugs</span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> parser.use(<span class="hljs-built_in">require</span>(pugs));<br>  &#125;, parser);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®‰è£æ¸²æŸ“å¼•æ“å¤–æ›å¥—ä»¶"><a class="header-anchor" href="#å®‰è£æ¸²æŸ“å¼•æ“å¤–æ›å¥—ä»¶"></a>å®‰è£æ¸²æŸ“å¼•æ“å¤–æ›å¥—ä»¶</h2><p>æˆ‘å€‘å¯ä»¥åƒè€ƒ <a href="https://github.com/hackmdio/codimd/blob/master/package.json" target="_blank" rel="noopener">HackMD</a> çš„ç›¸ä¾å¥—ä»¶ï¼Œåªè¦æ˜¯åç‚º <code>markdown-it-xxx</code> çš„å¥—ä»¶å°±æ˜¯æ¸²æŸ“å¼•æ“ <code>markdown-it</code> çš„å¤–æ›ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  "dependencies": &#123;<br>    // ...<br>    "markdown-it": "^8.2.2",<br>    "markdown-it-abbr": "^1.0.4",<br>    "markdown-it-container": "^2.0.0",<br>    "markdown-it-deflist": "^2.0.1",<br>    "markdown-it-emoji": "^1.3.0",<br>    "markdown-it-footnote": "^3.0.1",<br>    "markdown-it-imsize": "^2.0.1",<br>    "markdown-it-ins": "^2.0.0",<br>    "markdown-it-mark": "^2.0.0",<br>    "markdown-it-mathjax": "^2.0.0",<br>    "markdown-it-regexp": "^0.4.0",<br>    "markdown-it-sub": "^1.0.0",<br>    "markdown-it-sup": "^1.0.0"<br>    // ...<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è€Œä¸‹åˆ—æ˜¯æˆ‘é¸æ“‡è¦å®‰è£çš„å¤–æ›ï¼š</p><ul><li><a href="https://github.com/markdown-it/markdown-it-abbr" target="_blank" rel="noopener">markdown-it-abbr</a></li><li><a href="https://github.com/markdown-it/markdown-it-container" target="_blank" rel="noopener">markdown-it-container</a></li><li><a href="https://github.com/markdown-it/markdown-it-deflist" target="_blank" rel="noopener">markdown-it-deflist</a></li><li><a href="https://github.com/markdown-it/markdown-it-emoji" target="_blank" rel="noopener">markdown-it-emoji</a></li><li><a href="https://github.com/markdown-it/markdown-it-footnote" target="_blank" rel="noopener">markdown-it-footnote</a></li><li><a href="https://github.com/tatsy/markdown-it-imsize" target="_blank" rel="noopener">markdown-it-imsize</a></li><li><a href="https://github.com/markdown-it/markdown-it-ins" target="_blank" rel="noopener">markdown-it-ins</a></li><li><a href="https://github.com/markdown-it/markdown-it-mark" target="_blank" rel="noopener">markdown-it-mark</a></li><li><a href="https://github.com/rlidwka/markdown-it-regexp" target="_blank" rel="noopener">markdown-it-regexp</a></li><li><a href="https://github.com/markdown-it/markdown-it-sub" target="_blank" rel="noopener">markdown-it-sub</a></li><li><a href="https://github.com/markdown-it/markdown-it-sup" target="_blank" rel="noopener">markdown-it-sup</a></li><li><a href="https://github.com/linsir/markdown-it-task-checkbox" target="_blank" rel="noopener">markdown-it-task-checkbox</a></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> npm i markdown-it-abbr markdown-it-checkbox markdown-it-container markdown-it-deflist markdown-it-emoji markdown-it-footnote markdown-it-imsize markdown-it-ins markdown-it-mark markdown-it-regexp markdown-it-sub markdown-it-sup --save<br></code></pre></td></tr></table></figure><h3 id="markdown-it-mathjax"><a class="header-anchor" href="#markdown-it-mathjax"></a>markdown-it-mathjax</h3><p>ç‚ºä½•æˆ‘æœªå®‰è£ <code>markdown-it-mathjax</code> é€™å€‹å¤–æ›ï¼Ÿé€™æ˜¯å› ç‚ºâ€¦æˆ‘ä¹‹å¾Œå†å–®ç¨å¯«ä¸€ç¯‡æ–‡ç« ä¾†ä»‹ç´¹å¦‚ä½•åœ¨ Markdown åŠ ä¸Šæ•¸å­¸å¼ MathJaxã€‚</p><h3 id="markdown-it-task-checkbox"><a class="header-anchor" href="#markdown-it-task-checkbox"></a>markdown-it-task-checkbox</h3><p>ç‚ºä½•æˆ‘æœƒæ¯” HackMD å¤šå®‰è£ <code>markdown-it-task-checkbox</code> é€™å€‹å¤–æ›ï¼Ÿ</p><p>æœ‰ä½¿ç”¨é HackMD çš„æœ‹å‹éƒ½çŸ¥é“ï¼Œåªè¦åœ¨ HackMD è¼¸å…¥ä¸‹åˆ— Markdown èªæ³•ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">- </span>[ ] task 1<br><span class="hljs-bullet">- </span>[x] task 2<br></code></pre></td></tr></table></figure><p>å°±æœƒè¢«è½‰æ›æˆ HTML çš„ checkboxï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"task-list-item"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"task-list-item-checkbox "</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>task 1<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"task-list-item"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"task-list-item-checkbox"</span> <span class="hljs-attr">checked</span>=<span class="hljs-string">""</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>task 2<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç•«é¢æœƒçœ‹åˆ°ä¸€å€‹æœªè¢«å‹¾é¸ä»¥åŠä¸€å€‹å·²è¢«å‹¾é¸çš„ checkboxï¼š</p><p><img src="../images/hexo-markdown-it/markdown-it_checkbox.png" alt=""></p><p>ä¸é HackMD ä¸æ˜¯é è‘— Markdown æ¸²æŸ“å¼•æ“ <code>markdown-it</code> çš„å¤–æ›ä¾†è½‰æ›æˆ HTML çš„ï¼Œè€Œæ˜¯ç›´æ¥åˆ©ç”¨æ­£è¦è¡¨ç¤ºæ³• (Regular Expression) æ‰¾åˆ° <code>[ ]</code> æˆ– <code>[x]</code> çš„æ–‡å­—ï¼Œå†å°‡é€™äº›æ–‡å­—ç›´æ¥è½‰æ›æˆ HTML çš„ checkboxã€‚æˆ‘æ“·å–äº† HackMD çš„é€™æ®µç¨‹å¼é‚è¼¯ï¼Œè‹¥æƒ³çœ‹è©³ç´°çš„åŸå§‹ç¢¼å¯è‡³ HackMD çš„åŸå§‹ç¢¼å…§çš„ <a href="https://github.com/hackmdio/codimd/blob/master/public/js/extra.js#L263" target="_blank" rel="noopener"><code>public/js/extra.js</code> æª”æ¡ˆä¸­çš„ç¬¬ 263 è¡Œå·¦å³</a>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^\s*\[[x ]\]\s*/</span>.test(html)) &#123;<br>  li.innerHTML = html<br>    .replace(<br>      <span class="hljs-regexp">/^\s*\[ \]\s*/</span>,<br>      <span class="hljs-string">`&lt;input type="checkbox" class="task-list-item-checkbox" <span class="hljs-subst">$&#123;disabled&#125;</span>&gt;&lt;label&gt;&lt;/label&gt;`</span>,<br>    )<br>    .replace(<br>      <span class="hljs-regexp">/^\s*\[x\]\s*/</span>,<br>      <span class="hljs-string">`&lt;input type="checkbox" class="task-list-item-checkbox" checked <span class="hljs-subst">$&#123;disabled&#125;</span>&gt;&lt;label&gt;&lt;/label&gt;`</span>,<br>    );<br>  <span class="hljs-keyword">if</span> (li.tagName.toLowerCase() !== <span class="hljs-string">'li'</span>) &#123;<br>    li.parentElement.setAttribute(<span class="hljs-string">'class'</span>, <span class="hljs-string">'task-list-item'</span>);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    li.setAttribute(<span class="hljs-string">'class'</span>, <span class="hljs-string">'task-list-item'</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="è¨­å®š-config-yml"><a class="header-anchor" href="#è¨­å®š-config-yml"></a>è¨­å®š _config.yml</h2><p>å°‡ä¸‹é¢é€™äº›è¨­å®šåœ¨æ ¹ç›®éŒ„çš„ <code>_config.yml</code> è¨­å®šæª”ä¸­ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># Markdown-it config</span><br><span class="hljs-comment"># Docs: https://github.com/hexojs/hexo-renderer-markdown-it/wiki</span><br><span class="hljs-attr">markdown:</span><br><span class="hljs-attr">  render:</span><br><span class="hljs-attr">    html:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">    xhtmlOut:</span> <span class="hljs-literal">false</span><br><span class="hljs-attr">    breaks:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">    linkify:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">    typographer:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">    quotes:</span> <span class="hljs-string">'â€œâ€â€˜â€™'</span><br><span class="hljs-attr">  plugins:</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-abbr</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-footnote</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-ins</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-sub</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-sup</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-deflist</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-imsize</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-mark</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-regexp</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-task-checkbox</span><br><span class="hljs-attr">    - name:</span> <span class="hljs-string">markdown-it-container</span><br><span class="hljs-attr">      options:</span> <span class="hljs-string">success</span><br><span class="hljs-attr">    - name:</span> <span class="hljs-string">markdown-it-container</span><br><span class="hljs-attr">      options:</span> <span class="hljs-string">info</span><br><span class="hljs-attr">    - name:</span> <span class="hljs-string">markdown-it-container</span><br><span class="hljs-attr">      options:</span> <span class="hljs-string">warning</span><br><span class="hljs-attr">    - name:</span> <span class="hljs-string">markdown-it-container</span><br><span class="hljs-attr">      options:</span> <span class="hljs-string">danger</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">markdown-it-deflist</span><br><span class="hljs-attr">    - name:</span> <span class="hljs-string">markdown-it-emoji</span><br><span class="hljs-attr">      options:</span><br><span class="hljs-attr">        shortcuts:</span> <span class="hljs-string">&#123;&#125;</span><br><span class="hljs-attr">  anchors:</span><br><span class="hljs-attr">    level:</span> <span class="hljs-number">1</span><br><span class="hljs-attr">    collisionSuffix:</span> <span class="hljs-string">'v'</span><br><span class="hljs-attr">    permalink:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">    permalinkClass:</span> <span class="hljs-string">header-anchor</span><br><span class="hljs-attr">    permalinkSymbol:</span> <span class="hljs-string">''</span><br></code></pre></td></tr></table></figure><blockquote><p>æƒ³äº†è§£è¨­å®šè©³æƒ…å¯åƒè€ƒ <a href="https://github.com/hexojs/hexo-renderer-markdown-it/wiki/Advanced-Configuration" target="_blank" rel="noopener">Advanced Configuration | hexojs/hexo-renderer-markdown-it Wiki</a> å®˜æ–¹æ–‡ä»¶ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/hexo.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;å€‹äººå¾ˆå¸¸ç”¨ HackMD ç´€éŒ„ç­†è¨˜ï¼Œå¸Œæœ› blog ä¹Ÿå¯ä»¥æ”¯æ´ HackMD çš„ Markdown æ ¼å¼ï¼Œå› æ­¤æœ¬ç¯‡çš„ç›®æ¨™å°±æ˜¯è¦å°‡ Hexo åŸæœ¬çš„ Markdown æ¸²æŸ“å¼•æ“ &lt;code&gt;marked&lt;/code&gt;ï¼Œæ›æˆ HackMD çš„ Markdown æ¸²æŸ“å¼•æ“ï¼š&lt;code&gt;markdown-it&lt;/code&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Blog" scheme="https://titangene.github.io/categories/blog/"/>
    
    
      <category term="Hexo" scheme="https://titangene.github.io/tags/hexo/"/>
    
      <category term="Markdown" scheme="https://titangene.github.io/tags/markdown/"/>
    
  </entry>
  
  <entry>
    <title>Flutter è¼‰å…¥åœ–ç‰‡</title>
    <link href="https://titangene.github.io/article/flutter-loading-images.html"/>
    <id>https://titangene.github.io/article/flutter-loading-images.html</id>
    <published>2018-12-31T13:10:00.000Z</published>
    <updated>2019-04-30T15:57:23.428Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/flutter.jpg" alt=""></p><p>è¦å¦‚ä½•åœ¨ Flutter å…§è¼‰å…¥åœ–ç‰‡ï¼Ÿé€™ç¯‡åšå€‹å°è¨˜éŒ„ã€‚</p><a id="more"></a><h2 id="æŒ‡å®šè³‡æº"><a class="header-anchor" href="#æŒ‡å®šè³‡æº"></a>æŒ‡å®šè³‡æº</h2><p>Flutter æ˜¯åœ¨æ ¹ç›®éŒ„å…§çš„ <code>pubspec.yaml</code> æª”æ¡ˆä¾†è¨­å®šæ‡‰ç”¨ç¨‹å¼æ‰€éœ€çš„è³‡æºï¼Œè¨­å®šçš„è³‡æºæ²’æœ‰é †åºé—œä¿‚ã€‚</p><p>è‹¥è¦æŒ‡å®šæŸäº›è³‡æºï¼Œè³‡æºçš„è·¯å¾‘æ˜¯ç›¸å°æ–¼ <code>pubspec.yaml</code> æª”æ¡ˆçš„ç›¸å°è·¯å¾‘ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">flutter:</span><br><span class="hljs-attr">  assets:</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">assets/images/avatar.jpg</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">assets/images/background.jpg</span><br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æŒ‡å®šæŸå€‹ç›®éŒ„ï¼Œä»£è¡¨å¯ä»¥å­˜å–åˆ°é€™å€‹ç›®éŒ„ä¸‹çš„æ‰€æœ‰è³‡æºï¼Œä½†è¨˜å¾—è¦åœ¨ç›®éŒ„çš„æœ€å¾ŒåŠ ä¸Š <code>/</code> é€™å€‹ç¬¦è™Ÿï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">flutter:</span><br><span class="hljs-attr">  assets:</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">assets/</span><br></code></pre></td></tr></table></figure><p>è‹¥è¦å­˜å–å­ç›®éŒ„å…§çš„è³‡æºï¼Œè«‹è¨˜å¾—è¦å¦å¤–ç‚ºå­ç›®éŒ„è¨­å®šï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">flutter:</span><br><span class="hljs-attr">  assets:</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">assets/</span><br><span class="hljs-bullet">    -</span> <span class="hljs-string">assets/images/</span><br></code></pre></td></tr></table></figure><h2 id="è¼‰å…¥åœ–ç‰‡"><a class="header-anchor" href="#è¼‰å…¥åœ–ç‰‡"></a>è¼‰å…¥åœ–ç‰‡</h2><p>å¯ä½¿ç”¨ <code>Image.asset()</code> ä¾†è¼‰å…¥åœ–ç‰‡ï¼Œè£¡é¢çš„åƒæ•¸å°±æ˜¯åœ–ç‰‡çš„è·¯å¾‘ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dart">Widget build(BuildContext context) &#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-keyword">return</span> Image.asset(<span class="hljs-string">'assets/images/background.jpg'</span>);<br>  <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ–æ˜¯åœ¨ <code>Image()</code> å…§çš„ <code>image</code> åƒæ•¸ä½¿ç”¨ <code>AssetImage()</code>ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dart">Widget build(BuildContext context) &#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-keyword">return</span> Image(<br>    image: AssetImage(<span class="hljs-string">'assets/images/background.jpg'</span>),<br>  );<br>  <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€å¾Œé¡¯ç¤ºçš„çµæœæœƒä¸€æ¨£ï¼š</p><p><img src="../images/flutter-loading-images/flutter_loading-images.png" alt=""></p><h2 id="åƒè€ƒé€£çµ"><a class="header-anchor" href="#åƒè€ƒé€£çµ"></a>åƒè€ƒé€£çµ</h2><ul><li><a href="https://flutter.io/docs/development/ui/assets-and-images" target="_blank" rel="noopener">Adding assets and images - Flutter</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/flutter.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;è¦å¦‚ä½•åœ¨ Flutter å…§è¼‰å…¥åœ–ç‰‡ï¼Ÿé€™ç¯‡åšå€‹å°è¨˜éŒ„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Flutter" scheme="https://titangene.github.io/categories/flutter/"/>
    
      <category term="Mobile App" scheme="https://titangene.github.io/categories/flutter/mobile-app/"/>
    
    
      <category term="Dart" scheme="https://titangene.github.io/tags/dart/"/>
    
  </entry>
  
  <entry>
    <title>Python - æ—¥èªŒ (logging) æ¨¡çµ„</title>
    <link href="https://titangene.github.io/article/python-logging.html"/>
    <id>https://titangene.github.io/article/python-logging.html</id>
    <published>2018-12-13T10:32:46.000Z</published>
    <updated>2019-04-30T15:55:01.854Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/python.png" alt=""></p><p>é–‹ç™¼ Python æ™‚ï¼Œå¾ˆå¸¸ä½¿ç”¨ <code>print()</code> ä¾†è¼¸å‡ºè®Šæ•¸ä»¥æ–¹ä¾¿ debugï¼Œä½†è¦éƒ¨ç½²æ™‚ï¼Œä¸éœ€è¦é€™äº›è¨Šæ¯ï¼Œéœ€è¦è‡ªå·±æ‰‹å‹•å»è¨»è§£æˆ–åˆªé™¤é‚£äº›æ”¾åœ¨å„è™•çš„ <code>print()</code>ã€‚è€Œ Python å…§å»ºæä¾›äº† <code>logging</code> æ¨¡çµ„å¯ä»¥ç”¨ä¾†å–ä»£ <code>print()</code>ï¼Œ<code>logging</code> é™¤äº†å¯ä»¥è¼¸å‡ºè¨Šæ¯ï¼Œä¹Ÿå¯ä»¥å°‡è¨Šæ¯å„²å­˜è‡³æ—¥èªŒæª”ä¿å­˜ã€‚ä¸‹é¢ç´€éŒ„å¦‚ä½•ä½¿ç”¨ <code>logging</code> æ¨¡çµ„ã€‚</p><a id="more"></a><h2 id="è¼‰å…¥-logging-æ¨¡çµ„"><a class="header-anchor" href="#è¼‰å…¥-logging-æ¨¡çµ„"></a>è¼‰å…¥ logging æ¨¡çµ„</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br></code></pre></td></tr></table></figure><h2 id="logging-ç­‰ç´š"><a class="header-anchor" href="#logging-ç­‰ç´š"></a>logging ç­‰ç´š</h2><p><code>logging</code> æ¨¡çµ„é å…ˆå®šç¾©äº† 6 ç¨®ç­‰ç´šä»¥åŠå°æ‡‰çš„ log è¼¸å‡ºå‡½æ•¸ (é™¤äº† <code>logging.NOTSET</code> æ²’æœ‰å°æ‡‰çš„è¼¸å‡ºå‡½æ•¸)ï¼š</p><table><thead><tr><th>ç­‰ç´š</th><th>ç­‰ç´šæ•¸å€¼</th><th>è¼¸å‡ºå‡½æ•¸</th><th>èªªæ˜</th></tr></thead><tbody><tr><td>NOTSET</td><td>0</td><td>ç„¡å°æ‡‰çš„è¼¸å‡ºå‡½æ•¸</td><td>æœªè¨­å®š</td></tr><tr><td>DEBUG</td><td>10</td><td><code>logging.debug()</code></td><td>é™¤éŒ¯</td></tr><tr><td>INFO</td><td>20</td><td><code>logging.info()</code></td><td>è¨Šæ¯</td></tr><tr><td>WARNING</td><td>30</td><td><code>logging.warning()</code></td><td>è­¦å‘Š</td></tr><tr><td>ERROR</td><td>40</td><td><code>logging.error()</code></td><td>éŒ¯èª¤</td></tr><tr><td>CRITICAL</td><td>50</td><td><code>logging.critical()</code></td><td>åš´é‡éŒ¯èª¤</td></tr></tbody></table><p>è‹¥è¦æŸ¥è©¢å„ç­‰ç´šçš„æ•¸å€¼ï¼Œå¯ç›´æ¥å‘¼å«è©²ç­‰ç´šï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br>print(logging.NOTSET)   <span class="hljs-comment"># 0</span><br>print(logging.DEBUG)    <span class="hljs-comment"># 10</span><br>print(logging.INFO)     <span class="hljs-comment"># 20</span><br>print(logging.WARNING)  <span class="hljs-comment"># 30</span><br>print(logging.ERROR)    <span class="hljs-comment"># 40</span><br>print(logging.CRITICAL) <span class="hljs-comment"># 50</span><br></code></pre></td></tr></table></figure><p>è‹¥è¦ç”¨ç­‰ç´šæ•¸å€¼ä¾†æŸ¥è©¢æ˜¯å“ªå€‹ç­‰ç´šçš„è¨Šæ¯ï¼Œå¯ä½¿ç”¨ <code>logging.getLevelName(level)</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br>print(logging.getLevelName(<span class="hljs-number">0</span>))    <span class="hljs-comment"># NOTSET</span><br>print(logging.getLevelName(<span class="hljs-number">10</span>))   <span class="hljs-comment"># DEBUG</span><br>print(logging.getLevelName(<span class="hljs-number">20</span>))   <span class="hljs-comment"># INFO</span><br>print(logging.getLevelName(<span class="hljs-number">30</span>))   <span class="hljs-comment"># WARNING</span><br>print(logging.getLevelName(<span class="hljs-number">40</span>))   <span class="hljs-comment"># ERROR</span><br>print(logging.getLevelName(<span class="hljs-number">50</span>))   <span class="hljs-comment"># CRITICAL</span><br></code></pre></td></tr></table></figure><h2 id="è¼¸å‡º-logging"><a class="header-anchor" href="#è¼¸å‡º-logging"></a>è¼¸å‡º logging</h2><p><code>logging</code> æ¨¡çµ„é è¨­ç­‰ç´šç‚º <code>WARNING</code>ï¼Œå¤§æ–¼æˆ–ç­‰æ–¼ <code>WARNING</code> ç­‰ç´šçš„è¨Šæ¯æ‰æœƒè¢«è¨˜éŒ„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br>logging.debug(<span class="hljs-string">'debug message'</span>)<br>logging.info(<span class="hljs-string">'info message'</span>)<br>logging.warning(<span class="hljs-string">'warning message'</span>)<br>logging.error(<span class="hljs-string">'error message'</span>)<br>logging.critical(<span class="hljs-string">'critical message'</span>)<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯è¼¸å‡ºçµæœï¼Œå¯ä»¥çœ‹åˆ°æ¯” <code>WARNING</code> ç­‰ç´šé‚„è¦ä½çš„è¨Šæ¯æœ‰ <code>DEBUG</code> å’Œ <code>INFO</code> å°±ä¸æœƒè¢«è¼¸å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">WARNING:root:warning message<br>ERROR:root:error message<br>CRITICAL:root:critical message<br></code></pre></td></tr></table></figure><p>è‹¥å°‡ç­‰ç´šè¨­ç‚º <code>DEBUG</code>ï¼Œå°±æœƒå°‡æ‰€æœ‰ç­‰ç´šçš„è¨Šæ¯éƒ½è¼¸å‡ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br>logging.basicConfig(level=logging.DEBUG)<br><br>logging.debug(<span class="hljs-string">'debug message'</span>)<br>logging.info(<span class="hljs-string">'info message'</span>)<br>logging.warning(<span class="hljs-string">'warning message'</span>)<br>logging.error(<span class="hljs-string">'error message'</span>)<br>logging.critical(<span class="hljs-string">'critical message'</span>)<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯è¼¸å‡ºçµæœï¼Œé è¨­çš„è¨Šæ¯è¼¸å‡ºæ ¼å¼æ˜¯ <code>%(levelname)s:%(name)s:%(message)s</code> (å¾Œé¢æœƒä»‹ç´¹å¦‚ä½•è‡ªè¨‚è¼¸å‡ºæ ¼å¼)ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">DEBUG:root:debug message<br>INFO:root:info message<br>WARNING:root:warning message<br>ERROR:root:error message<br>CRITICAL:root:critical message<br></code></pre></td></tr></table></figure><h2 id="ç´€éŒ„å †ç–Šè¿½è¹¤è³‡è¨Š"><a class="header-anchor" href="#ç´€éŒ„å †ç–Šè¿½è¹¤è³‡è¨Š"></a>ç´€éŒ„å †ç–Šè¿½è¹¤è³‡è¨Š</h2><p><code>logging</code> æ¨¡çµ„ä¹Ÿæä¾›å¯ä»¥ç´€éŒ„å®Œæ•´çš„å †ç–Šè¿½è¹¤ (stack traces)ï¼Œè‹¥åœ¨ <code>logging.error()</code> åŠ ä¸Š <code>exc_info</code> åƒæ•¸ï¼Œä¸¦å°‡è©²åƒæ•¸è¨­ç‚º <code>True</code>ï¼Œå°±å¯ä»¥ç´€éŒ„ Exceptionï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br><span class="hljs-keyword">try</span>:<br>    x = <span class="hljs-number">5</span> / <span class="hljs-number">0</span><br><span class="hljs-keyword">except</span>:<br>    logging.error(<span class="hljs-string">"Catch an exception."</span>, exc_info=<span class="hljs-keyword">True</span>)<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯è¼¸å‡ºçµæœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">ERROR:root:Catch an exception.<br>Traceback (most recent call last):<br>  File "main.py", line 14, in &lt;module&gt;<br>    x = 5 / 0<br>ZeroDivisionError: division by zero<br></code></pre></td></tr></table></figure><p>è‹¥æ²’æœ‰åŠ ä¸Š <code>exc_info=True</code> å‰‡ç„¡æ³•ç´€éŒ„ Exceptionï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br><span class="hljs-keyword">try</span>:<br>    x = <span class="hljs-number">5</span> / <span class="hljs-number">0</span><br><span class="hljs-keyword">except</span>:<br>    logging.error(<span class="hljs-string">"Catch an exception."</span>)<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯è¼¸å‡ºçµæœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ERROR:root:Catch an exception.<br></code></pre></td></tr></table></figure><p>è‹¥è¦åœ¨ logging å…§ç´€éŒ„ exception è¨Šæ¯ï¼Œå¯ä½¿ç”¨ <code>logging.exception()</code>ï¼Œå®ƒæœƒå°‡ exception æ·»åŠ è‡³è¨Šæ¯ä¸­ï¼Œæ­¤æ–¹æ³•çš„ç­‰ç´šç‚º <code>ERROR</code>ï¼Œä¹Ÿå°±æ˜¯èªª <code>logging.exception()</code> å°±ç­‰åŒæ–¼ <code>logging.error(exc_info=True)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br><span class="hljs-keyword">try</span>:<br>    x = <span class="hljs-number">5</span> / <span class="hljs-number">0</span><br><span class="hljs-keyword">except</span>:<br>    logging.exception(<span class="hljs-string">'Catch an exception.'</span>)<br></code></pre></td></tr></table></figure><p>è¼¸å‡ºçµæœå’Œ <code>logging.error(exc_info=True)</code> ç›¸åŒï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">ERROR:root:Catch an exception.<br>Traceback (most recent call last):<br>  File "main.py", line 14, in &lt;module&gt;<br>    x = 5 / 0<br>ZeroDivisionError: division by zero<br></code></pre></td></tr></table></figure><p>è‹¥ä¸æƒ³ä½¿ç”¨ <code>ERROR</code> ç´šåˆ¥ç´€éŒ„ exception è¨Šæ¯ï¼Œå¯ä½¿ç”¨ <code>DEBUG</code>ã€<code>INFO</code>ã€<code>WARNING</code>ã€<code>CRITICAL</code> ç´šåˆ¥ä¸¦åŠ ä¸Šåƒæ•¸ <code>exc_info=True</code> çš„è¨­å®šï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br>logging.basicConfig(level=logging.DEBUG)<br><br><span class="hljs-keyword">try</span>:<br>    x = <span class="hljs-number">5</span> / <span class="hljs-number">0</span><br><span class="hljs-keyword">except</span>:<br>    logging.debug(<span class="hljs-string">'Catch an exception.'</span>, exc_info=<span class="hljs-keyword">True</span>)<br>    logging.info(<span class="hljs-string">'Catch an exception.'</span>, exc_info=<span class="hljs-keyword">True</span>)<br>    logging.warning(<span class="hljs-string">'Catch an exception.'</span>, exc_info=<span class="hljs-keyword">True</span>)<br>    logging.critical(<span class="hljs-string">'Catch an exception.'</span>, exc_info=<span class="hljs-keyword">True</span>)<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯è¼¸å‡ºçµæœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell">DEBUG:root:Catch an exception.<br>Traceback (most recent call last):<br>  File "main.py", line 14, in &lt;module&gt;<br>    x = 5 / 0<br>ZeroDivisionError: division by zero<br>INFO:root:Catch an exception.<br>Traceback (most recent call last):<br>  File "main.py", line 14, in &lt;module&gt;<br>    x = 5 / 0<br>ZeroDivisionError: division by zero<br>WARNING:root:Catch an exception.<br>Traceback (most recent call last):<br>  File "main.py", line 14, in &lt;module&gt;<br>    x = 5 / 0<br>ZeroDivisionError: division by zero<br>CRITICAL:root:Catch an exception.<br>Traceback (most recent call last):<br>  File "main.py", line 14, in &lt;module&gt;<br>    x = 5 / 0<br>ZeroDivisionError: division by zero<br></code></pre></td></tr></table></figure><h2 id="è‡ªè¨‚-logging-è¼¸å‡ºæ ¼å¼"><a class="header-anchor" href="#è‡ªè¨‚-logging-è¼¸å‡ºæ ¼å¼"></a>è‡ªè¨‚ logging è¼¸å‡ºæ ¼å¼</h2><p>é è¨­çš„è¨Šæ¯è¼¸å‡ºæ ¼å¼åªæœ‰ <code>levelname</code>ã€<code>name</code>ã€<code>message</code>ï¼Œä¸‹é¢æ˜¯å…¶ä»–ç›¸é—œçš„è³‡è¨Šï¼š</p><table><thead><tr><th>æ ¼å¼åŒ–å­—ä¸²</th><th>èªªæ˜</th></tr></thead><tbody><tr><td><code>%(asctime)s</code></td><td>æ—¥æœŸæ™‚é–“, æ ¼å¼ç‚º <code>YYYY-MM-DD HH:mm:SS,ms</code>ï¼Œä¾‹å¦‚ï¼š2018-12-13 17:20:30,567</td></tr><tr><td><code>%(filename)s</code></td><td>æ¨¡çµ„æª”å</td></tr><tr><td><code>%(funcName)s</code></td><td>å‡½æ•¸åç¨±</td></tr><tr><td><code>%(levelname)s</code></td><td>æ—¥èªŒçš„ç­‰ç´šåç¨±</td></tr><tr><td><code>%(levelno)s</code></td><td>æ—¥èªŒçš„ç­‰ç´šæ•¸å€¼</td></tr><tr><td><code>%(lineno)d</code></td><td>å‘¼å«æ—¥èªŒå‡½æ•¸æ‰€åœ¨çš„è¡Œæ•¸</td></tr><tr><td><code>%(message)s</code></td><td>è¨Šæ¯</td></tr><tr><td><code>%(module)s</code></td><td>æ¨¡çµ„åç¨±</td></tr><tr><td><code>%(name)s</code></td><td>logger çš„åç¨±</td></tr><tr><td><code>%(pathname)s</code></td><td>æª”æ¡ˆçš„å®Œæ•´è·¯å¾‘ (å¦‚æœå¯ç”¨)</td></tr><tr><td><code>%(process)d</code></td><td>process ID (å¦‚æœå¯ç”¨)</td></tr><tr><td><code>%(thread)d</code></td><td>åŸ·è¡Œç·’ ID (å¦‚æœå¯ç”¨)</td></tr><tr><td><code>%(threradName)s</code></td><td>åŸ·è¡Œç·’åç¨±</td></tr></tbody></table><p>å¯å°‡é€™äº›è³‡è¨ŠåŠ å…¥ <code>logging.basicConfig()</code> å…§çš„ <code>format</code> åƒæ•¸ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br>FORMAT = <span class="hljs-string">'%(asctime)s %(levelname)s: %(message)s'</span><br>logging.basicConfig(level=logging.DEBUG, format=FORMAT)<br><br>logging.debug(<span class="hljs-string">'debug message'</span>)<br>logging.info(<span class="hljs-string">'info message'</span>)<br>logging.warning(<span class="hljs-string">'warning message'</span>)<br>logging.error(<span class="hljs-string">'error message'</span>)<br>logging.critical(<span class="hljs-string">'critical message'</span>)<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯è‡ªè¨‚è¨Šæ¯çš„è¼¸å‡ºçµæœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">2018-12-13 17:40:34,604 DEBUG: debug message<br>2018-12-13 17:40:34,604 INFO: info message<br>2018-12-13 17:40:34,604 WARNING: warning message<br>2018-12-13 17:40:34,604 ERROR: error message<br>2018-12-13 17:40:34,608 CRITICAL: critical message<br></code></pre></td></tr></table></figure><h3 id="è‡ªè¨‚è¼¸å‡ºçš„æ™‚é–“æ ¼å¼"><a class="header-anchor" href="#è‡ªè¨‚è¼¸å‡ºçš„æ™‚é–“æ ¼å¼"></a>è‡ªè¨‚è¼¸å‡ºçš„æ™‚é–“æ ¼å¼</h3><p>åœ¨ <code>logging.basicConfig()</code> å…§çš„ <code>datefmt</code> åƒæ•¸å¯è¨­å®šæ‰€éœ€çš„æ™‚é–“æ ¼å¼ï¼Œè¦ä½¿ç”¨ <code>time.strftime()</code> æ¥å—çš„æ™‚é–“æ ¼å¼ï¼š</p><table><thead><tr><th>åƒæ•¸</th><th>èªªæ˜</th></tr></thead><tbody><tr><td>%Y</td><td>é•·å¹´ä»½ï¼Œä¾‹å¦‚ï¼š2019</td></tr><tr><td>%y</td><td>çŸ­å¹´ä»½ï¼Œä¾‹å¦‚ï¼š19</td></tr><tr><td>%m</td><td>æœˆä»½ï¼š01 ~ 12</td></tr><tr><td>%B</td><td>æœˆä»½å®Œæ•´åç¨±ï¼Œä¾‹å¦‚ï¼šFebruary</td></tr><tr><td>%b</td><td>æœˆä»½ç¸®å¯«åç¨±ï¼Œä¾‹å¦‚ï¼šFeb</td></tr><tr><td>%d</td><td>æ—¥æœŸï¼š01 ~ 31</td></tr><tr><td>%H</td><td>å°æ™‚ (24 å°æ™‚åˆ¶)ï¼š00 ~ 23</td></tr><tr><td>%I</td><td>å°æ™‚ (12 å°æ™‚åˆ¶)ï¼š01 ~ 12</td></tr><tr><td>%w</td><td>æ˜ŸæœŸï¼š0 ~ 6ï¼Œ0 ä»£è¡¨æ˜ŸæœŸæ—¥</td></tr><tr><td>%A</td><td>æ˜ŸæœŸå®Œæ•´åç¨±ï¼Œä¾‹å¦‚ï¼šFriday</td></tr><tr><td>%a</td><td>æ˜ŸæœŸç¸®å¯«åç¨±ï¼Œä¾‹å¦‚ï¼šFri</td></tr><tr><td>%P</td><td>AM æˆ– PM</td></tr><tr><td>%M</td><td>åˆ†é˜ï¼š00 ~ 59</td></tr><tr><td>%S</td><td>ç§’ï¼š00 ~ 61</td></tr></tbody></table><blockquote><p><code>time.strftime()</code> çš„æ™‚é–“åƒæ•¸è©³æƒ…å¯åƒè€ƒ Python å®˜æ–¹çš„ <a href="https://docs.python.org/3/library/time.html#time.strftime" target="_blank" rel="noopener">time â€” Time access and conversions â€” Python 3.7.2 documentation</a> æ–‡ä»¶ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br>LOGGING_FORMAT = <span class="hljs-string">'%(asctime)s %(levelname)s: %(message)s'</span><br>DATE_FORMAT = <span class="hljs-string">'%Y%m%d %H:%M:%S'</span><br>logging.basicConfig(level=logging.DEBUG, format=LOGGING_FORMAT, datefmt=DATE_FORMAT)<br><br>logging.debug(<span class="hljs-string">'debug message'</span>)<br>logging.info(<span class="hljs-string">'info message'</span>)<br>logging.warning(<span class="hljs-string">'warning message'</span>)<br>logging.error(<span class="hljs-string">'error message'</span>)<br>logging.critical(<span class="hljs-string">'critical message'</span>)<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯è‡ªè¨‚è¨Šæ¯çš„è¼¸å‡ºçµæœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs log">20190107 08:57:07 DEBUG: debug message<br>20190107 08:57:07 INFO: info message<br>20190107 08:57:07 WARNING: warning message<br>20190107 08:57:07 ERROR: error message<br>20190107 08:57:07 CRITICAL: critical message<br></code></pre></td></tr></table></figure><h2 id="å„²å­˜-logging"><a class="header-anchor" href="#å„²å­˜-logging"></a>å„²å­˜ logging</h2><p>åªè¦åœ¨ <code>logging.basicConfig()</code> å…§çš„ <code>filename</code> åƒæ•¸è¨­å®šè¦å„²å­˜çš„æ—¥èªŒæª”åï¼Œå°±å¯ä»¥å°‡ logging å„²å­˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> logging<br><br>FORMAT = <span class="hljs-string">'%(asctime)s %(levelname)s: %(message)s'</span><br>logging.basicConfig(level=logging.DEBUG, filename=<span class="hljs-string">'myLog.log'</span>, filemode=<span class="hljs-string">'w'</span>, format=FORMAT)<br><br>logging.debug(<span class="hljs-string">'debug message'</span>)<br>logging.info(<span class="hljs-string">'info message'</span>)<br>logging.warning(<span class="hljs-string">'warning message'</span>)<br>logging.error(<span class="hljs-string">'error message'</span>)<br>logging.critical(<span class="hljs-string">'critical message'</span>)<br></code></pre></td></tr></table></figure><p>é è¨­ <code>filemode</code> åƒæ•¸æ˜¯è¨­ç‚º <code>a</code>ï¼Œä»£è¡¨ append (é™„åŠ ) çš„æ„æ€ï¼Œæ¯æ¬¡åŸ·è¡Œç¨‹å¼æ™‚ï¼ŒLogging æœƒå°‡æ–°çš„è¨Šæ¯åŠ åœ¨èˆŠçš„è¨Šæ¯å¾Œé¢ï¼Œä¸æœƒè¦†è“‹èˆŠçš„è¨Šæ¯ã€‚è‹¥è¦æ”¹æˆæ–°è¨Šæ¯è¦†è“‹å°±è¨Šæ¯ï¼Œé‚£å¯ä»¥å°‡ <code>filemode</code> åƒæ•¸è¨­ç‚º <code>w</code>ï¼Œä»£è¡¨ write çš„æ„æ€ã€‚</p><p>ä¸‹é¢æ˜¯å‰›å‰›åŸ·è¡Œå¾Œå„²å­˜çš„ <code>myLog.log</code> æ—¥èªŒæª”ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs log">2018-12-13 17:47:18,686 DEBUG: debug message<br>2018-12-13 17:47:18,687 INFO: info message<br>2018-12-13 17:47:18,687 WARNING: warning message<br>2018-12-13 17:47:18,687 ERROR: error message<br>2018-12-13 17:47:18,687 CRITICAL: critical message<br></code></pre></td></tr></table></figure><blockquote><p>è©³æƒ…å¯åƒè€ƒå®˜æ–¹æ–‡ä»¶ <a href="https://docs.python.org/3/library/logging.html" target="_blank" rel="noopener">Logging facility for Python â€” Python documentation</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/python.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;é–‹ç™¼ Python æ™‚ï¼Œå¾ˆå¸¸ä½¿ç”¨ &lt;code&gt;print()&lt;/code&gt; ä¾†è¼¸å‡ºè®Šæ•¸ä»¥æ–¹ä¾¿ debugï¼Œä½†è¦éƒ¨ç½²æ™‚ï¼Œä¸éœ€è¦é€™äº›è¨Šæ¯ï¼Œéœ€è¦è‡ªå·±æ‰‹å‹•å»è¨»è§£æˆ–åˆªé™¤é‚£äº›æ”¾åœ¨å„è™•çš„ &lt;code&gt;print()&lt;/code&gt;ã€‚è€Œ Python å…§å»ºæä¾›äº† &lt;code&gt;logging&lt;/code&gt; æ¨¡çµ„å¯ä»¥ç”¨ä¾†å–ä»£ &lt;code&gt;print()&lt;/code&gt;ï¼Œ&lt;code&gt;logging&lt;/code&gt; é™¤äº†å¯ä»¥è¼¸å‡ºè¨Šæ¯ï¼Œä¹Ÿå¯ä»¥å°‡è¨Šæ¯å„²å­˜è‡³æ—¥èªŒæª”ä¿å­˜ã€‚ä¸‹é¢ç´€éŒ„å¦‚ä½•ä½¿ç”¨ &lt;code&gt;logging&lt;/code&gt; æ¨¡çµ„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="https://titangene.github.io/categories/python/"/>
    
    
      <category term="Logging" scheme="https://titangene.github.io/tags/logging/"/>
    
  </entry>
  
  <entry>
    <title>è¨­å®š Windows å·¥ä½œæ’ç¨‹å®šæœŸåŸ·è¡Œ Python çˆ¬èŸ²ç¨‹å¼</title>
    <link href="https://titangene.github.io/article/set-up-windows-task-scheduler-to-periodically-execute-python-crawler.html"/>
    <id>https://titangene.github.io/article/set-up-windows-task-scheduler-to-periodically-execute-python-crawler.html</id>
    <published>2018-12-01T04:55:00.000Z</published>
    <updated>2019-04-30T15:54:19.642Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/python_crawler.png" alt=""></p><p>å¦‚ä½•å°‡ Python çˆ¬èŸ²ç¨‹å¼å®šæœŸåŸ·è¡Œï¼Ÿä½¿ç”¨ Windows çš„ä½¿ç”¨è€…å¯ä»¥é¸æ“‡ã€Œå·¥ä½œæ’ç¨‹å™¨ã€ä¾†è§£æ±ºã€‚</p><a id="more"></a><p>æœ€è¿‘æœ‰äº›è³‡æ–™æƒ³é€éçˆ¬èŸ²ä¾†æ“·å–ï¼Œè€Œä¸”å¸Œæœ›å¯ä»¥å®šæœŸ (ä¾‹å¦‚ï¼šæ¯ 10 åˆ†é˜ä¸€æ¬¡) è‡ªå‹•åŸ·è¡Œçˆ¬èŸ²ç¨‹å¼ï¼Œå› æ­¤å°±æœ‰äº†é€™ç¯‡ç­†è¨˜ã€‚ä¸‹é¢ä»‹ç´¹å¦‚ä½•ä»¥ Windows å·¥ä½œæ’ç¨‹å™¨ä¾†å®šæœŸåŸ·è¡Œçˆ¬èŸ²ç¨‹å¼ã€‚</p><h2 id="ç›®æ¨™"><a class="header-anchor" href="#ç›®æ¨™"></a>ç›®æ¨™</h2><p>æ¯ 10 åˆ†é˜è‡ªå‹•åŸ·è¡Œ Python çˆ¬èŸ²ç¨‹å¼ï¼Œå°‡çˆ¬èŸ²æŠ“åˆ°çš„æœ€æ–°é™é›¨é‡è³‡æ–™å­˜å…¥ CSV æª”å…§æ”¶é›†ã€‚</p><h2 id="æº–å‚™"><a class="header-anchor" href="#æº–å‚™"></a>æº–å‚™</h2><ul><li>Windows</li><li>Python ç’°å¢ƒï¼šå»ºè­°å®‰è£ Anacondaï¼Œå¯åƒè€ƒ <a href="./create-a-virtual-environment-and-manage-dependencies-with-conda.html">ç”¨ Conda å»ºç«‹è™›æ“¬ç’°å¢ƒå’Œç®¡ç†ç›¸ä¾å¥—ä»¶</a></li><li>Python å¥—ä»¶ (é€™æ˜¯æœ¬ç¯‡çˆ¬èŸ²ç¯„ä¾‹æ‰€éœ€çš„ç›¸ä¾å¥—ä»¶ï¼Œå¯ä¾å„è‡ªéœ€æ±‚ä¾†é¸æ“‡)<ul><li><a href="https://pandas.pydata.org/" target="_blank" rel="noopener">Pandas</a></li><li><a href="http://www.numpy.org/" target="_blank" rel="noopener">Numpy</a></li><li><a href="http://docs.python-requests.org/en/master/" target="_blank" rel="noopener">Requests</a></li></ul></li></ul><h2 id="python-çˆ¬èŸ²ç¨‹å¼åŸå§‹ç¢¼"><a class="header-anchor" href="#python-çˆ¬èŸ²ç¨‹å¼åŸå§‹ç¢¼"></a>Python çˆ¬èŸ²ç¨‹å¼åŸå§‹ç¢¼</h2><p>source code: <a href="https://github.com/titangene/cwb-opendata-crawler-demo/blob/master/crawler.py" target="_blank" rel="noopener">titangene/cwb-opendata-crawler-demo/crawler.py</a></p><p>ç°¡å–®èªªæ˜ä¸€ä¸‹ç¨‹å¼çš„åŸ·è¡Œæ­¥é©Ÿï¼š</p><ol><li>åˆ©ç”¨ Python çš„ <a href="http://docs.python-requests.org/en/master/" target="_blank" rel="noopener">Requests</a> å¥—ä»¶ä¾†å»ºç«‹ HTTP çš„ GET è«‹æ±‚ï¼Œå¾ä¸­å¤®æ°£è±¡å±€æä¾›çš„é–‹æ”¾è³‡æ–™ API ä¸­å–å¾—è³‡æ–™ï¼Œå›å‚³çš„æ ¼å¼æ˜¯ JSON</li><li>è§£æ API å›å‚³çš„ JSON è³‡æ–™ï¼Œä¸¦å°‡ JSON è½‰æˆ <a href="https://pandas.pydata.org/" target="_blank" rel="noopener">Pandas</a> çš„ <code>DataFrame</code> å‹åˆ¥çš„è³‡æ–™æ ¼å¼</li><li>å°‡ <code>DataFrame</code> å„²å­˜æˆ CSV æª”ä¿å­˜è³‡æ–™</li></ol><blockquote><p>è‹¥æƒ³äº†è§£ä¸­å¤®æ°£è±¡å±€é–‹æ”¾è³‡æ–™çš„ç›¸é—œå…§å®¹ï¼Œè©³æƒ…å¯åƒè€ƒ <a href="https://opendata.cwb.gov.tw/devManual/insrtuction" target="_blank" rel="noopener">ä¸­å¤®æ°£è±¡å±€é–‹æ”¾è³‡æ–™ - é–‹ç™¼æŒ‡å—</a>ã€‚</p></blockquote><h2 id="python-çˆ¬èŸ²ç¨‹å¼çš„æ‰¹æ¬¡æª”"><a class="header-anchor" href="#python-çˆ¬èŸ²ç¨‹å¼çš„æ‰¹æ¬¡æª”"></a>Python çˆ¬èŸ²ç¨‹å¼çš„æ‰¹æ¬¡æª”</h2><p>å»ºç«‹ä¸€å€‹å‰¯æª”åç‚º <code>.bat</code> çš„æ‰¹æ¬¡æª”ï¼Œæ‰¹æ¬¡æª”æ˜¯ç”¨ä¾†åŸ·è¡Œ Python çˆ¬èŸ²ç¨‹å¼ï¼Œå› æ­¤å°±èƒ½è®“ Windows å·¥ä½œæ’ç¨‹å™¨åœ¨å®šæœŸæ™‚é–“è‡ªå‹•åŸ·è¡Œæ‰¹æ¬¡æª”ï¼Œä»¥é”æˆè‡ªå‹•åŒ–åŸ·è¡Œçˆ¬èŸ²çš„ç›®çš„ã€‚</p><p>ä¸‹é¢å°±ä¾†èªªæ˜æ‰¹æ¬¡æª”æ¯è¡Œéƒ½åšäº†ç”šéº¼ï¼š</p><ul><li>ç¬¬ä¸€è¡Œï¼šåˆ‡åˆ°æŒ‡å®šç›®éŒ„</li><li>ç¬¬äºŒè¡Œï¼šæŒ‡å®š Python è™›æ“¬ç’°å¢ƒ (å¯åƒè€ƒ <a href="./create-a-virtual-environment-and-manage-dependencies-with-conda.html">ç”¨ Conda å»ºç«‹è™›æ“¬ç’°å¢ƒå’Œç®¡ç†ç›¸ä¾å¥—ä»¶</a>ã€‚å¦‚æœè¦åœ¨å…¨åŸŸç’°å¢ƒä¸‹åŸ·è¡Œå°±ä¸éœ€è¦é€™è¡Œ)</li><li>ç¬¬ä¸‰è¡Œï¼šåŸ·è¡Œ Python çˆ¬èŸ²ç¨‹å¼</li><li>ç¬¬å››è¡Œï¼šè‹¥æƒ³æŸ¥çœ‹ Python çˆ¬èŸ²ç¨‹å¼åŸ·è¡Œéç¨‹ä¸­æ‰€è¼¸å‡º (ä¹Ÿå°±æ˜¯åŸ·è¡Œ <code>print</code> æ–¹æ³•çš„éƒ¨åˆ†) å…§å®¹ï¼Œå°±éœ€è¦å–æ¶ˆé€™è¡Œçš„è¨»è§£<ul><li><code>REM</code>ï¼šå–®è¡Œè¨»è§£</li><li><code>pause</code>ï¼šç”¨ä¾†æš«åœæ‰¹æ¬¡æª”çš„åŸ·è¡Œ</li></ul></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /d D:/Project/Python/cwb-opendata-crawler<br>call activate dev<br>call python crawler.py<br>REM pause<br></code></pre></td></tr></table></figure><p>source code: <a href="https://github.com/titangene/cwb-opendata-crawler-demo/blob/master/crawler.bat" target="_blank" rel="noopener">titangene/cwb-opendata-crawler-demo/crawler.bat</a></p><h2 id="windows-å·¥ä½œæ’ç¨‹å™¨-ç°¡ä»‹"><a class="header-anchor" href="#windows-å·¥ä½œæ’ç¨‹å™¨-ç°¡ä»‹"></a>Windows å·¥ä½œæ’ç¨‹å™¨ ç°¡ä»‹</h2><p>å¯é å…ˆè¨­å®šå·¥ä½œåœ¨ç‰¹å®šæ™‚é–“æˆ–æŒ‡å®šæ™‚é–“æ™‚ï¼Œæœƒè‡ªå‹•åŸ·è¡Œç¨‹å¼æˆ–æ‰¹æ¬¡æª”ä»¥é”æˆå·¥ä½œè‡ªå‹•åŒ–ã€‚ä¸‹åœ–ç‚º Windows 10 çš„å·¥ä½œæ’ç¨‹å™¨ä»‹é¢ï¼š</p><p><img src="../images/set-up-windows-task-scheduler-to-periodically-execute-python-crawler/2018-11-30_13-46-33.png" alt=""></p><h2 id="å»ºç«‹å·¥ä½œ-è¨­å®šå®šæœŸåŸ·è¡Œçˆ¬èŸ²ç¨‹å¼"><a class="header-anchor" href="#å»ºç«‹å·¥ä½œ-è¨­å®šå®šæœŸåŸ·è¡Œçˆ¬èŸ²ç¨‹å¼"></a>å»ºç«‹å·¥ä½œï¼Œè¨­å®šå®šæœŸåŸ·è¡Œçˆ¬èŸ²ç¨‹å¼</h2><p>é–‹å•Ÿ Windows çš„ã€Œå·¥ä½œæ’ç¨‹å™¨ã€ï¼Œé»æ“Šå³ä¸Šè§’çš„ã€Œå»ºç«‹å·¥ä½œã€</p><p><img src="../images/set-up-windows-task-scheduler-to-periodically-execute-python-crawler/2018-11-30_13-47-29.png" alt=""></p><p>è‡ªè¨‚å·¥ä½œåç¨±ï¼Œè‹¥æœ‰æ¬Šé™éœ€æ±‚å¯å‹¾é¸ã€Œä»¥æœ€é«˜æ¬Šé™åŸ·è¡Œã€é¸é …</p><p><img src="../images/set-up-windows-task-scheduler-to-periodically-execute-python-crawler/2018-11-30_13-48-27.png" alt=""></p><p>æ¥è‘—æ–°å¢ã€Œè§¸ç™¼ç¨‹åºã€</p><p><img src="../images/set-up-windows-task-scheduler-to-periodically-execute-python-crawler/2018-11-30_22-13-47.png" alt=""></p><p>è¨­å®šå·¥ä½œçš„é–‹å§‹æ™‚é–“ï¼Œä¸¦é¸æ“‡ã€Œåƒ…ä¸€æ¬¡ã€ï¼Œä»¥åŠè¨­å®šå·¥ä½œè¦æ¯éš”å¤šä¹…å°±åŸ·è¡Œä¸€æ¬¡ï¼Œä¸¦ä¸”è¦æŒçºŒå¤šä¹…æ™‚é–“</p><p><img src="../images/set-up-windows-task-scheduler-to-periodically-execute-python-crawler/2018-11-30_13-49-02.png" alt=""></p><p>ç„¶å¾Œæ–°å¢ã€Œå‹•ä½œã€</p><p><img src="../images/set-up-windows-task-scheduler-to-periodically-execute-python-crawler/2018-11-30_22-14-07.png" alt=""></p><p>è¨­å®šè¦è‡ªå‹•åŸ·è¡Œçš„ç¨‹å¼ï¼Œé€™é‚Šé¸æ“‡çš„å°±æ˜¯å‰›å‰›æåˆ°çš„ <a href="#Python-%E7%88%AC%E8%9F%B2%E7%A8%8B%E5%BC%8F%E7%9A%84%E6%89%B9%E6%AC%A1%E6%AA%94">æ‰¹æ¬¡æª”</a> (<a href="https://github.com/titangene/cwb-opendata-crawler-demo/blob/master/crawler.bat" target="_blank" rel="noopener">åŸå§‹ç¢¼</a>)</p><p><img src="../images/set-up-windows-task-scheduler-to-periodically-execute-python-crawler/2018-11-30_13-49-54.png" alt=""></p><p>å¦‚æœè¨­å®šå¥½äº†å°±å¯ä»¥æŒ‰ç¢ºå®šå®Œæˆå»ºç«‹å·¥ä½œï¼Œæ­¤æ™‚å°±æœƒçœ‹åˆ°åœ¨ã€Œå·¥ä½œæ’ç¨‹å™¨ç¨‹å¼åº«ã€å…§çš„å·¥ä½œæ¸…å–®ä¸­ï¼Œå¤šäº†å‰›å‰›æ–°å¢çš„å·¥ä½œ</p><p><img src="../images/set-up-windows-task-scheduler-to-periodically-execute-python-crawler/2018-11-30_13-46-05.png" alt=""></p><h2 id="æˆæœ"><a class="header-anchor" href="#æˆæœ"></a>æˆæœ</h2><p>å¯ä»¥çœ‹åˆ°çˆ¬èŸ²ç¨‹å¼æœƒåœ¨å®šæœŸè‡ªå‹•åŸ·è¡Œï¼ŒåŸ·è¡Œçš„æ™‚å€™æœƒè·³å‡ºä¸€å€‹ <code>cmd</code> è¦–çª—ã€‚è‹¥å‰›å‰›æåˆ°çš„ <a href="#Python-%E7%88%AC%E8%9F%B2%E7%A8%8B%E5%BC%8F%E7%9A%84%E6%89%B9%E6%AC%A1%E6%AA%94">æ‰¹æ¬¡æª”</a> å…§æ²’æœ‰å°‡ <code>REM pause</code> é€™è¡Œè¨»è§£ï¼Œå°±æœƒçœ‹åˆ°çˆ¬èŸ²ç¨‹å¼åŸ·è¡Œå®Œæˆå¾Œï¼Œä¸æœƒè‡ªå‹•é—œé–‰ <code>cmd</code> è¦–çª—ï¼Œé€™æ˜¯ç‚ºäº†å¯ä»¥ç«‹å³çœ‹åˆ°è©²æ¬¡çˆ¬èŸ²åŸ·è¡Œéç¨‹ä¸­è¼¸å‡ºçš„è¨Šæ¯ã€‚</p><p><img src="../images/set-up-windows-task-scheduler-to-periodically-execute-python-crawler/2018-12-01_00-19-10.png" alt=""></p><p>ä¸‹åœ–å°±æ˜¯è‡ªå‹•åŸ·è¡Œçˆ¬èŸ²æ‰€æŠ“åˆ°çš„è³‡æ–™ï¼š</p><p><img src="../images/set-up-windows-task-scheduler-to-periodically-execute-python-crawler/2018-12-01_09-14-48.png" alt=""></p><blockquote><p>å®Œæ•´ source codeï¼š<a href="https://github.com/titangene/cwb-opendata-crawler-demo" target="_blank" rel="noopener">titangene/cwb-opendata-crawler-demo</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/python_crawler.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;å¦‚ä½•å°‡ Python çˆ¬èŸ²ç¨‹å¼å®šæœŸåŸ·è¡Œï¼Ÿä½¿ç”¨ Windows çš„ä½¿ç”¨è€…å¯ä»¥é¸æ“‡ã€Œå·¥ä½œæ’ç¨‹å™¨ã€ä¾†è§£æ±ºã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Windows" scheme="https://titangene.github.io/categories/windows/"/>
    
      <category term="Python" scheme="https://titangene.github.io/categories/windows/python/"/>
    
      <category term="Crawler" scheme="https://titangene.github.io/categories/windows/python/crawler/"/>
    
      <category term="OS" scheme="https://titangene.github.io/categories/windows/python/crawler/os/"/>
    
    
      <category term="Python Requests" scheme="https://titangene.github.io/tags/python-requests/"/>
    
      <category term="Windows å·¥ä½œæ’ç¨‹" scheme="https://titangene.github.io/tags/windows-%E5%B7%A5%E4%BD%9C%E6%8E%92%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨ Conda å»ºç«‹è™›æ“¬ç’°å¢ƒå’Œç®¡ç†ç›¸ä¾å¥—ä»¶</title>
    <link href="https://titangene.github.io/article/create-a-virtual-environment-and-manage-dependencies-with-conda.html"/>
    <id>https://titangene.github.io/article/create-a-virtual-environment-and-manage-dependencies-with-conda.html</id>
    <published>2018-11-19T09:10:00.000Z</published>
    <updated>2019-05-12T07:21:26.188Z</updated>
    
    <content type="html"><![CDATA[<p><img src="../images/cover/python_anaconda.png" alt=""></p><p>å­¸ç¿’å¦‚ä½•åˆ©ç”¨ Conda ä¾†å»ºç«‹ä¸åŒéœ€æ±‚æ‰€éœ€çš„ Python é–‹ç™¼ç’°å¢ƒï¼Œä¸¦å¦‚ä½•ç®¡ç†ç›¸ä¾å¥—ä»¶ã€‚</p><a id="more"></a><h2 id="anaconda"><a class="header-anchor" href="#anaconda"></a>Anaconda</h2><p><img src="../images/create-a-virtual-environment-and-manage-dependencies-with-conda/anaconda-logo.png" alt=""></p><p>Anaconda æ˜¯æœ€å—æ­¡è¿çš„ Python è³‡æ–™ç§‘å­¸ (Data Science) å¹³å°ï¼Œå®ƒç‰¹é»å°±æ˜¯æœ¬ä¾†å°±åŒ…å«äº†å„ç¨®æ•¸æ“šåˆ†æã€ç§‘å­¸è¨ˆç®—çš„ç›¸é—œå¥—ä»¶ (ä¾‹å¦‚ï¼šNumPyã€SciPyã€Matplotlibã€SymPyã€Pandas â€¦ ç­‰)ï¼Œè€Œ Anaconda çš„å¥—ä»¶ç®¡ç†å·¥å…·å°±æ˜¯ condaã€‚</p><h2 id="conda"><a class="header-anchor" href="#conda"></a>Conda</h2><p><img src="../images/create-a-virtual-environment-and-manage-dependencies-with-conda/conda-logo.png" alt=""></p><p>Conda æ˜¯ä¸€å€‹é–‹æºçš„å¥—ä»¶èˆ‡ç’°å¢ƒç®¡ç†çš„ç³»çµ±ï¼Œå¯ä»¥åœ¨ Windowsã€macOS å’Œ Linux ä¸Šä½¿ç”¨ã€‚å¯åˆ©ç”¨ Conda ä¾†å®‰è£ã€åŸ·è¡Œã€æ›´æ–°å¥—ä»¶ä»¥åŠå…¶ç›¸ä¾çš„å¥—ä»¶ï¼Œä¸¦ä¸”é‚„å¯ç”¨ä¾†å»ºç«‹ä¸åŒçš„é–‹ç™¼ç’°å¢ƒ (ä¾‹å¦‚ï¼šä¸åŒç’°å¢ƒæœ‰ä¸åŒçš„ Python ç‰ˆæœ¬)ã€‚</p><!-- more --><h2 id="å®‰è£-anaconda"><a class="header-anchor" href="#å®‰è£-anaconda"></a>å®‰è£ Anaconda</h2><p>è‡³ <a href="https://www.anaconda.com/download/" target="_blank" rel="noopener">Anaconda</a> å®˜ç¶²ä¸‹è¼‰ä¸¦å®‰è£ï¼Œå»ºè­°é¸æ“‡ Python 3.x çš„ç‰ˆæœ¬ã€‚</p><h2 id="å»ºç«‹è™›æ“¬ç’°å¢ƒ"><a class="header-anchor" href="#å»ºç«‹è™›æ“¬ç’°å¢ƒ"></a>å»ºç«‹è™›æ“¬ç’°å¢ƒ</h2><p>å¾æŒ‡å®šå¥—ä»¶åˆ—è¡¨ä¸­å»ºç«‹æ–°çš„ conda ç’°å¢ƒï¼š</p><ul><li><code>-n</code>ï¼Œ<code>--name</code>ï¼šè¨­å®šç’°å¢ƒåç¨±</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda create -n &lt;environment&gt; &lt;package&gt;<br><span class="hljs-meta"><br>#</span> å®‰è£åŒ…å« Anaconda ç™¼è¡Œç‰ˆçš„å¥—ä»¶<br><span class="hljs-meta">$</span> conda create -n &lt;environment&gt; anaconda<br><span class="hljs-meta"><br>#</span> æŒ‡å®š Python ç‰ˆæœ¬<br><span class="hljs-meta">$</span> conda create -n &lt;environment&gt; python=3.6<br></code></pre></td></tr></table></figure><ul><li><code>-e</code>ï¼Œ<code>--envs</code>ï¼šåˆ—å‡ºå·²å»ºç«‹çš„ç’°å¢ƒ</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> é¡¯ç¤ºè™›æ“¬ç’°å¢ƒåˆ—è¡¨ï¼Œä¸¦é¡¯ç¤ºæ­£åœ¨ä½¿ç”¨çš„è™›æ“¬ç’°å¢ƒ<br><span class="hljs-meta">$</span> conda info -e<br><span class="hljs-meta">#</span> conda environments:<br><span class="hljs-meta">#</span><br>base                  *  D:\Users\Titan\Anaconda3<br>hello                    D:\Users\Titan\Anaconda3\envs\hello<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨æˆ– <code>activate</code> è‡³æŒ‡å®šç’°å¢ƒï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> Windows<br><span class="hljs-meta">$</span> activate &lt;environment&gt;<br><span class="hljs-meta"><br>#</span> Linux and macOS<br><span class="hljs-meta">$</span> source activate &lt;environment&gt;<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> é¡¯ç¤ºè™›æ“¬ç’°å¢ƒåˆ—è¡¨ï¼Œä¸¦é¡¯ç¤ºæ­£åœ¨ä½¿ç”¨çš„è™›æ“¬ç’°å¢ƒ<br><span class="hljs-meta">$</span> conda info -e<br><span class="hljs-meta">#</span> conda environments:<br><span class="hljs-meta">#</span><br>base                     D:\Users\Titan\Anaconda3<br>hello                 *  D:\Users\Titan\Anaconda3\envs\hello<br></code></pre></td></tr></table></figure><blockquote><p><code>*</code> ä»£è¡¨ç›®å‰æ­£åœ¨ä½¿ç”¨çš„è™›æ“¬ç’°å¢ƒ</p></blockquote><h2 id="é›¢é–‹è™›æ“¬ç’°å¢ƒ"><a class="header-anchor" href="#é›¢é–‹è™›æ“¬ç’°å¢ƒ"></a>é›¢é–‹è™›æ“¬ç’°å¢ƒ</h2><p>å¦‚æœè¦å°‡ç¾åœ¨ç’°å¢ƒæ”¹å›é è¨­å€¼ <code>base</code> (é›¢é–‹ç›®å‰ç’°å¢ƒ) å¯ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> Windows<br><span class="hljs-meta">$</span> deactivate<br><span class="hljs-meta"><br>#</span> Linux and macOS<br><span class="hljs-meta">$</span> source deactivate<br></code></pre></td></tr></table></figure><h2 id="åˆ©ç”¨-conda-å®‰è£å¥—ä»¶"><a class="header-anchor" href="#åˆ©ç”¨-conda-å®‰è£å¥—ä»¶"></a>åˆ©ç”¨ conda å®‰è£å¥—ä»¶</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda install &lt;package&gt;<br><span class="hljs-meta"><br>#</span> å®‰è£å¤šå€‹å¥—ä»¶<br><span class="hljs-meta">$</span> conda install &lt;package-1&gt; &lt;package-2&gt;<br></code></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹è³‡è¨Š"><a class="header-anchor" href="#æŸ¥çœ‹è³‡è¨Š"></a>æŸ¥çœ‹è³‡è¨Š</h2><p>æŸ¥çœ‹ conda ç›®å‰ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda -V<br>conda 4.5.11<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ç›®å‰ç’°å¢ƒå·²å®‰è£çš„å¥—ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda list<br><span class="hljs-meta">#</span> packages in environment at D:\Users\Titan\Anaconda3:<br><span class="hljs-meta">#</span><br><span class="hljs-meta">#</span> Name                    Version                   Build  Channel<br>...<br>jupyter                   1.0.0                    py35_3<br>jupyter_client            5.2.3                    py35_0<br>jupyter_console           4.1.1                    py35_0<br>jupyter_core              4.4.0            py35h629ba7f_0<br>jupyterlab                0.32.1                    &lt;pip&gt;<br>jupyterlab-launcher       0.10.5                    &lt;pip&gt;<br>...<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ conda æ˜¯å¦æœ‰æŸå¥—ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda search &lt;package&gt;<br><span class="hljs-meta"><br>$</span> conda search pandas<br>Loading channels: done<br><span class="hljs-meta">#</span> Name                  Version           Build  Channel<br>pandas                    0.9.0      np16py27_0  pkgs/free<br>pandas                    0.9.1      np16py27_0  pkgs/free<br>...<br></code></pre></td></tr></table></figure><p>å¦‚æœ conda æ²’æœ‰è©²å¥—ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ pip ä¾†å®‰è£å¥—ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> å®‰è£å¥—ä»¶<br><span class="hljs-meta">$</span> pip install &lt;package&gt;<br><span class="hljs-meta"><br>#</span> æ›´æ–°å¥—ä»¶<br><span class="hljs-meta">$</span> pip install --upgrade &lt;package&gt;<br></code></pre></td></tr></table></figure><h2 id="åˆªé™¤å¥—ä»¶"><a class="header-anchor" href="#åˆªé™¤å¥—ä»¶"></a>åˆªé™¤å¥—ä»¶</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> åˆªé™¤ç’°å¢ƒå…§çš„å¥—ä»¶<br><span class="hljs-meta">$</span> conda remove -n &lt;environment&gt; &lt;package&gt;<br><span class="hljs-meta"><br>#</span> åˆªé™¤ç›®å‰ç’°å¢ƒå…§çš„å¥—ä»¶<br><span class="hljs-meta">$</span> conda remove &lt;package&gt;<br><span class="hljs-meta"><br>#</span> åˆªé™¤å¤šå€‹å¥—ä»¶<br><span class="hljs-meta">$</span> conda remove &lt;package-1&gt; &lt;package-2&gt;<br></code></pre></td></tr></table></figure><h2 id="æ›´æ–°å¥—ä»¶"><a class="header-anchor" href="#æ›´æ–°å¥—ä»¶"></a>æ›´æ–°å¥—ä»¶</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span> æ›´æ–° conda<br><span class="hljs-meta">$</span> conda update conda<br><span class="hljs-meta"><br>#</span> æ›´æ–° Anaconda<br><span class="hljs-meta">$</span> conda update anaconda<br><span class="hljs-meta"><br>#</span> æ›´æ–° Python<br><span class="hljs-meta">$</span> conda update python<br><span class="hljs-meta"><br>#</span> æ›´æ–°ç‰¹å®šå¥—ä»¶<br><span class="hljs-meta">$</span> conda update &lt;package&gt;<br></code></pre></td></tr></table></figure><h2 id="åˆªé™¤è™›æ“¬ç’°å¢ƒ"><a class="header-anchor" href="#åˆªé™¤è™›æ“¬ç’°å¢ƒ"></a>åˆªé™¤è™›æ“¬ç’°å¢ƒ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda env remove -n &lt;environment&gt;<br></code></pre></td></tr></table></figure><h2 id="æ›´æ–°-python"><a class="header-anchor" href="#æ›´æ–°-python"></a>æ›´æ–° Python</h2><h3 id="æ›´æ–°å…¨åŸŸç’°å¢ƒ"><a class="header-anchor" href="#æ›´æ–°å…¨åŸŸç’°å¢ƒ"></a>æ›´æ–°å…¨åŸŸç’°å¢ƒ</h3><p>è‹¥ç›®å‰ Python ç‰ˆæœ¬æ˜¯ 3.6.1ï¼Œä¸‹é¢æŒ‡ä»¤åªæœƒå°‡ Python æ›´æ–°è‡³ 3.6.x çš„æœ€æ–°ç‰ˆæœ¬ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda update python<br></code></pre></td></tr></table></figure><p>è‹¥æ˜¯è¦æ›´æ–°åˆ°å…¶ä»–ç‰ˆæœ¬å¯æŒ‡å®š Python ç‰ˆæœ¬ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda install python=3.6<br></code></pre></td></tr></table></figure><h2 id="æ›´æ–°-anaconda"><a class="header-anchor" href="#æ›´æ–°-anaconda"></a>æ›´æ–° Anaconda</h2><p>æ›´æ–°å¥—ä»¶ç®¡ç†å™¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda update conda<br></code></pre></td></tr></table></figure><div class="warning"><p>æ³¨æ„ï¼šConda æœƒæ›´æ–°è©²ç‰ˆæœ¬åˆ—è¡¨ä¸­çš„æœ€é«˜ç‰ˆæœ¬ï¼Œå› æ­¤ Python 2.7 æ›´æ–°åˆ° 2.x ä¸­çš„æœ€é«˜ç‰ˆæœ¬ï¼Œè€Œ 3.x ç³»åˆ—ä¾æ­¤é¡æ¨ã€‚</p></div><p>æ›´æ–° anaconda æ­¤ meta-packageï¼Œå¯æ›´æ–° Anaconda ç™¼è¡Œç‰ˆåŒ…å«çš„å¥—ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda update anaconda<br></code></pre></td></tr></table></figure><p>å¦‚æœè¦æ›´æ–° Python çš„ç‰¹å®šç‰ˆæœ¬ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span> conda install python==$pythonversion$<br></code></pre></td></tr></table></figure><h2 id="åƒè€ƒé€£çµ"><a class="header-anchor" href="#åƒè€ƒé€£çµ"></a>åƒè€ƒé€£çµ</h2><ul><li><a href="https://conda.io/docs/user-guide/tasks/manage-pkgs.html" target="_blank" rel="noopener">Managing packages | Conda documentation</a></li><li><a href="https://stackoverflow.com/questions/41535881/how-do-i-upgrade-to-python-3-6-with-conda" target="_blank" rel="noopener">macos - How do I upgrade to Python 3.6 with conda? - Stack Overflow</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;../images/cover/python_anaconda.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;å­¸ç¿’å¦‚ä½•åˆ©ç”¨ Conda ä¾†å»ºç«‹ä¸åŒéœ€æ±‚æ‰€éœ€çš„ Python é–‹ç™¼ç’°å¢ƒï¼Œä¸¦å¦‚ä½•ç®¡ç†ç›¸ä¾å¥—ä»¶ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="https://titangene.github.io/categories/python/"/>
    
    
      <category term="Anaconda" scheme="https://titangene.github.io/tags/anaconda/"/>
    
      <category term="Conda" scheme="https://titangene.github.io/tags/conda/"/>
    
      <category term="Virtual Environment" scheme="https://titangene.github.io/tags/virtual-environment/"/>
    
      <category term="Package Management" scheme="https://titangene.github.io/tags/package-management/"/>
    
  </entry>
  
</feed>
